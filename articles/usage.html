<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Usage • brms.mmrm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Usage">
<meta property="og:description" content="brms.mmrm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">brms.mmrm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/comparison.html">Comparison of Bayesian and frequentist MMRM fits</a>
    </li>
    <li>
      <a href="../articles/methods.html">Methods</a>
    </li>
    <li>
      <a href="../articles/sbc.html">Simulation-based calibration</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Simulation</a>
    </li>
    <li>
      <a href="../articles/usage.html">Usage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/openpharma/brms.mmrm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/brms.mmrm/blob/HEAD/vignettes/usage.Rmd" class="external-link"><code>vignettes/usage.Rmd</code></a></small>
      <div class="hidden name"><code>usage.Rmd</code></div>

    </div>

    
    
<p>A mixed model of repeated measures (MMRM) analyzes longitudinal
clinical trial data. In a longitudinal dataset, there are multiple
patients, and each patient has multiple observations at a common set of
discrete points in time.</p>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>To use the <code>brms.mmrm</code> package, begin with a longitudinal
dataset with one row per patient observation and columns for the
response variable, treatment group indicator, discrete time point
indicator, patient ID variable, and optional baseline covariates such as
age and region. If you do not have a real dataset of your own, you can
simulate one from the package. The following dataset has the raw
response variable, the essential factor variables, and continuous
baseline covariates.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> In general, the outcome variable can either
be the raw response or change from baseline.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/brms.mmrm/" class="external-link">brms.mmrm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span></span>
<span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_simulate_simple.html">brm_simulate_simple</a></span><span class="op">(</span></span>
<span>  n_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_patient <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_time <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">extract2</a></span><span class="op">(</span><span class="st">"data"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/brm_simulate_continuous.html">brm_simulate_continuous</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biomarker1"</span>, <span class="st">"biomarker2"</span>, <span class="st">"biomarker3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raw_data</span></span>
<span><span class="co">#&gt; # A tibble: 1,200 × 7</span></span>
<span><span class="co">#&gt;    response group   time   patient     biomarker1 biomarker2 biomarker3</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1    1.11  group_1 time_1 patient_1        1.31      -0.361      1.52 </span></span>
<span><span class="co">#&gt;  2    2.15  group_1 time_2 patient_1        1.31      -0.361      1.52 </span></span>
<span><span class="co">#&gt;  3    2.54  group_1 time_3 patient_1        1.31      -0.361      1.52 </span></span>
<span><span class="co">#&gt;  4   -1.73  group_1 time_4 patient_1        1.31      -0.361      1.52 </span></span>
<span><span class="co">#&gt;  5   -0.180 group_1 time_1 patient_10       0.107     -2.44      -0.139</span></span>
<span><span class="co">#&gt;  6    0.626 group_1 time_2 patient_10       0.107     -2.44      -0.139</span></span>
<span><span class="co">#&gt;  7   -0.221 group_1 time_3 patient_10       0.107     -2.44      -0.139</span></span>
<span><span class="co">#&gt;  8   -1.53  group_1 time_4 patient_10       0.107     -2.44      -0.139</span></span>
<span><span class="co">#&gt;  9    0.393 group_1 time_1 patient_100      1.44      -0.419     -1.54 </span></span>
<span><span class="co">#&gt; 10    0.442 group_1 time_2 patient_100      1.44      -0.419     -1.54 </span></span>
<span><span class="co">#&gt; # ℹ 1,190 more rows</span></span></code></pre></div>
<p>Next, create a special classed dataset that the package will
recognize. The classed data object contains a pre-processed version of
the data, along with attributes to declare the outcome variable, whether
the outcome is response or change from baseline, the treatment group
variable, the discrete time point variable, control group, baseline time
point, and the covariates selected for analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_data.html">brm_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">raw_data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  role <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"biomarker1"</span>, <span class="st">"biomarker2"</span><span class="op">)</span>,</span>
<span>  level_control <span class="op">=</span> <span class="st">"group_1"</span>,</span>
<span>  level_baseline <span class="op">=</span> <span class="st">"time_1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span></span>
<span><span class="co">#&gt; # A tibble: 1,200 × 6</span></span>
<span><span class="co">#&gt;    response group   time   patient     biomarker1 biomarker2</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1    1.11  group_1 time_1 patient_1        1.31      -0.361</span></span>
<span><span class="co">#&gt;  2    2.15  group_1 time_2 patient_1        1.31      -0.361</span></span>
<span><span class="co">#&gt;  3    2.54  group_1 time_3 patient_1        1.31      -0.361</span></span>
<span><span class="co">#&gt;  4   -1.73  group_1 time_4 patient_1        1.31      -0.361</span></span>
<span><span class="co">#&gt;  5   -0.180 group_1 time_1 patient_10       0.107     -2.44 </span></span>
<span><span class="co">#&gt;  6    0.626 group_1 time_2 patient_10       0.107     -2.44 </span></span>
<span><span class="co">#&gt;  7   -0.221 group_1 time_3 patient_10       0.107     -2.44 </span></span>
<span><span class="co">#&gt;  8   -1.53  group_1 time_4 patient_10       0.107     -2.44 </span></span>
<span><span class="co">#&gt;  9    0.393 group_1 time_1 patient_100      1.44      -0.419</span></span>
<span><span class="co">#&gt; 10    0.442 group_1 time_2 patient_100      1.44      -0.419</span></span>
<span><span class="co">#&gt; # ℹ 1,190 more rows</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "brm_data"   "tbl_df"     "tbl"        "data.frame"</span></span>
<span></span>
<span><span class="va">roles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">roles</span><span class="op">$</span><span class="va">row.names</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">roles</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 14</span></span>
<span><span class="co">#&gt;  $ names             : chr [1:6] "response" "group" "time" "patient" ...</span></span>
<span><span class="co">#&gt;  $ class             : chr [1:4] "brm_data" "tbl_df" "tbl" "data.frame"</span></span>
<span><span class="co">#&gt;  $ brm_outcome       : chr "response"</span></span>
<span><span class="co">#&gt;  $ brm_role          : chr "response"</span></span>
<span><span class="co">#&gt;  $ brm_group         : chr "group"</span></span>
<span><span class="co">#&gt;  $ brm_time          : chr "time"</span></span>
<span><span class="co">#&gt;  $ brm_patient       : chr "patient"</span></span>
<span><span class="co">#&gt;  $ brm_covariates    : chr [1:2] "biomarker1" "biomarker2"</span></span>
<span><span class="co">#&gt;  $ brm_level_control : chr "group_1"</span></span>
<span><span class="co">#&gt;  $ brm_level_baseline: chr "time_1"</span></span>
<span><span class="co">#&gt;  $ brm_levels_group  : chr [1:3] "group_1" "group_2" "group_3"</span></span>
<span><span class="co">#&gt;  $ brm_levels_time   : chr [1:4] "time_1" "time_2" "time_3" "time_4"</span></span>
<span><span class="co">#&gt;  $ brm_labels_group  : chr [1:3] "group_1" "group_2" "group_3"</span></span>
<span><span class="co">#&gt;  $ brm_labels_time   : chr [1:4] "time_1" "time_2" "time_3" "time_4"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="formula">Formula<a class="anchor" aria-label="anchor" href="#formula"></a>
</h2>
<p>Next, choose a <code>brms</code> model formula for the fixed effect
and variance parameters. The <code><a href="../reference/brm_formula.html">brm_formula()</a></code> function from
<code>brms.mmrm</code> makes this process easier. A cell means
parameterization for this particular model can be expressed as follows.
It specifies one fixed effect parameter for each combination of
treatment group and time point, and it makes the specification of
informative priors straightforward through the <code>prior</code>
argument of <code><a href="../reference/brm_model.html">brm_model()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_formula.html">brm_formula</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  effect_baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  effect_group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  effect_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interaction_baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interaction_group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; response ~ 0 + group:time + biomarker1 + biomarker2 + unstr(time = time, gr = patient) </span></span>
<span><span class="co">#&gt; sigma ~ 0 + time</span></span></code></pre></div>
<p>For the purposes of our example, we choose a fully parameterized
analysis of the raw response.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_formula.html">brm_formula</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  effect_baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  effect_group <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  effect_time <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interaction_baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  interaction_group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">formula</span></span>
<span><span class="co">#&gt; response ~ time + group + group:time + biomarker1 + biomarker2 + unstr(time = time, gr = patient) </span></span>
<span><span class="co">#&gt; sigma ~ 0 + time</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameterization">Parameterization<a class="anchor" aria-label="anchor" href="#parameterization"></a>
</h2>
<p>The formula is not the only factor that ultimately determines the
fixed effect parameterization. The ordering of the categorical variables
in the data, as well as the <code>contrast</code> option in R, affect
the construction of the model matrix. To see the model matrix that will
ultimately be used in <code><a href="../reference/brm_model.html">brm_model()</a></code>, run
<code><a href="https://paul-buerkner.github.io/brms/reference/make_standata.html" class="external-link">brms::make_standata()</a></code> and examine the <code>X</code>
element of the returned list.</p>
<p>The <code>contrast</code> option accepts a named vector of two
character vectors which govern <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> contrasts for
unordered and ordered variables, respectively.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>unordered <span class="op">=</span> <span class="st">"contr.SAS"</span>, ordered <span class="op">=</span> <span class="st">"contr.poly"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://paul-buerkner.github.io/brms/reference/make_standata.html" class="external-link">make_standata()</a></code> function lets you see the data that
<code>brms</code> will generate for Stan. This includes the fixed
effects model matrix <code>X</code>. Note the differences in the
<code>groupgroup_*</code> additive terms between the matrix below and
the one above.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paul-buerkner.github.io/brms/reference/make_standata.html" class="external-link">make_standata</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Intercept timetime_1 timetime_2 timetime_3 groupgroup_1 groupgroup_2 biomarker1</span></span>
<span><span class="co">#&gt; 1         1          1          0          0            1            0  1.3126508</span></span>
<span><span class="co">#&gt; 2         1          0          1          0            1            0  1.3126508</span></span>
<span><span class="co">#&gt; 3         1          0          0          1            1            0  1.3126508</span></span>
<span><span class="co">#&gt; 4         1          0          0          0            1            0  1.3126508</span></span>
<span><span class="co">#&gt; 5         1          1          0          0            1            0  0.1068624</span></span>
<span><span class="co">#&gt; 6         1          0          1          0            1            0  0.1068624</span></span>
<span><span class="co">#&gt;   biomarker2 timetime_1:groupgroup_1 timetime_2:groupgroup_1 timetime_3:groupgroup_1</span></span>
<span><span class="co">#&gt; 1 -0.3608809                       1                       0                       0</span></span>
<span><span class="co">#&gt; 2 -0.3608809                       0                       1                       0</span></span>
<span><span class="co">#&gt; 3 -0.3608809                       0                       0                       1</span></span>
<span><span class="co">#&gt; 4 -0.3608809                       0                       0                       0</span></span>
<span><span class="co">#&gt; 5 -2.4441488                       1                       0                       0</span></span>
<span><span class="co">#&gt; 6 -2.4441488                       0                       1                       0</span></span>
<span><span class="co">#&gt;   timetime_1:groupgroup_2 timetime_2:groupgroup_2 timetime_3:groupgroup_2</span></span>
<span><span class="co">#&gt; 1                       0                       0                       0</span></span>
<span><span class="co">#&gt; 2                       0                       0                       0</span></span>
<span><span class="co">#&gt; 3                       0                       0                       0</span></span>
<span><span class="co">#&gt; 4                       0                       0                       0</span></span>
<span><span class="co">#&gt; 5                       0                       0                       0</span></span>
<span><span class="co">#&gt; 6                       0                       0                       0</span></span></code></pre></div>
<p>If you choose a different contrast method, a different model matrix
may result.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  contrasts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>unordered <span class="op">=</span> <span class="st">"contr.treatment"</span>, ordered <span class="op">=</span> <span class="st">"contr.poly"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># different model matrix than before:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paul-buerkner.github.io/brms/reference/make_standata.html" class="external-link">make_standata</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span><span class="op">$</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Intercept timetime_2 timetime_3 timetime_4 groupgroup_2 groupgroup_3 biomarker1</span></span>
<span><span class="co">#&gt; 1         1          0          0          0            0            0  1.3126508</span></span>
<span><span class="co">#&gt; 2         1          1          0          0            0            0  1.3126508</span></span>
<span><span class="co">#&gt; 3         1          0          1          0            0            0  1.3126508</span></span>
<span><span class="co">#&gt; 4         1          0          0          1            0            0  1.3126508</span></span>
<span><span class="co">#&gt; 5         1          0          0          0            0            0  0.1068624</span></span>
<span><span class="co">#&gt; 6         1          1          0          0            0            0  0.1068624</span></span>
<span><span class="co">#&gt;   biomarker2 timetime_2:groupgroup_2 timetime_3:groupgroup_2 timetime_4:groupgroup_2</span></span>
<span><span class="co">#&gt; 1 -0.3608809                       0                       0                       0</span></span>
<span><span class="co">#&gt; 2 -0.3608809                       0                       0                       0</span></span>
<span><span class="co">#&gt; 3 -0.3608809                       0                       0                       0</span></span>
<span><span class="co">#&gt; 4 -0.3608809                       0                       0                       0</span></span>
<span><span class="co">#&gt; 5 -2.4441488                       0                       0                       0</span></span>
<span><span class="co">#&gt; 6 -2.4441488                       0                       0                       0</span></span>
<span><span class="co">#&gt;   timetime_2:groupgroup_3 timetime_3:groupgroup_3 timetime_4:groupgroup_3</span></span>
<span><span class="co">#&gt; 1                       0                       0                       0</span></span>
<span><span class="co">#&gt; 2                       0                       0                       0</span></span>
<span><span class="co">#&gt; 3                       0                       0                       0</span></span>
<span><span class="co">#&gt; 4                       0                       0                       0</span></span>
<span><span class="co">#&gt; 5                       0                       0                       0</span></span>
<span><span class="co">#&gt; 6                       0                       0                       0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h2>
<p>Some analyses require informative priors, others require
non-informative ones. Please use <a href="https://paul-buerkner.github.io/brms/" class="external-link"><code>brms</code></a> to
construct a prior suitable for your analysis. The <a href="https://paul-buerkner.github.io/brms/" class="external-link"><code>brms</code></a>
package has documentation on how its default priors are constructed and
how to set your own priors. Once you have an R object that represents
the joint prior distribution of your model, you can pass it to the
<code><a href="../reference/brm_model.html">brm_model()</a></code> function described below. The
<code><a href="https://paul-buerkner.github.io/brms/reference/get_prior.html" class="external-link">get_prior()</a></code> function shows the default priors for a given
dataset and model formula.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paul-buerkner.github.io/brms/reference/get_prior.html" class="external-link">get_prior</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, formula <span class="op">=</span> <span class="va">formula</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   prior     class                    coef group resp  dpar nlpar lb ub</span></span>
<span><span class="co">#&gt;                  (flat)         b                                                     </span></span>
<span><span class="co">#&gt;                  (flat)         b              biomarker1                             </span></span>
<span><span class="co">#&gt;                  (flat)         b              biomarker2                             </span></span>
<span><span class="co">#&gt;                  (flat)         b            groupgroup_2                             </span></span>
<span><span class="co">#&gt;                  (flat)         b            groupgroup_3                             </span></span>
<span><span class="co">#&gt;                  (flat)         b              timetime_2                             </span></span>
<span><span class="co">#&gt;                  (flat)         b timetime_2:groupgroup_2                             </span></span>
<span><span class="co">#&gt;                  (flat)         b timetime_2:groupgroup_3                             </span></span>
<span><span class="co">#&gt;                  (flat)         b              timetime_3                             </span></span>
<span><span class="co">#&gt;                  (flat)         b timetime_3:groupgroup_2                             </span></span>
<span><span class="co">#&gt;                  (flat)         b timetime_3:groupgroup_3                             </span></span>
<span><span class="co">#&gt;                  (flat)         b              timetime_4                             </span></span>
<span><span class="co">#&gt;                  (flat)         b timetime_4:groupgroup_2                             </span></span>
<span><span class="co">#&gt;                  (flat)         b timetime_4:groupgroup_3                             </span></span>
<span><span class="co">#&gt;                  lkj(1)   cortime                                                     </span></span>
<span><span class="co">#&gt;  student_t(3, 0.9, 2.5) Intercept                                                     </span></span>
<span><span class="co">#&gt;                  (flat)         b                                    sigma            </span></span>
<span><span class="co">#&gt;                  (flat)         b              timetime_1            sigma            </span></span>
<span><span class="co">#&gt;                  (flat)         b              timetime_2            sigma            </span></span>
<span><span class="co">#&gt;                  (flat)         b              timetime_3            sigma            </span></span>
<span><span class="co">#&gt;                  (flat)         b              timetime_4            sigma            </span></span>
<span><span class="co">#&gt;        source</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<p>To run an MMRM, use the <code><a href="../reference/brm_model.html">brm_model()</a></code> function. This
function calls <code><a href="https://paul-buerkner.github.io/brms/reference/brm.html" class="external-link">brms::brm()</a></code> behind the scenes, using the
formula and prior you set in the <code>formula</code> and
<code>prior</code> arguments.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_model.html">brm_model</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, formula <span class="op">=</span> <span class="va">formula</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>The result is a <code>brms</code> model object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = log </span></span>
<span><span class="co">#&gt; Formula: response ~ time + group + group:time + biomarker1 + biomarker2 + unstr(time = time, gr = patient) </span></span>
<span><span class="co">#&gt;          sigma ~ 0 + time</span></span>
<span><span class="co">#&gt;    Data: data (Number of observations: 1200) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation Structures:</span></span>
<span><span class="co">#&gt;                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; cortime(time_1,time_2)     0.50      0.04     0.41     0.57 1.00     4516     3319</span></span>
<span><span class="co">#&gt; cortime(time_1,time_3)    -0.49      0.04    -0.57    -0.40 1.00     5194     3374</span></span>
<span><span class="co">#&gt; cortime(time_2,time_3)    -0.26      0.05    -0.36    -0.15 1.00     4833     3372</span></span>
<span><span class="co">#&gt; cortime(time_1,time_4)    -0.15      0.06    -0.26    -0.03 1.00     5513     2907</span></span>
<span><span class="co">#&gt; cortime(time_2,time_4)     0.14      0.06     0.03     0.25 1.00     5748     2987</span></span>
<span><span class="co">#&gt; cortime(time_3,time_4)     0.07      0.06    -0.04     0.19 1.00     5557     2927</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Population-Level Effects: </span></span>
<span><span class="co">#&gt;                         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept                  -0.20      0.09    -0.38    -0.02 1.00     1213     2044</span></span>
<span><span class="co">#&gt; timetime_2                  1.32      0.10     1.12     1.51 1.00     1948     2529</span></span>
<span><span class="co">#&gt; timetime_3                  0.51      0.17     0.17     0.85 1.00     1324     2119</span></span>
<span><span class="co">#&gt; timetime_4                 -1.44      0.17    -1.78    -1.12 1.00     1285     2264</span></span>
<span><span class="co">#&gt; groupgroup_2                1.35      0.13     1.09     1.61 1.00     1409     2368</span></span>
<span><span class="co">#&gt; groupgroup_3                1.55      0.13     1.29     1.79 1.00     1325     2469</span></span>
<span><span class="co">#&gt; biomarker1                  0.02      0.03    -0.03     0.07 1.00     5913     3069</span></span>
<span><span class="co">#&gt; biomarker2                  0.02      0.03    -0.03     0.07 1.00     6207     2738</span></span>
<span><span class="co">#&gt; timetime_2:groupgroup_2     0.04      0.14    -0.24     0.33 1.00     2261     2921</span></span>
<span><span class="co">#&gt; timetime_3:groupgroup_2    -0.16      0.24    -0.63     0.31 1.00     1459     2458</span></span>
<span><span class="co">#&gt; timetime_4:groupgroup_2    -0.07      0.24    -0.53     0.41 1.00     1493     2212</span></span>
<span><span class="co">#&gt; timetime_2:groupgroup_3     0.02      0.14    -0.25     0.31 1.00     2131     3201</span></span>
<span><span class="co">#&gt; timetime_3:groupgroup_3    -0.20      0.24    -0.67     0.28 1.00     1453     2171</span></span>
<span><span class="co">#&gt; timetime_4:groupgroup_3    -0.27      0.24    -0.75     0.20 1.00     1393     2081</span></span>
<span><span class="co">#&gt; sigma_timetime_1           -0.06      0.04    -0.14     0.02 1.00     4289     3157</span></span>
<span><span class="co">#&gt; sigma_timetime_2            0.08      0.04     0.00     0.16 1.00     4967     3265</span></span>
<span><span class="co">#&gt; sigma_timetime_3            0.09      0.04     0.01     0.17 1.00     4796     3073</span></span>
<span><span class="co">#&gt; sigma_timetime_4            0.26      0.04     0.18     0.34 1.00     6301     2938</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="marginals">Marginals<a class="anchor" aria-label="anchor" href="#marginals"></a>
</h2>
<p>Regardless of the choice of fixed effects formula,
<code>brms.mmrm</code> performs inference on the marginal distributions
at each treatment group and time point of the mean of the following
quantities:</p>
<ol style="list-style-type: decimal">
<li>Response.</li>
<li>Change from baseline, if you set <code>role</code> to
<code>"change"</code> in <code><a href="../reference/brm_data.html">brm_data()</a></code>.</li>
<li>Treatment difference, in terms of change from baseline.</li>
<li>Effect size: treatment difference divided by the residual standard
deviation.</li>
</ol>
<p>To derive posterior draws of these marginals, use the
<code><a href="../reference/brm_marginal_draws.html">brm_marginal_draws()</a></code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_draws.html">brm_marginal_draws</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">draws</span></span>
<span><span class="co">#&gt; $response</span></span>
<span><span class="co">#&gt; # A draws_df: 1000 iterations, 4 chains, and 12 variables</span></span>
<span><span class="co">#&gt;    group_1|time_1 group_2|time_1 group_3|time_1 group_1|time_2 group_2|time_2</span></span>
<span><span class="co">#&gt; 1          -0.256           1.03            1.2           0.94            2.3</span></span>
<span><span class="co">#&gt; 2          -0.207           1.04            1.2           1.01            2.6</span></span>
<span><span class="co">#&gt; 3          -0.090           1.18            1.5           0.94            2.3</span></span>
<span><span class="co">#&gt; 4          -0.011           1.29            1.4           1.36            2.6</span></span>
<span><span class="co">#&gt; 5          -0.070           1.04            1.1           1.09            2.6</span></span>
<span><span class="co">#&gt; 6          -0.032           1.14            1.5           1.23            2.5</span></span>
<span><span class="co">#&gt; 7          -0.093           1.06            1.2           1.13            2.5</span></span>
<span><span class="co">#&gt; 8          -0.034           1.08            1.3           1.26            2.5</span></span>
<span><span class="co">#&gt; 9          -0.167           0.98            1.4           1.09            2.4</span></span>
<span><span class="co">#&gt; 10         -0.204           1.21            1.3           1.07            2.6</span></span>
<span><span class="co">#&gt;    group_3|time_2 group_1|time_3 group_2|time_3</span></span>
<span><span class="co">#&gt; 1             2.6          0.338            1.4</span></span>
<span><span class="co">#&gt; 2             2.5          0.474            1.6</span></span>
<span><span class="co">#&gt; 3             2.7          0.055            1.5</span></span>
<span><span class="co">#&gt; 4             2.9          0.234            1.4</span></span>
<span><span class="co">#&gt; 5             2.5          0.260            1.5</span></span>
<span><span class="co">#&gt; 6             2.8          0.194            1.6</span></span>
<span><span class="co">#&gt; 7             2.6          0.335            1.6</span></span>
<span><span class="co">#&gt; 8             2.6          0.077            1.7</span></span>
<span><span class="co">#&gt; 9             2.8          0.252            1.6</span></span>
<span><span class="co">#&gt; 10            2.6          0.288            1.6</span></span>
<span><span class="co">#&gt; # ... with 3990 more draws, and 4 more variables</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $change</span></span>
<span><span class="co">#&gt; # A draws_df: 1000 iterations, 4 chains, and 9 variables</span></span>
<span><span class="co">#&gt;    group_1|time_2 group_1|time_3 group_1|time_4 group_2|time_2 group_2|time_3</span></span>
<span><span class="co">#&gt; 1             1.2           0.59           -1.4            1.3           0.38</span></span>
<span><span class="co">#&gt; 2             1.2           0.68           -1.4            1.5           0.57</span></span>
<span><span class="co">#&gt; 3             1.0           0.14           -1.6            1.1           0.36</span></span>
<span><span class="co">#&gt; 4             1.4           0.24           -1.7            1.3           0.16</span></span>
<span><span class="co">#&gt; 5             1.2           0.33           -1.4            1.5           0.50</span></span>
<span><span class="co">#&gt; 6             1.3           0.23           -2.0            1.3           0.42</span></span>
<span><span class="co">#&gt; 7             1.2           0.43           -1.6            1.4           0.53</span></span>
<span><span class="co">#&gt; 8             1.3           0.11           -1.7            1.4           0.60</span></span>
<span><span class="co">#&gt; 9             1.3           0.42           -1.5            1.4           0.65</span></span>
<span><span class="co">#&gt; 10            1.3           0.49           -1.5            1.4           0.42</span></span>
<span><span class="co">#&gt;    group_2|time_4 group_3|time_2 group_3|time_3</span></span>
<span><span class="co">#&gt; 1            -1.5            1.4         0.6418</span></span>
<span><span class="co">#&gt; 2            -1.4            1.2         0.3158</span></span>
<span><span class="co">#&gt; 3            -1.5            1.3         0.0437</span></span>
<span><span class="co">#&gt; 4            -1.7            1.5         0.1925</span></span>
<span><span class="co">#&gt; 5            -1.2            1.4         0.7741</span></span>
<span><span class="co">#&gt; 6            -1.7            1.3         0.0014</span></span>
<span><span class="co">#&gt; 7            -1.2            1.4         0.5891</span></span>
<span><span class="co">#&gt; 8            -1.5            1.3         0.3694</span></span>
<span><span class="co">#&gt; 9            -1.3            1.4         0.1679</span></span>
<span><span class="co">#&gt; 10           -1.6            1.3         0.4824</span></span>
<span><span class="co">#&gt; # ... with 3990 more draws, and 1 more variables</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $difference</span></span>
<span><span class="co">#&gt; # A draws_df: 1000 iterations, 4 chains, and 6 variables</span></span>
<span><span class="co">#&gt;    group_2|time_2 group_2|time_3 group_2|time_4 group_3|time_2 group_3|time_3</span></span>
<span><span class="co">#&gt; 1           0.106         -0.216         -0.059          0.233         0.0481</span></span>
<span><span class="co">#&gt; 2           0.335         -0.115          0.015          0.014        -0.3649</span></span>
<span><span class="co">#&gt; 3           0.119          0.213          0.021          0.240        -0.1007</span></span>
<span><span class="co">#&gt; 4          -0.076         -0.085          0.064          0.137        -0.0523</span></span>
<span><span class="co">#&gt; 5           0.363          0.169          0.242          0.277         0.4438</span></span>
<span><span class="co">#&gt; 6           0.051          0.194          0.279          0.026        -0.2247</span></span>
<span><span class="co">#&gt; 7           0.218          0.097          0.453          0.142         0.1610</span></span>
<span><span class="co">#&gt; 8           0.095          0.484          0.251         -0.039         0.2579</span></span>
<span><span class="co">#&gt; 9           0.166          0.233          0.268          0.097        -0.2517</span></span>
<span><span class="co">#&gt; 10          0.165         -0.072         -0.128          0.052        -0.0093</span></span>
<span><span class="co">#&gt;    group_3|time_4</span></span>
<span><span class="co">#&gt; 1         -0.2188</span></span>
<span><span class="co">#&gt; 2         -0.3413</span></span>
<span><span class="co">#&gt; 3         -0.4630</span></span>
<span><span class="co">#&gt; 4          0.1403</span></span>
<span><span class="co">#&gt; 5         -0.0098</span></span>
<span><span class="co">#&gt; 6          0.2332</span></span>
<span><span class="co">#&gt; 7          0.0092</span></span>
<span><span class="co">#&gt; 8          0.0695</span></span>
<span><span class="co">#&gt; 9         -0.1699</span></span>
<span><span class="co">#&gt; 10        -0.2650</span></span>
<span><span class="co">#&gt; # ... with 3990 more draws</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $effect</span></span>
<span><span class="co">#&gt; # A draws_df: 1000 iterations, 4 chains, and 6 variables</span></span>
<span><span class="co">#&gt;    group_2|time_2 group_2|time_3 group_2|time_4 group_3|time_2 group_3|time_3</span></span>
<span><span class="co">#&gt; 1           0.102         -0.201         -0.047          0.223         0.0448</span></span>
<span><span class="co">#&gt; 2           0.330         -0.106          0.011          0.013        -0.3341</span></span>
<span><span class="co">#&gt; 3           0.109          0.192          0.015          0.220        -0.0908</span></span>
<span><span class="co">#&gt; 4          -0.070         -0.079          0.053          0.125        -0.0485</span></span>
<span><span class="co">#&gt; 5           0.342          0.151          0.177          0.261         0.3973</span></span>
<span><span class="co">#&gt; 6           0.046          0.176          0.211          0.024        -0.2032</span></span>
<span><span class="co">#&gt; 7           0.202          0.085          0.321          0.132         0.1402</span></span>
<span><span class="co">#&gt; 8           0.085          0.448          0.202         -0.035         0.2385</span></span>
<span><span class="co">#&gt; 9           0.157          0.206          0.197          0.092        -0.2224</span></span>
<span><span class="co">#&gt; 10          0.140         -0.069         -0.102          0.044        -0.0089</span></span>
<span><span class="co">#&gt;    group_3|time_4</span></span>
<span><span class="co">#&gt; 1         -0.1748</span></span>
<span><span class="co">#&gt; 2         -0.2589</span></span>
<span><span class="co">#&gt; 3         -0.3365</span></span>
<span><span class="co">#&gt; 4          0.1148</span></span>
<span><span class="co">#&gt; 5         -0.0071</span></span>
<span><span class="co">#&gt; 6          0.1764</span></span>
<span><span class="co">#&gt; 7          0.0065</span></span>
<span><span class="co">#&gt; 8          0.0559</span></span>
<span><span class="co">#&gt; 9         -0.1249</span></span>
<span><span class="co">#&gt; 10        -0.2116</span></span>
<span><span class="co">#&gt; # ... with 3990 more draws</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span></code></pre></div>
<p>If you need samples from these marginals averaged across time points,
e.g. an “overall effect size”, <code><a href="../reference/brm_marginal_draws_average.html">brm_marginal_draws_average()</a></code>
can average the draws above across discrete time points (either all or a
user-defined subset).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_marginal_draws_average.html">brm_marginal_draws_average</a></span><span class="op">(</span>draws <span class="op">=</span> <span class="va">draws</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; $response</span></span>
<span><span class="co">#&gt; # A draws_df: 1000 iterations, 4 chains, and 3 variables</span></span>
<span><span class="co">#&gt;    group_1|average group_2|average group_3|average</span></span>
<span><span class="co">#&gt; 1           -0.160             1.1             1.3</span></span>
<span><span class="co">#&gt; 2           -0.091             1.2             1.2</span></span>
<span><span class="co">#&gt; 3           -0.189             1.2             1.3</span></span>
<span><span class="co">#&gt; 4           -0.038             1.2             1.4</span></span>
<span><span class="co">#&gt; 5           -0.053             1.3             1.3</span></span>
<span><span class="co">#&gt; 6           -0.151             1.2             1.4</span></span>
<span><span class="co">#&gt; 7           -0.083             1.3             1.3</span></span>
<span><span class="co">#&gt; 8           -0.120             1.2             1.3</span></span>
<span><span class="co">#&gt; 9           -0.131             1.2             1.4</span></span>
<span><span class="co">#&gt; 10          -0.127             1.3             1.3</span></span>
<span><span class="co">#&gt; # ... with 3990 more draws</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $change</span></span>
<span><span class="co">#&gt; # A draws_df: 1000 iterations, 4 chains, and 3 variables</span></span>
<span><span class="co">#&gt;    group_1|average group_2|average group_3|average</span></span>
<span><span class="co">#&gt; 1            0.127           0.071           0.148</span></span>
<span><span class="co">#&gt; 2            0.154           0.232          -0.077</span></span>
<span><span class="co">#&gt; 3           -0.132          -0.014          -0.240</span></span>
<span><span class="co">#&gt; 4           -0.037          -0.069           0.038</span></span>
<span><span class="co">#&gt; 5            0.023           0.281           0.260</span></span>
<span><span class="co">#&gt; 6           -0.159           0.016          -0.147</span></span>
<span><span class="co">#&gt; 7            0.014           0.270           0.118</span></span>
<span><span class="co">#&gt; 8           -0.113           0.163          -0.017</span></span>
<span><span class="co">#&gt; 9            0.049           0.271          -0.060</span></span>
<span><span class="co">#&gt; 10           0.103           0.091           0.028</span></span>
<span><span class="co">#&gt; # ... with 3990 more draws</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $difference</span></span>
<span><span class="co">#&gt; # A draws_df: 1000 iterations, 4 chains, and 2 variables</span></span>
<span><span class="co">#&gt;    group_2|average group_3|average</span></span>
<span><span class="co">#&gt; 1           -0.056           0.021</span></span>
<span><span class="co">#&gt; 2            0.078          -0.231</span></span>
<span><span class="co">#&gt; 3            0.118          -0.108</span></span>
<span><span class="co">#&gt; 4           -0.032           0.075</span></span>
<span><span class="co">#&gt; 5            0.258           0.237</span></span>
<span><span class="co">#&gt; 6            0.175           0.012</span></span>
<span><span class="co">#&gt; 7            0.256           0.104</span></span>
<span><span class="co">#&gt; 8            0.277           0.096</span></span>
<span><span class="co">#&gt; 9            0.222          -0.108</span></span>
<span><span class="co">#&gt; 10          -0.012          -0.074</span></span>
<span><span class="co">#&gt; # ... with 3990 more draws</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $effect</span></span>
<span><span class="co">#&gt; # A draws_df: 1000 iterations, 4 chains, and 2 variables</span></span>
<span><span class="co">#&gt;    group_2|average group_3|average</span></span>
<span><span class="co">#&gt; 1           -0.049         0.03107</span></span>
<span><span class="co">#&gt; 2            0.079        -0.19320</span></span>
<span><span class="co">#&gt; 3            0.106        -0.06895</span></span>
<span><span class="co">#&gt; 4           -0.032         0.06376</span></span>
<span><span class="co">#&gt; 5            0.223         0.21688</span></span>
<span><span class="co">#&gt; 6            0.145        -0.00099</span></span>
<span><span class="co">#&gt; 7            0.202         0.09280</span></span>
<span><span class="co">#&gt; 8            0.245         0.08637</span></span>
<span><span class="co">#&gt; 9            0.187        -0.08528</span></span>
<span><span class="co">#&gt; 10          -0.010        -0.05889</span></span>
<span><span class="co">#&gt; # ... with 3990 more draws</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span></code></pre></div>
<p>The <code><a href="../reference/brm_marginal_summaries.html">brm_marginal_summaries()</a></code> function produces posterior
summaries of these marginals, and it includes the Monte Carlo standard
error (MCSE) of each estimate.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_summaries.html">brm_marginal_summaries</a></span><span class="op">(</span><span class="va">draws</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries</span></span>
<span><span class="co">#&gt; # A tibble: 165 × 6</span></span>
<span><span class="co">#&gt;    marginal statistic group   time     value    mcse</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 change   lower     group_1 time_2  1.12   0.00488</span></span>
<span><span class="co">#&gt;  2 change   lower     group_1 time_3  0.168  0.0102 </span></span>
<span><span class="co">#&gt;  3 change   lower     group_1 time_4 -1.78   0.00876</span></span>
<span><span class="co">#&gt;  4 change   lower     group_2 time_2  1.15   0.00553</span></span>
<span><span class="co">#&gt;  5 change   lower     group_2 time_3  0.0160 0.00963</span></span>
<span><span class="co">#&gt;  6 change   lower     group_2 time_4 -1.84   0.0102 </span></span>
<span><span class="co">#&gt;  7 change   lower     group_3 time_2  1.14   0.00353</span></span>
<span><span class="co">#&gt;  8 change   lower     group_3 time_3 -0.0223 0.00824</span></span>
<span><span class="co">#&gt;  9 change   lower     group_3 time_4 -2.06   0.00872</span></span>
<span><span class="co">#&gt; 10 change   mean      group_1 time_2  1.32   0.00230</span></span>
<span><span class="co">#&gt; # ℹ 155 more rows</span></span></code></pre></div>
<p>The <code><a href="../reference/brm_marginal_probabilities.html">brm_marginal_probabilities()</a></code> function shows
posterior probabilities of the form,</p>
<p><span class="math display">\[
\begin{aligned}
\text{Prob}(\text{treatment effect} &gt; \text{threshold})
\end{aligned}
\]</span></p>
<p>or</p>
<p><span class="math display">\[
\begin{aligned}
\text{Prob}(\text{treatment effect} &lt; \text{threshold})
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_marginal_probabilities.html">brm_marginal_probabilities</a></span><span class="op">(</span></span>
<span>  draws <span class="op">=</span> <span class="va">draws</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"greater"</span>, <span class="st">"less"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 12 × 5</span></span>
<span><span class="co">#&gt;    direction threshold group   time   value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 greater        -0.1 group_2 time_2 0.833</span></span>
<span><span class="co">#&gt;  2 greater        -0.1 group_2 time_3 0.397</span></span>
<span><span class="co">#&gt;  3 greater        -0.1 group_2 time_4 0.549</span></span>
<span><span class="co">#&gt;  4 greater        -0.1 group_3 time_2 0.800</span></span>
<span><span class="co">#&gt;  5 greater        -0.1 group_3 time_3 0.334</span></span>
<span><span class="co">#&gt;  6 greater        -0.1 group_3 time_4 0.244</span></span>
<span><span class="co">#&gt;  7 less            0.1 group_2 time_2 0.660</span></span>
<span><span class="co">#&gt;  8 less            0.1 group_2 time_3 0.860</span></span>
<span><span class="co">#&gt;  9 less            0.1 group_2 time_4 0.768</span></span>
<span><span class="co">#&gt; 10 less            0.1 group_3 time_2 0.705</span></span>
<span><span class="co">#&gt; 11 less            0.1 group_3 time_3 0.890</span></span>
<span><span class="co">#&gt; 12 less            0.1 group_3 time_4 0.938</span></span></code></pre></div>
<p>Finally, the <code>brm_marignals_data()</code> computes marginal
means and confidence intervals on the response variable in the data,
along with other summary statistics.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summaries_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_data.html">brm_marginal_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries_data</span></span>
<span><span class="co">#&gt; # A tibble: 84 × 4</span></span>
<span><span class="co">#&gt;    statistic group   time      value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 lower     group_1 time_1 -0.00263</span></span>
<span><span class="co">#&gt;  2 lower     group_1 time_2  1.32   </span></span>
<span><span class="co">#&gt;  3 lower     group_1 time_3  0.535  </span></span>
<span><span class="co">#&gt;  4 lower     group_1 time_4 -1.39   </span></span>
<span><span class="co">#&gt;  5 lower     group_2 time_1  1.33   </span></span>
<span><span class="co">#&gt;  6 lower     group_2 time_2  2.72   </span></span>
<span><span class="co">#&gt;  7 lower     group_2 time_3  1.72   </span></span>
<span><span class="co">#&gt;  8 lower     group_2 time_4 -0.0926 </span></span>
<span><span class="co">#&gt;  9 lower     group_3 time_1  1.52   </span></span>
<span><span class="co">#&gt; 10 lower     group_3 time_2  2.90   </span></span>
<span><span class="co">#&gt; # ℹ 74 more rows</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>The <code><a href="../reference/brm_plot_compare.html">brm_plot_compare()</a></code> function compares means and
intervals from many different models and data sources in the same plot.
First, we need the marginals of the data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_plot_compare.html">brm_plot_compare</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">summaries_data</span>,</span>
<span>  model1 <span class="op">=</span> <span class="va">summaries</span>,</span>
<span>  model2 <span class="op">=</span> <span class="va">summaries</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="usage/response-1.png" alt=""><p class="caption">plot of chunk response</p>
</div>
<p>If you omit the marginals of the data, you can show inference on
change from baseline or the treatment effect.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_plot_compare.html">brm_plot_compare</a></span><span class="op">(</span></span>
<span>  model1 <span class="op">=</span> <span class="va">summaries</span>,</span>
<span>  model2 <span class="op">=</span> <span class="va">summaries</span>,</span>
<span>  marginal <span class="op">=</span> <span class="st">"difference"</span> <span class="co"># treatment effect</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="usage/difference-1.png" alt=""><p class="caption">plot of chunk difference</p>
</div>
<p>Finally, <code><a href="../reference/brm_plot_draws.html">brm_plot_draws()</a></code> can plot the posterior draws
of the response, change from baseline, or treatment difference.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_plot_draws.html">brm_plot_draws</a></span><span class="op">(</span>draws <span class="op">=</span> <span class="va">draws</span><span class="op">$</span><span class="va">difference</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="usage/draws-1.png" alt=""><p class="caption">plot of chunk draws</p>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Covariates can be categorical too.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by William Michael Landau, Kevin Kunzmann, Yoni Sidi, Christian Stock, Eli Lilly and Company, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
