<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="brms.mmrm">
<title>Informative prior archetypes • brms.mmrm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Informative prior archetypes">
<meta property="og:description" content="brms.mmrm">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">brms.mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Usage</h6>
    <a class="dropdown-item" href="../articles/usage.html">Usage</a>
    <a class="dropdown-item" href="../articles/subgroup.html">Subgroup analysis</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
    <a class="dropdown-item" href="../articles/archetypes.html">Informative prior archetypes</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Validation</h6>
    <a class="dropdown-item" href="../articles/sbc.html">Simulation-based calibration checking</a>
    <a class="dropdown-item" href="../articles/fev1.html">FEV1 data comparison between Bayesian and frequentist MMRMs</a>
    <a class="dropdown-item" href="../articles/bcva.html">BCVA data comparison between Bayesian and frequentist MMRMs</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/brms.mmrm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Informative prior archetypes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/brms.mmrm/blob/HEAD/vignettes/archetypes.Rmd" class="external-link"><code>vignettes/archetypes.Rmd</code></a></small>
      <div class="d-none name"><code>archetypes.Rmd</code></div>
    </div>

    
    
<p>Informative prior archetypes allow users to conveniently set
informative priors in <code>brms.mmrm</code> in a robust way, guarding
against common pitfalls such as reference level issues, interpretation
problems, and rank deficiency.</p>
<div class="section level2">
<h2 id="constructing-an-archetype">Constructing an archetype<a class="anchor" aria-label="anchor" href="#constructing-an-archetype"></a>
</h2>
<p>We begin with the FEV dataset from the <code>mmrm</code> package, an
artificial (simulated) dataset of a clinical trial investigating the
effect of an active treatment on FEV1 (forced expired volume in one
second), compared to placebo. FEV1 is a measure of how quickly the lungs
can be emptied and low levels may indicate chronic obstructive pulmonary
disease (COPD).</p>
<p>The dataset is a tibble with 800 rows and 7 variables:</p>
<ul>
<li>
<code>USUBJID</code> (subject ID),</li>
<li>
<code>AVISIT</code> (visit number),</li>
<li>
<code>ARMCD</code> (treatment, TRT or PBO),</li>
<li>
<code>RACE</code> (3-category race),</li>
<li>
<code>SEX</code> (sex),</li>
<li>
<code>FEV1_BL</code> (FEV1 at baseline, %),</li>
<li>
<code>FEV1</code> (FEV1 at study visits),</li>
<li>
<code>WEIGHT</code> (weighting variable).</li>
</ul>
<p>We will derive <code>FEV1_CHG = FEV1 - FEV1_BL</code> and analyze
<code>FEV1_CHG</code> as the outcome variable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/brms.mmrm/" class="external-link">brms.mmrm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fev_data</span>, package <span class="op">=</span> <span class="st">"mmrm"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">fev_data</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="st">"FEV1_CHG"</span> <span class="op">=</span> <span class="va">FEV1</span> <span class="op">-</span> <span class="va">FEV1_BL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_data.html">brm_data</a></span><span class="op">(</span></span>
<span>    outcome <span class="op">=</span> <span class="st">"FEV1_CHG"</span>,</span>
<span>    role <span class="op">=</span> <span class="st">"change"</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"ARMCD"</span>,</span>
<span>    time <span class="op">=</span> <span class="st">"AVISIT"</span>,</span>
<span>    patient <span class="op">=</span> <span class="st">"USUBJID"</span>,</span>
<span>    baseline <span class="op">=</span> <span class="st">"FEV1_BL"</span>,</span>
<span>    reference_group <span class="op">=</span> <span class="st">"PBO"</span>,</span>
<span>    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WEIGHT"</span>, <span class="st">"SEX"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">data</span></span>
<span><span class="co">#&gt; # A tibble: 800 × 7</span></span>
<span><span class="co">#&gt;    FEV1_CHG FEV1_BL ARMCD AVISIT USUBJID WEIGHT SEX   </span></span>
<span><span class="co">#&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;fct&gt;    &lt;dbl&gt; &lt;fct&gt; </span></span>
<span><span class="co">#&gt;  1    NA       45.0 PBO   VIS1   PT2      0.465 Male  </span></span>
<span><span class="co">#&gt;  2   -13.6     45.0 PBO   VIS2   PT2      0.233 Male  </span></span>
<span><span class="co">#&gt;  3    -8.15    45.0 PBO   VIS3   PT2      0.360 Male  </span></span>
<span><span class="co">#&gt;  4     3.78    45.0 PBO   VIS4   PT2      0.507 Male  </span></span>
<span><span class="co">#&gt;  5    NA       43.5 PBO   VIS1   PT3      0.682 Female</span></span>
<span><span class="co">#&gt;  6    -7.51    43.5 PBO   VIS2   PT3      0.892 Female</span></span>
<span><span class="co">#&gt;  7    NA       43.5 PBO   VIS3   PT3      0.128 Female</span></span>
<span><span class="co">#&gt;  8    -6.34    43.5 PBO   VIS4   PT3      0.222 Female</span></span>
<span><span class="co">#&gt;  9   -11.3     43.6 PBO   VIS1   PT5      0.411 Male  </span></span>
<span><span class="co">#&gt; 10    NA       43.6 PBO   VIS2   PT5      0.422 Male  </span></span>
<span><span class="co">#&gt; # ℹ 790 more rows</span></span></code></pre></div>
<p>The functions listed at <a href="https://openpharma.github.io/brms.mmrm/reference/index.html#informative-prior-archetypes" class="external-link uri">https://openpharma.github.io/brms.mmrm/reference/index.html#informative-prior-archetypes</a>
can create different kinds of informative prior archetypes from a
dataset like the one above. For example, suppose we want to place
informative priors on the successive differences between adjacent time
points. This approach is appropriate and desirable in many situations
because the structure naturally captures the prior correlations among
adjacent visits of a clinical trial. To do this, we create an instance
of the “successive cells” archetype.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">archetype</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_archetype_successive_cells.html">brm_archetype_successive_cells</a></span><span class="op">(</span><span class="va">data</span>, baseline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The instance of the archetype is an ordinary tibble, but it adds new
columns.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">archetype</span></span>
<span><span class="co">#&gt; # A tibble: 800 × 21</span></span>
<span><span class="co">#&gt;    x_PBO_VIS1 x_PBO_VIS2 x_PBO_VIS3 x_PBO_VIS4 x_TRT_VIS1 x_TRT_VIS2 x_TRT_VIS3 x_TRT_VIS4</span></span>
<span><span class="co">#&gt;  *      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1          1          0          0          0          0          0          0          0</span></span>
<span><span class="co">#&gt;  2          1          1          0          0          0          0          0          0</span></span>
<span><span class="co">#&gt;  3          1          1          1          0          0          0          0          0</span></span>
<span><span class="co">#&gt;  4          1          1          1          1          0          0          0          0</span></span>
<span><span class="co">#&gt;  5          1          0          0          0          0          0          0          0</span></span>
<span><span class="co">#&gt;  6          1          1          0          0          0          0          0          0</span></span>
<span><span class="co">#&gt;  7          1          1          1          0          0          0          0          0</span></span>
<span><span class="co">#&gt;  8          1          1          1          1          0          0          0          0</span></span>
<span><span class="co">#&gt;  9          1          0          0          0          0          0          0          0</span></span>
<span><span class="co">#&gt; 10          1          1          0          0          0          0          0          0</span></span>
<span><span class="co">#&gt; # ℹ 790 more rows</span></span>
<span><span class="co">#&gt; # ℹ 13 more variables: nuisance_WEIGHT &lt;dbl&gt;, nuisance_SEX_Male &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   nuisance_FEV1_BL.AVISITVIS1 &lt;dbl&gt;, nuisance_FEV1_BL.AVISITVIS2 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   nuisance_FEV1_BL.AVISITVIS3 &lt;dbl&gt;, nuisance_FEV1_BL.AVISITVIS4 &lt;dbl&gt;, USUBJID &lt;fct&gt;,</span></span>
<span><span class="co">#&gt; #   AVISIT &lt;chr&gt;, FEV1_CHG &lt;dbl&gt;, FEV1_BL &lt;dbl&gt;, ARMCD &lt;chr&gt;, WEIGHT &lt;dbl&gt;, SEX &lt;fct&gt;</span></span></code></pre></div>
<p>Those new columns constitute a custom model matrix to describe the
desired parameterization. We have effects of interest to express
successive differences:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">archetype</span>, <span class="st">"brm_archetype_interest"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "x_PBO_VIS1" "x_PBO_VIS2" "x_PBO_VIS3" "x_PBO_VIS4" "x_TRT_VIS1" "x_TRT_VIS2" "x_TRT_VIS3"</span></span>
<span><span class="co">#&gt; [8] "x_TRT_VIS4"</span></span></code></pre></div>
<p>In addition, we have nuisance variables. Some nuisance variables are
continuous covariates, while others are levels of one-hot-encoded
concomitant factors or interactions of those concomitant factors with
baseline and/or subgroup. All nuisance variables are centered at their
means so the reference level of the model is at the “center” of the data
and not implicitly conditional on a subset of the data.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;code&gt;&lt;a href="../reference/brm_recenter_nuisance.html"&gt;brm_recenter_nuisance()&lt;/a&gt;&lt;/code&gt; can retroactively
recenter a nuisance column to a fixed value other than its mean.&lt;/p&gt;'><sup>1</sup></a> In addition, some
nuisance variables are automatically dropped in order to ensure the
model matrix is full-rank. This is critically important to preserve the
interpretation of the columns of interest and make sure the informative
priors behave as expected.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">archetype</span>, <span class="st">"brm_archetype_nuisance"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nuisance_WEIGHT"             "nuisance_SEX_Male"           "nuisance_FEV1_BL.AVISITVIS1"</span></span>
<span><span class="co">#&gt; [4] "nuisance_FEV1_BL.AVISITVIS2" "nuisance_FEV1_BL.AVISITVIS3" "nuisance_FEV1_BL.AVISITVIS4"</span></span></code></pre></div>
<p>The factors of interest linearly map to marginal means. To see the
mapping, call <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> on the archetype. The printed
output helps build intuition on how the archetype is parameterized and
what those parameters are doing.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">archetype</span><span class="op">)</span></span>
<span><span class="co">#&gt; # This is the "successive cells" informative prior archetype in brms.mmrm.</span></span>
<span><span class="co">#&gt; # The following equations show the relationships between the</span></span>
<span><span class="co">#&gt; # marginal means (left-hand side) and fixed effect parameters</span></span>
<span><span class="co">#&gt; # (right-hand side). You can create informative priors for the</span></span>
<span><span class="co">#&gt; # fixed effect parameters using historical borrowing,</span></span>
<span><span class="co">#&gt; # expert elicitation, or other methods.</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; #    PBO:VIS1 = x_PBO_VIS1</span></span>
<span><span class="co">#&gt; #    PBO:VIS2 = x_PBO_VIS1 + x_PBO_VIS2</span></span>
<span><span class="co">#&gt; #    PBO:VIS3 = x_PBO_VIS1 + x_PBO_VIS2 + x_PBO_VIS3</span></span>
<span><span class="co">#&gt; #    PBO:VIS4 = x_PBO_VIS1 + x_PBO_VIS2 + x_PBO_VIS3 + x_PBO_VIS4</span></span>
<span><span class="co">#&gt; #    TRT:VIS1 = x_TRT_VIS1</span></span>
<span><span class="co">#&gt; #    TRT:VIS2 = x_TRT_VIS1 + x_TRT_VIS2</span></span>
<span><span class="co">#&gt; #    TRT:VIS3 = x_TRT_VIS1 + x_TRT_VIS2 + x_TRT_VIS3</span></span>
<span><span class="co">#&gt; #    TRT:VIS4 = x_TRT_VIS1 + x_TRT_VIS2 + x_TRT_VIS3 + x_TRT_VIS4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="informative-priors">Informative priors<a class="anchor" aria-label="anchor" href="#informative-priors"></a>
</h2>
<p>Let’s assume you want to assign informative priors to the fixed
effect parameters of interest declared in the archetype, such as
<code>x_group_1_time_2</code> and <code>x_group_2_time_3</code>. Your
priors may come from expert elicitation, historical data, or some other
method, and you might consider <a href="https://github.com/stan-dev/stan/wiki/prior-choice-recommendations" class="external-link">distributional
families recommended by the Stan team</a>. However you construct these
priors, <code>brms.mmrm</code> helps you assign them to the model
without having to guess at the automatically-generated names of model
coefficients in R.</p>
<p>In the printed output from <code>summary(archetype)</code>,
parameters of interest such as <code>x_group_1_time_2</code> and
<code>x_group_2_time_3</code> are always labeled using treatment groups
and time points in the data (and subgroup levels, if applicable). This
labeling mechanism is the same regardless of which archetype you choose,
and it the way <code>brms.mmrm</code> helps you assign priors.</p>
<p><code><a href="../reference/brm_prior_label.html">brm_prior_label()</a></code> is one way to create a labeling
scheme. Each call to <code><a href="../reference/brm_prior_label.html">brm_prior_label()</a></code> below assigns a
univariate prior to a fixed effect parameter. Each univariate prior is a
Stan code string. Possible choices are documented in the Stan function
reference at <a href="https://mc-stan.org/docs/functions-reference/unbounded_continuous_distributions.html" class="external-link uri">https://mc-stan.org/docs/functions-reference/unbounded_continuous_distributions.html</a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">label</span> <span class="op">&lt;-</span> <span class="cn">NULL</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"student_t(4, -7.57, 4.96)"</span>, group <span class="op">=</span> <span class="st">"PBO"</span>, time <span class="op">=</span> <span class="st">"VIS1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"student_t(4,  3.14, 7.86)"</span>, group <span class="op">=</span> <span class="st">"PBO"</span>, time <span class="op">=</span> <span class="st">"VIS2"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"student_t(4,  8.78, 8.18)"</span>, group <span class="op">=</span> <span class="st">"PBO"</span>, time <span class="op">=</span> <span class="st">"VIS3"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"student_t(4,  3.36, 8.10)"</span>, group <span class="op">=</span> <span class="st">"PBO"</span>, time <span class="op">=</span> <span class="st">"VIS4"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"student_t(4, -2.96, 4.78)"</span>, group <span class="op">=</span> <span class="st">"TRT"</span>, time <span class="op">=</span> <span class="st">"VIS1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"student_t(4,  3.13, 7.64)"</span>, group <span class="op">=</span> <span class="st">"TRT"</span>, time <span class="op">=</span> <span class="st">"VIS2"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"student_t(4,  7.65, 8.24)"</span>, group <span class="op">=</span> <span class="st">"TRT"</span>, time <span class="op">=</span> <span class="st">"VIS3"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/brm_prior_label.html">brm_prior_label</a></span><span class="op">(</span>code <span class="op">=</span> <span class="st">"student_t(4,  4.64, 8.21)"</span>, group <span class="op">=</span> <span class="st">"TRT"</span>, time <span class="op">=</span> <span class="st">"VIS4"</span><span class="op">)</span></span>
<span><span class="va">label</span></span>
<span><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span><span class="co">#&gt;   code                      group time </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                     &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 student_t(4, -7.57, 4.96) PBO   VIS1 </span></span>
<span><span class="co">#&gt; 2 student_t(4,  3.14, 7.86) PBO   VIS2 </span></span>
<span><span class="co">#&gt; 3 student_t(4,  8.78, 8.18) PBO   VIS3 </span></span>
<span><span class="co">#&gt; 4 student_t(4,  3.36, 8.10) PBO   VIS4 </span></span>
<span><span class="co">#&gt; 5 student_t(4, -2.96, 4.78) TRT   VIS1 </span></span>
<span><span class="co">#&gt; 6 student_t(4,  3.13, 7.64) TRT   VIS2 </span></span>
<span><span class="co">#&gt; 7 student_t(4,  7.65, 8.24) TRT   VIS3 </span></span>
<span><span class="co">#&gt; 8 student_t(4,  4.64, 8.21) TRT   VIS4</span></span></code></pre></div>
<p>As an alternative to <code><a href="../reference/brm_prior_label.html">brm_prior_label()</a></code>, you can start
with a template and manually fill in the Stan code.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">template</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_prior_template.html">brm_prior_template</a></span><span class="op">(</span><span class="va">archetype</span><span class="op">)</span></span>
<span><span class="va">template</span></span>
<span><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span><span class="co">#&gt;   code  group time </span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 &lt;NA&gt;  PBO   VIS1 </span></span>
<span><span class="co">#&gt; 2 &lt;NA&gt;  PBO   VIS2 </span></span>
<span><span class="co">#&gt; 3 &lt;NA&gt;  PBO   VIS3 </span></span>
<span><span class="co">#&gt; 4 &lt;NA&gt;  PBO   VIS4 </span></span>
<span><span class="co">#&gt; 5 &lt;NA&gt;  TRT   VIS1 </span></span>
<span><span class="co">#&gt; 6 &lt;NA&gt;  TRT   VIS2 </span></span>
<span><span class="co">#&gt; 7 &lt;NA&gt;  TRT   VIS3 </span></span>
<span><span class="co">#&gt; 8 &lt;NA&gt;  TRT   VIS4</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">label</span> <span class="op">&lt;-</span> <span class="va">template</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"student_t(4, -7.57, 4.96)"</span>,</span>
<span>      <span class="st">"student_t(4,  3.14, 7.86)"</span>,</span>
<span>      <span class="st">"student_t(4,  8.78, 8.18)"</span>,</span>
<span>      <span class="st">"student_t(4,  3.36, 8.10)"</span>,</span>
<span>      <span class="st">"student_t(4, -2.96, 4.78)"</span>,</span>
<span>      <span class="st">"student_t(4,  3.13, 7.64)"</span>,</span>
<span>      <span class="st">"student_t(4,  7.65, 8.24)"</span>,</span>
<span>      <span class="st">"student_t(4,  4.64, 8.21)"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">label</span></span>
<span><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span><span class="co">#&gt;   code                      group time </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                     &lt;chr&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 student_t(4, -7.57, 4.96) PBO   VIS1 </span></span>
<span><span class="co">#&gt; 2 student_t(4,  3.14, 7.86) PBO   VIS2 </span></span>
<span><span class="co">#&gt; 3 student_t(4,  8.78, 8.18) PBO   VIS3 </span></span>
<span><span class="co">#&gt; 4 student_t(4,  3.36, 8.10) PBO   VIS4 </span></span>
<span><span class="co">#&gt; 5 student_t(4, -2.96, 4.78) TRT   VIS1 </span></span>
<span><span class="co">#&gt; 6 student_t(4,  3.13, 7.64) TRT   VIS2 </span></span>
<span><span class="co">#&gt; 7 student_t(4,  7.65, 8.24) TRT   VIS3 </span></span>
<span><span class="co">#&gt; 8 student_t(4,  4.64, 8.21) TRT   VIS4</span></span></code></pre></div>
<p>After you have a labeling scheme, <code><a href="../reference/brm_prior_archetype.html">brm_prior_archetype()</a></code>
can create a <code>brms</code> prior for the important fixed effects.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;code&gt;brms&lt;/code&gt; priors are documented in &lt;a href="https://paul-buerkner.github.io/brms/reference/set_prior.html" class="external-link uri"&gt;https://paul-buerkner.github.io/brms/reference/set_prior.html&lt;/a&gt;.&lt;/p&gt;'><sup>2</sup></a></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_prior_archetype.html">brm_prior_archetype</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">label</span>, archetype <span class="op">=</span> <span class="va">archetype</span><span class="op">)</span></span>
<span><span class="va">prior</span></span>
<span><span class="co">#&gt;                      prior class       coef group resp dpar nlpar   lb   ub source</span></span>
<span><span class="co">#&gt;  student_t(4, -7.57, 4.96)     b x_PBO_VIS1                       &lt;NA&gt; &lt;NA&gt;   user</span></span>
<span><span class="co">#&gt;  student_t(4,  3.14, 7.86)     b x_PBO_VIS2                       &lt;NA&gt; &lt;NA&gt;   user</span></span>
<span><span class="co">#&gt;  student_t(4,  8.78, 8.18)     b x_PBO_VIS3                       &lt;NA&gt; &lt;NA&gt;   user</span></span>
<span><span class="co">#&gt;  student_t(4,  3.36, 8.10)     b x_PBO_VIS4                       &lt;NA&gt; &lt;NA&gt;   user</span></span>
<span><span class="co">#&gt;  student_t(4, -2.96, 4.78)     b x_TRT_VIS1                       &lt;NA&gt; &lt;NA&gt;   user</span></span>
<span><span class="co">#&gt;  student_t(4,  3.13, 7.64)     b x_TRT_VIS2                       &lt;NA&gt; &lt;NA&gt;   user</span></span>
<span><span class="co">#&gt;  student_t(4,  7.65, 8.24)     b x_TRT_VIS3                       &lt;NA&gt; &lt;NA&gt;   user</span></span>
<span><span class="co">#&gt;  student_t(4,  4.64, 8.21)     b x_TRT_VIS4                       &lt;NA&gt; &lt;NA&gt;   user</span></span></code></pre></div>
<p>In less common situations, you may wish to assign priors to nuisance
parameters. For example, our model accounts for interactions between
baseline and discrete time, and it may be reasonable to assign priors to
these slopes based on high-quality historical data. This requires a
thorough understanding of the fixed effect structure of the model, but
it can be done directly through <code>brms</code>. First, check the
formula for the included nuisance parameters. <code><a href="../reference/brm_formula.html">brm_formula()</a></code>
automatically understands archetypes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_formula.html">brm_formula</a></span><span class="op">(</span><span class="va">archetype</span><span class="op">)</span></span>
<span><span class="co">#&gt; FEV1_CHG ~ 0 + x_PBO_VIS1 + x_PBO_VIS2 + x_PBO_VIS3 + x_PBO_VIS4 + x_TRT_VIS1 + x_TRT_VIS2 + x_TRT_VIS3 + x_TRT_VIS4 + nuisance_WEIGHT + nuisance_SEX_Male + nuisance_FEV1_BL.AVISITVIS1 + nuisance_FEV1_BL.AVISITVIS2 + nuisance_FEV1_BL.AVISITVIS3 + nuisance_FEV1_BL.AVISITVIS4 + unstr(time = AVISIT, gr = USUBJID) </span></span>
<span><span class="co">#&gt; sigma ~ 0 + AVISIT</span></span></code></pre></div>
<p>The <code>"nuisance_*"</code> terms are the nuisance variables, and
the ones involving baseline are
<code>nuisance_FEV1_BL.AVISITVIS1</code>,
<code>nuisance_FEV1_BL.AVISITVIS2</code>,
<code>nuisance_FEV1_BL.AVISITVIS3</code>, and
<code>nuisance_FEV1_BL.AVISITVIS4</code>. Because there is no overall
slope for baseline, we can interpret each term as the linear rate of
change in the outcome variable per unit increase in baseline for a given
discrete time point. Suppose we use this interpretation to construct
informative priors <code>student_t(4, -0.83, 1)</code>,
<code>student_t(4, -0.78, 1)</code>,
<code>student_t(4, -0.86, 1)</code>, and
<code>student_t(4, -0.82, 1)</code>, respectively. Use
<code><a href="https://paul-buerkner.github.io/brms/reference/set_prior.html" class="external-link">brms::set_prior()</a></code> and <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code> to append these
priors to our existing <code>prior</code> object:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">prior</span>,</span>
<span>  <span class="fu">set_prior</span><span class="op">(</span><span class="st">"student_t(4, -0.83, 1)"</span>, coef <span class="op">=</span> <span class="st">"nuisance_FEV1_BL.AVISITVIS1"</span><span class="op">)</span>,</span>
<span>  <span class="fu">set_prior</span><span class="op">(</span><span class="st">"student_t(4, -0.78, 1)"</span>, coef <span class="op">=</span> <span class="st">"nuisance_FEV1_BL.AVISITVIS2"</span><span class="op">)</span>,</span>
<span>  <span class="fu">set_prior</span><span class="op">(</span><span class="st">"student_t(4, -0.86, 1)"</span>, coef <span class="op">=</span> <span class="st">"nuisance_FEV1_BL.AVISITVIS3"</span><span class="op">)</span>,</span>
<span>  <span class="fu">set_prior</span><span class="op">(</span><span class="st">"student_t(4, -0.82, 1)"</span>, coef <span class="op">=</span> <span class="st">"nuisance_FEV1_BL.AVISITVIS4"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">prior</span></span>
<span><span class="co">#&gt;                      prior class                        coef group resp dpar nlpar   lb   ub</span></span>
<span><span class="co">#&gt;  student_t(4, -7.57, 4.96)     b                  x_PBO_VIS1                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(4,  3.14, 7.86)     b                  x_PBO_VIS2                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(4,  8.78, 8.18)     b                  x_PBO_VIS3                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(4,  3.36, 8.10)     b                  x_PBO_VIS4                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(4, -2.96, 4.78)     b                  x_TRT_VIS1                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(4,  3.13, 7.64)     b                  x_TRT_VIS2                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(4,  7.65, 8.24)     b                  x_TRT_VIS3                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(4,  4.64, 8.21)     b                  x_TRT_VIS4                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     student_t(4, -0.83, 1)     b nuisance_FEV1_BL.AVISITVIS1                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     student_t(4, -0.78, 1)     b nuisance_FEV1_BL.AVISITVIS2                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     student_t(4, -0.86, 1)     b nuisance_FEV1_BL.AVISITVIS3                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;     student_t(4, -0.82, 1)     b nuisance_FEV1_BL.AVISITVIS4                       &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  source</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span>
<span><span class="co">#&gt;    user</span></span></code></pre></div>
<p>The model still has many parameters where we did not set priors, and
<code>brms</code> sets automatic defaults. You can see these defaults
with <code><a href="https://paul-buerkner.github.io/brms/reference/default_prior.html" class="external-link">brms::get_prior()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paul-buerkner.github.io/brms/reference/default_prior.html" class="external-link">get_prior</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, data <span class="op">=</span> <span class="va">archetype</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Rows containing NAs were excluded from the model.</span></span>
<span><span class="co">#&gt;   prior   class                        coef group resp  dpar nlpar lb ub       source</span></span>
<span><span class="co">#&gt;  (flat)       b                                                               default</span></span>
<span><span class="co">#&gt;  (flat)       b nuisance_FEV1_BL.AVISITVIS1                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b nuisance_FEV1_BL.AVISITVIS2                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b nuisance_FEV1_BL.AVISITVIS3                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b nuisance_FEV1_BL.AVISITVIS4                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b           nuisance_SEX_Male                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b             nuisance_WEIGHT                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  x_PBO_VIS1                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  x_PBO_VIS2                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  x_PBO_VIS3                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  x_PBO_VIS4                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  x_TRT_VIS1                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  x_TRT_VIS2                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  x_TRT_VIS3                              (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  x_TRT_VIS4                              (vectorized)</span></span>
<span><span class="co">#&gt;  lkj(1) cortime                                                               default</span></span>
<span><span class="co">#&gt;  (flat)       b                                        sigma                  default</span></span>
<span><span class="co">#&gt;  (flat)       b                  AVISITVIS1            sigma             (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  AVISITVIS2            sigma             (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  AVISITVIS3            sigma             (vectorized)</span></span>
<span><span class="co">#&gt;  (flat)       b                  AVISITVIS4            sigma             (vectorized)</span></span></code></pre></div>
<p><a href="https://paul-buerkner.github.io/brms/reference/set_prior.html" class="external-link uri">https://paul-buerkner.github.io/brms/reference/set_prior.html</a>
documents many of the default priors set by <code>brms</code>. In
particular, <code>"(flat)"</code> denotes an improper uniform prior over
all the real numbers.</p>
</div>
<div class="section level2">
<h2 id="modeling-and-analysis">Modeling and analysis<a class="anchor" aria-label="anchor" href="#modeling-and-analysis"></a>
</h2>
<p>The downstream methods in <code>brms.mmrm</code> automatically
understand how to work with informative prior archetypes. Notably, the
formula uses custom interest and nuisance variables instead of the
original variables in the data.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_formula.html">brm_formula</a></span><span class="op">(</span><span class="va">archetype</span><span class="op">)</span></span>
<span><span class="va">formula</span></span>
<span><span class="co">#&gt; FEV1_CHG ~ 0 + x_PBO_VIS1 + x_PBO_VIS2 + x_PBO_VIS3 + x_PBO_VIS4 + x_TRT_VIS1 + x_TRT_VIS2 + x_TRT_VIS3 + x_TRT_VIS4 + nuisance_WEIGHT + nuisance_SEX_Male + nuisance_FEV1_BL.AVISITVIS1 + nuisance_FEV1_BL.AVISITVIS2 + nuisance_FEV1_BL.AVISITVIS3 + nuisance_FEV1_BL.AVISITVIS4 + unstr(time = AVISIT, gr = USUBJID) </span></span>
<span><span class="co">#&gt; sigma ~ 0 + AVISIT</span></span></code></pre></div>
<p>The model can accept the archetype, formula, and prior. Usage is the
same as in non-archetype workflows.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_model.html">brm_model</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">archetype</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">prior</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Compiling Stan program...</span></span>
<span><span class="co">#&gt; Start sampling</span></span>
<span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstantools/reference/prior_summary.html" class="external-link">prior_summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt;                      prior    class                        coef group resp  dpar nlpar lb ub</span></span>
<span><span class="co">#&gt;                     (flat)        b                                                         </span></span>
<span><span class="co">#&gt;     student_t(4, -0.83, 1)        b nuisance_FEV1_BL.AVISITVIS1                             </span></span>
<span><span class="co">#&gt;     student_t(4, -0.78, 1)        b nuisance_FEV1_BL.AVISITVIS2                             </span></span>
<span><span class="co">#&gt;     student_t(4, -0.86, 1)        b nuisance_FEV1_BL.AVISITVIS3                             </span></span>
<span><span class="co">#&gt;     student_t(4, -0.82, 1)        b nuisance_FEV1_BL.AVISITVIS4                             </span></span>
<span><span class="co">#&gt;                     (flat)        b           nuisance_SEX_Male                             </span></span>
<span><span class="co">#&gt;                     (flat)        b             nuisance_WEIGHT                             </span></span>
<span><span class="co">#&gt;  student_t(4, -7.57, 4.96)        b                  x_PBO_VIS1                             </span></span>
<span><span class="co">#&gt;  student_t(4,  3.14, 7.86)        b                  x_PBO_VIS2                             </span></span>
<span><span class="co">#&gt;  student_t(4,  8.78, 8.18)        b                  x_PBO_VIS3                             </span></span>
<span><span class="co">#&gt;  student_t(4,  3.36, 8.10)        b                  x_PBO_VIS4                             </span></span>
<span><span class="co">#&gt;  student_t(4, -2.96, 4.78)        b                  x_TRT_VIS1                             </span></span>
<span><span class="co">#&gt;  student_t(4,  3.13, 7.64)        b                  x_TRT_VIS2                             </span></span>
<span><span class="co">#&gt;  student_t(4,  7.65, 8.24)        b                  x_TRT_VIS3                             </span></span>
<span><span class="co">#&gt;  student_t(4,  4.64, 8.21)        b                  x_TRT_VIS4                             </span></span>
<span><span class="co">#&gt;                     (flat)        b                                        sigma            </span></span>
<span><span class="co">#&gt;                     (flat)        b                  AVISITVIS1            sigma            </span></span>
<span><span class="co">#&gt;                     (flat)        b                  AVISITVIS2            sigma            </span></span>
<span><span class="co">#&gt;                     (flat)        b                  AVISITVIS3            sigma            </span></span>
<span><span class="co">#&gt;                     (flat)        b                  AVISITVIS4            sigma            </span></span>
<span><span class="co">#&gt;       lkj_corr_cholesky(1) Lcortime                                                         </span></span>
<span><span class="co">#&gt;        source</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;       default</span></span></code></pre></div>
<p>Marginal mean estimation, post-processing, and visualization
automatically understand the archetype without any user
intervention.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_draws.html">brm_marginal_draws</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">archetype</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>  model <span class="op">=</span> <span class="va">model</span></span>
<span><span class="op">)</span></span>
<span><span class="va">summaries_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_summaries.html">brm_marginal_summaries</a></span><span class="op">(</span><span class="va">draws</span><span class="op">)</span></span>
<span><span class="va">summaries_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_data.html">brm_marginal_data</a></span><span class="op">(</span><span class="va">archetype</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/brm_plot_compare.html">brm_plot_compare</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">summaries_model</span>, data <span class="op">=</span> <span class="va">summaries_data</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="archetypes_figures/archetype_compare_data-1.png" alt="plot of chunk archetype_compare_data"><p class="caption">
plot of chunk archetype_compare_data
</p>
</div>
</div>
<div class="section level2">
<h2 id="other-archetypes">Other archetypes<a class="anchor" aria-label="anchor" href="#other-archetypes"></a>
</h2>
<p>Other informative prior archetypes use different fixed effects. For
example, <code>brms.mmrm</code> supports simple cell mean and treatment
effect parameterizations.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/brm_archetype_cells.html">brm_archetype_cells</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # This is the "cells" informative prior archetype in brms.mmrm.</span></span>
<span><span class="co">#&gt; # The following equations show the relationships between the</span></span>
<span><span class="co">#&gt; # marginal means (left-hand side) and fixed effect parameters</span></span>
<span><span class="co">#&gt; # (right-hand side). You can create informative priors for the</span></span>
<span><span class="co">#&gt; # fixed effect parameters using historical borrowing,</span></span>
<span><span class="co">#&gt; # expert elicitation, or other methods.</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; #    PBO:VIS1 = x_PBO_VIS1</span></span>
<span><span class="co">#&gt; #    PBO:VIS2 = x_PBO_VIS2</span></span>
<span><span class="co">#&gt; #    PBO:VIS3 = x_PBO_VIS3</span></span>
<span><span class="co">#&gt; #    PBO:VIS4 = x_PBO_VIS4</span></span>
<span><span class="co">#&gt; #    TRT:VIS1 = x_TRT_VIS1</span></span>
<span><span class="co">#&gt; #    TRT:VIS2 = x_TRT_VIS2</span></span>
<span><span class="co">#&gt; #    TRT:VIS3 = x_TRT_VIS3</span></span>
<span><span class="co">#&gt; #    TRT:VIS4 = x_TRT_VIS4</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/brm_archetype_effects.html">brm_archetype_effects</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # This is the "effects" informative prior archetype in brms.mmrm.</span></span>
<span><span class="co">#&gt; # The following equations show the relationships between the</span></span>
<span><span class="co">#&gt; # marginal means (left-hand side) and fixed effect parameters</span></span>
<span><span class="co">#&gt; # (right-hand side). You can create informative priors for the</span></span>
<span><span class="co">#&gt; # fixed effect parameters using historical borrowing,</span></span>
<span><span class="co">#&gt; # expert elicitation, or other methods.</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; #    PBO:VIS1 = x_PBO_VIS1</span></span>
<span><span class="co">#&gt; #    PBO:VIS2 = x_PBO_VIS2</span></span>
<span><span class="co">#&gt; #    PBO:VIS3 = x_PBO_VIS3</span></span>
<span><span class="co">#&gt; #    PBO:VIS4 = x_PBO_VIS4</span></span>
<span><span class="co">#&gt; #    TRT:VIS1 = x_PBO_VIS1 + x_TRT_VIS1</span></span>
<span><span class="co">#&gt; #    TRT:VIS2 = x_PBO_VIS2 + x_TRT_VIS2</span></span>
<span><span class="co">#&gt; #    TRT:VIS3 = x_PBO_VIS3 + x_TRT_VIS3</span></span>
<span><span class="co">#&gt; #    TRT:VIS4 = x_PBO_VIS4 + x_TRT_VIS4</span></span></code></pre></div>
<p>There are archetypes to parameterize the average across all time
points in the data. Below, <code>x_group_1_time_2</code> is the average
across time points for group 1 because it is the algebraic result of
simplifying
<code>(group_1:time_2 + group_1:time_3 + group_1:time_3) / 3</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/brm_archetype_average_cells.html">brm_archetype_average_cells</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # This is the "average cells" informative prior archetype in brms.mmrm.</span></span>
<span><span class="co">#&gt; # The following equations show the relationships between the</span></span>
<span><span class="co">#&gt; # marginal means (left-hand side) and fixed effect parameters</span></span>
<span><span class="co">#&gt; # (right-hand side). You can create informative priors for the</span></span>
<span><span class="co">#&gt; # fixed effect parameters using historical borrowing,</span></span>
<span><span class="co">#&gt; # expert elicitation, or other methods.</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; #    PBO:VIS1 = 4*x_PBO_VIS1 - x_PBO_VIS2 - x_PBO_VIS3 - x_PBO_VIS4</span></span>
<span><span class="co">#&gt; #    PBO:VIS2 = x_PBO_VIS2</span></span>
<span><span class="co">#&gt; #    PBO:VIS3 = x_PBO_VIS3</span></span>
<span><span class="co">#&gt; #    PBO:VIS4 = x_PBO_VIS4</span></span>
<span><span class="co">#&gt; #    TRT:VIS1 = 4*x_TRT_VIS1 - x_TRT_VIS2 - x_TRT_VIS3 - x_TRT_VIS4</span></span>
<span><span class="co">#&gt; #    TRT:VIS2 = x_TRT_VIS2</span></span>
<span><span class="co">#&gt; #    TRT:VIS3 = x_TRT_VIS3</span></span>
<span><span class="co">#&gt; #    TRT:VIS4 = x_TRT_VIS4</span></span></code></pre></div>
<p>There is also a treatment effect version where
<code>x_group_2_time_2</code> becomes the time-averaged treatment effect
of group 2 relative to group 1.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/brm_archetype_average_effects.html">brm_archetype_average_effects</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # This is the "average effects" informative prior archetype in brms.mmrm.</span></span>
<span><span class="co">#&gt; # The following equations show the relationships between the</span></span>
<span><span class="co">#&gt; # marginal means (left-hand side) and fixed effect parameters</span></span>
<span><span class="co">#&gt; # (right-hand side). You can create informative priors for the</span></span>
<span><span class="co">#&gt; # fixed effect parameters using historical borrowing,</span></span>
<span><span class="co">#&gt; # expert elicitation, or other methods.</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; #    PBO:VIS1 = 4*x_PBO_VIS1 - x_PBO_VIS2 - x_PBO_VIS3 - x_PBO_VIS4</span></span>
<span><span class="co">#&gt; #    PBO:VIS2 = x_PBO_VIS2</span></span>
<span><span class="co">#&gt; #    PBO:VIS3 = x_PBO_VIS3</span></span>
<span><span class="co">#&gt; #    PBO:VIS4 = x_PBO_VIS4</span></span>
<span><span class="co">#&gt; #    TRT:VIS1 = 4*x_PBO_VIS1 - x_PBO_VIS2 - x_PBO_VIS3 - x_PBO_VIS4 + 4*x_TRT_VIS1 - x_TRT_VIS2 - x_TRT_VIS3 - x_TRT_VIS4</span></span>
<span><span class="co">#&gt; #    TRT:VIS2 = x_PBO_VIS2 + x_TRT_VIS2</span></span>
<span><span class="co">#&gt; #    TRT:VIS3 = x_PBO_VIS3 + x_TRT_VIS3</span></span>
<span><span class="co">#&gt; #    TRT:VIS4 = x_PBO_VIS4 + x_TRT_VIS4</span></span></code></pre></div>
<p>In addition, there is a treatment effect version of the successive
differences archetype from earlier in the vignette.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/brm_archetype_successive_effects.html">brm_archetype_successive_effects</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # This is the "successive effects" informative prior archetype in brms.mmrm.</span></span>
<span><span class="co">#&gt; # The following equations show the relationships between the</span></span>
<span><span class="co">#&gt; # marginal means (left-hand side) and fixed effect parameters</span></span>
<span><span class="co">#&gt; # (right-hand side). You can create informative priors for the</span></span>
<span><span class="co">#&gt; # fixed effect parameters using historical borrowing,</span></span>
<span><span class="co">#&gt; # expert elicitation, or other methods.</span></span>
<span><span class="co">#&gt; # </span></span>
<span><span class="co">#&gt; #    PBO:VIS1 = x_PBO_VIS1</span></span>
<span><span class="co">#&gt; #    PBO:VIS2 = x_PBO_VIS1 + x_PBO_VIS2</span></span>
<span><span class="co">#&gt; #    PBO:VIS3 = x_PBO_VIS1 + x_PBO_VIS2 + x_PBO_VIS3</span></span>
<span><span class="co">#&gt; #    PBO:VIS4 = x_PBO_VIS1 + x_PBO_VIS2 + x_PBO_VIS3 + x_PBO_VIS4</span></span>
<span><span class="co">#&gt; #    TRT:VIS1 = x_PBO_VIS1 + x_TRT_VIS1</span></span>
<span><span class="co">#&gt; #    TRT:VIS2 = x_PBO_VIS1 + x_PBO_VIS2 + x_TRT_VIS1 + x_TRT_VIS2</span></span>
<span><span class="co">#&gt; #    TRT:VIS3 = x_PBO_VIS1 + x_PBO_VIS2 + x_PBO_VIS3 + x_TRT_VIS1 + x_TRT_VIS2 + x_TRT_VIS3</span></span>
<span><span class="co">#&gt; #    TRT:VIS4 = x_PBO_VIS1 + x_PBO_VIS2 + x_PBO_VIS3 + x_PBO_VIS4 + x_TRT_VIS1 + x_TRT_VIS2 + x_TRT_VIS3 + x_TRT_VIS4</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by William Michael Landau, Kevin Kunzmann, Yoni Sidi, Christian Stock, Eli Lilly and Company, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
