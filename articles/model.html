<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="brms.mmrm">
<title>Model • brms.mmrm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model">
<meta property="og:description" content="brms.mmrm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">brms.mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Usage</h6>
    <a class="dropdown-item" href="../articles/usage.html">Usage</a>
    <a class="dropdown-item" href="../articles/subgroup.html">Subgroup analysis</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Validation</h6>
    <a class="dropdown-item" href="../articles/sbc.html">Simulation-based calibration</a>
    <a class="dropdown-item" href="../articles/fev1.html">FEV1 data comparison between Bayesian and frequentist MMRMs</a>
    <a class="dropdown-item" href="../articles/bcva.html">BCVA data comparison between Bayesian and frequentist MMRMs</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/brms.mmrm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/brms.mmrm/blob/HEAD/vignettes/model.Rmd" class="external-link"><code>vignettes/model.Rmd</code></a></small>
      <div class="d-none name"><code>model.Rmd</code></div>
    </div>

    
    
<p>The <code>brms.mmrm</code> R package implements a mixed model of
repeated measures (MMRM), a popular and flexible model to analyze
continuous longitudinal outcomes (<span class="citation">Mallinckrodt et
al. (2008)</span>, <span class="citation">Mallinckrodt and Lipkovich
(2017)</span>). <code>brms.mmrm</code> focuses on marginal MMRMs for
randomized controlled parallel studies with discrete time points, where
each subject shares the same set of time points. Whereas the <a href="https://openpharma.github.io/mmrm/" class="external-link"><code>mmrm</code></a> package
is frequentist, <code>brms.mmrm</code> fits models in Bayesian fashion
using <a href="https://paul-buerkner.github.io/brms/" class="external-link"><code>brms</code></a> <span class="citation">(Bürkner 2017)</span>.</p>
<div class="section level2">
<h2 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<p>The MMRM in <code>brms.mmrm</code> is mathematically expressed as
follows. Subsequent sections define notation, data, parameters, and
priors.</p>
<div class="section level3">
<h3 id="heterogeneous-variance-model">Heterogeneous variance model<a class="anchor" aria-label="anchor" href="#heterogeneous-variance-model"></a>
</h3>
<p>If the user selects heterogeneous variance in
<code><a href="../reference/brm_formula.html">brm_formula()</a></code>, then the model is expressed as follows.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;y_i \stackrel{\text{ind}}{\sim} \text{Multivariate-Normal} \left
(\text{mean} = X_{i} \beta, \ \text{covariance} = \text{diag}(\sigma)
\cdot \Lambda \cdot \text{diag}(\sigma) \right ) \\
&amp;\qquad \beta_p \stackrel{\text{ind}}{\sim} q_p() \\
&amp;\qquad \Lambda \sim r() \\
&amp;\qquad \tau_t = \log(\sigma_t) \\
&amp;\qquad \qquad \tau_t \stackrel{\text{ind}}{\sim} s()
\end{aligned}
\]</span></p>
</div>
<div class="section level3">
<h3 id="homogeneous-variance-model">Homogeneous variance model<a class="anchor" aria-label="anchor" href="#homogeneous-variance-model"></a>
</h3>
<p>If the user select homogeneous variance in
<code><a href="../reference/brm_formula.html">brm_formula()</a></code>, then all discrete time points share the same
standard deviation parameter, and <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\tau\)</span> are scalars instead of vectors.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;y_i \stackrel{\text{ind}}{\sim} \text{Multivariate-Normal} \left
(\text{mean} = X_{i} \beta, \ \text{covariance} =  \sigma^2
\Lambda  \right ) \\
&amp;\qquad \beta_p \stackrel{\text{ind}}{\sim} q_p() \\
&amp;\qquad \Lambda \sim r() \\
&amp;\qquad \tau = \log(\sigma) \\
&amp;\qquad \qquad \tau \sim s()
\end{aligned}
\]</span></p>
</div>
</div>
<div class="section level2">
<h2 id="notation">Notation<a class="anchor" aria-label="anchor" href="#notation"></a>
</h2>
<ul>
<li>
<span class="math inline">\(i\)</span>: positive integer index of a
subject or patient in the study.</li>
<li>
<span class="math inline">\(t\)</span>: positive integer index of a
discrete time point in the study.</li>
<li>
<span class="math inline">\(p\)</span>: positive integer index of a
model coefficient parameter <span class="math inline">\(\beta_p\)</span>.</li>
<li>
<span class="math inline">\(\theta_j \stackrel{\text{ind}}{\sim}
f()\)</span>: assuming <span class="math inline">\(j\)</span> is a
positive integer index that ranges from 1 to positive integer <span class="math inline">\(J\)</span>, this notation declares that parameters
<span class="math inline">\(\theta_1, \ldots, \theta_J\)</span> are
independent and each follow the prior distribution with a common
probability density function <span class="math inline">\(f()\)</span>.</li>
<li>
<span class="math inline">\(\theta_j \stackrel{\text{ind}}{\sim}
f_j()\)</span>: same as above, except each <span class="math inline">\(\theta_j\)</span> parameter follows its own
separate prior distribution with probability density function <span class="math inline">\(p_j()\)</span>. <span class="math inline">\(p_i()\)</span> and <span class="math inline">\(f_j()\)</span> may differ if <span class="math inline">\(i \ne j\)</span>.</li>
<li>
<span class="math inline">\(\text{diag}(\theta)\)</span>: diagonal
matrix with the scalar elements of vector <span class="math inline">\(\theta\)</span> on the diagonal and off-diagonal
elements equal to 0. The number of rows and number of columns in this
matrix are both equal to the number of elements in vector <span class="math inline">\(\theta\)</span>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<ul>
<li>
<span class="math inline">\(y_i\)</span>: numeric vector of outcome
observations for subject <span class="math inline">\(i\)</span>. The
number of elements in the vector equals the number of discrete time
points in the study, and for the purposes of this model specification,
they are sorted chronologically with the first element of <span class="math inline">\(y_i\)</span> observed first in the study. One or
more elements of each <span class="math inline">\(y_i\)</span> may be
missing due to dropout, discontinuation, etc. The likelihood of the
model assumes <span class="math inline">\(y_i\)</span> is independent of
<span class="math inline">\(y_j\)</span> for <span class="math inline">\(i \ne j\)</span>.</li>
<li>
<span class="math inline">\(X_i\)</span>: a matrix containing the
rows of the model matrix that correspond to subject <span class="math inline">\(i\)</span>. The rows of <span class="math inline">\(X_i\)</span> correspond to the elements of the
vector <span class="math inline">\(y_i\)</span> (equivalently, the
discrete time points of the study), and the columns of <span class="math inline">\(X_i\)</span> correspond to the model coefficient
parameters <span class="math inline">\(\beta_p\)</span>. The composition
of <span class="math inline">\(X_i\)</span> is determined by the
covariates in the input dataset and the choice of model formula supplied
by the user (via <code><a href="../reference/brm_formula.html">brm_formula()</a></code>). In subgroup analysis,
<span class="math inline">\(X_i\)</span> contains columns denoting
different subgroup levels, as well as any interaction terms declared
through the formula.</li>
</ul>
</div>
<div class="section level2">
<h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h2>
<ul>
<li>
<span class="math inline">\(\beta\)</span>: vector of model
coefficients. <span class="math inline">\(\beta_p\)</span> is scalar
element <span class="math inline">\(p\)</span> of <span class="math inline">\(\beta\)</span>. In subgroup analysis, <span class="math inline">\(\beta\)</span> contains model coefficients for
different subgroup levels, as well as any interaction terms declared
through the model formula.</li>
<li>
<span class="math inline">\(\Lambda\)</span>: matrix of pairwise
correlations among each pair of time points within subjects. Outcomes
measured from different subjects are assumed to be independent, and
outcomes observed at different time points for the same subject are
assumed to be correlated according to this matrix. <span class="math inline">\(\Lambda\)</span> is positive-definite and
symmetric, and the number of rows and columns is equal to the number of
discrete time points of the study.</li>
<li>
<span class="math inline">\(\sigma\)</span>: in the heterogeneous
variance model, <span class="math inline">\(\sigma\)</span> is a vector
of time-point-specific standard deviations of the residuals on the
linear scale. <span class="math inline">\(\sigma_t\)</span> is scalar
element <span class="math inline">\(t\)</span> of <span class="math inline">\(\sigma\)</span>. In the homogeneous variance
model, <span class="math inline">\(\sigma\)</span> is a scalar shared by
all time points.</li>
<li>
<span class="math inline">\(\tau\)</span>: same as <span class="math inline">\(\sigma\)</span>, but on the natural logarithmic
scale. In the heterogeneous variance case, <span class="math inline">\(\tau\)</span> is a vector of time-specific
elements <span class="math inline">\(\tau_t\)</span>, and each scalar
element <span class="math inline">\(\tau_t\)</span> of <span class="math inline">\(\tau\)</span> is defined as the natural logarithm
of <span class="math inline">\(\sigma_t\)</span>. In the homogeneous
variance case, <span class="math inline">\(\tau\)</span> is a scalar,
still on the natural log scale (log of <span class="math inline">\(\sigma\)</span>).</li>
</ul>
</div>
<div class="section level2">
<h2 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h2>
<p>The priors on the parameters depend on the <code>prior</code>
argument of <code><a href="../reference/brm_model.html">brm_model()</a></code> and related functions. If priors
are not specified by the user, then the <a href="https://paul-buerkner.github.io/brms/" class="external-link"><code>brms</code></a>
package sets defaults. You can view the default priors using the <a href="http://paul-buerkner.github.io/brms/reference/get_prior.html" class="external-link"><code>get_prior()</code></a>
function in <a href="https://paul-buerkner.github.io/brms/" class="external-link"><code>brms</code></a>. See
the <a href="https://paul-buerkner.github.io/brms/" class="external-link"><code>brms</code></a> for
information on how <a href="https://paul-buerkner.github.io/brms/" class="external-link"><code>brms</code></a> sets
default priors.</p>
<ul>
<li>
<span class="math inline">\(q_p()\)</span>: univariate prior on the
model coefficient <span class="math inline">\(\beta_p\)</span>.</li>
<li>
<span class="math inline">\(r()\)</span>: matrix prior on the
within-subject residual correlation matrix parameter <span class="math inline">\(\Lambda\)</span>. Can be unstructured,
autoregressive moving average, autoregressive, moving average, or
compound symmetry, c.f. <a href="https://paul-buerkner.github.io/brms/reference/autocor-terms.html" class="external-link uri">https://paul-buerkner.github.io/brms/reference/autocor-terms.html</a>.</li>
<li>
<span class="math inline">\(s()\)</span>: univariate prior on the
scalar components of the natural-log-standard-deviation parameter <span class="math inline">\(\tau\)</span>. The components of <span class="math inline">\(\tau\)</span> are assumed independent and
identically distributed with this univariate prior.</li>
</ul>
</div>
<div class="section level2">
<h2 id="sampling">Sampling<a class="anchor" aria-label="anchor" href="#sampling"></a>
</h2>
<p><code>brms.mmrm</code>, through <a href="https://paul-buerkner.github.io/brms/" class="external-link"><code>brms</code></a>, fits
the model to the data using the Markov chain Monte Carlo (MCMC)
capabilities of <a href="https://mc-stan.org/" class="external-link">Stan</a> <span class="citation">(Stan Development Team 2023)</span>. Please read <a href="https://mc-stan.org/users/documentation/" class="external-link uri">https://mc-stan.org/users/documentation/</a> for more
details on the methodology of <a href="https://mc-stan.org/" class="external-link">Stan</a>.
The result of MCMC is a collection of draws from the full joint
posterior distribution of the parameters given the data. Individual
draws of scalar parameters such as <span class="math inline">\(\beta_3\)</span> are considered draws from the
marginal posterior distribution of e.g. <span class="math inline">\(\beta_3\)</span> given the data.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-burkner2017" class="csl-entry">
Bürkner, P.-C. (2017), <span>“<span class="nocase">brms</span>: An
<span>R</span> package for <span>Bayesian</span> multilevel models using
<span>Stan</span>,”</span> <em>Journal of Statistical Software</em>, 80,
1–28. <a href="https://doi.org/10.18637/jss.v080.i01" class="external-link">https://doi.org/10.18637/jss.v080.i01</a>.
</div>
<div id="ref-mallinckrodt2008" class="csl-entry">
Mallinckrodt, C. H., Lane, P. W., Schnell, D., and others (2008),
<span>“Recommendations for the primary analysis of continuous endpoints
in longitudinal clinical trials,”</span> <em>Therapeutic Innovation and
Regulatory Science</em>, 42, 303–319. <a href="https://doi.org/10.1177/009286150804200402" class="external-link">https://doi.org/10.1177/009286150804200402</a>.
</div>
<div id="ref-mallinckrodt2017" class="csl-entry">
Mallinckrodt, C. H., and Lipkovich, I. (2017), <em>Analyzing
longitudinal clinical trial data: A practical guide</em>, CRC Press,
Taylor; Francis Group.
</div>
<div id="ref-stan2023" class="csl-entry">
Stan Development Team (2023), <em><a href="https://mc-stan.org" class="external-link">Stan
modeling language users guide and reference manual</a></em>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by William Michael Landau, Kevin Kunzmann, Yoni Sidi, Christian Stock, Eli Lilly and Company, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
