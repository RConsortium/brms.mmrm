<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="brms.mmrm">
<title>Subgroup analysis • brms.mmrm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Subgroup analysis">
<meta property="og:description" content="brms.mmrm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">brms.mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Usage</h6>
    <a class="dropdown-item" href="../articles/usage.html">Usage</a>
    <a class="dropdown-item" href="../articles/subgroup.html">Subgroup analysis</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Validation</h6>
    <a class="dropdown-item" href="../articles/sbc.html">Simulation-based calibration</a>
    <a class="dropdown-item" href="../articles/fev1.html">FEV1 data comparison between Bayesian and frequentist MMRMs</a>
    <a class="dropdown-item" href="../articles/bcva.html">BCVA data comparison between Bayesian and frequentist MMRMs</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/brms.mmrm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Subgroup analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/brms.mmrm/blob/HEAD/vignettes/subgroup.Rmd" class="external-link"><code>vignettes/subgroup.Rmd</code></a></small>
      <div class="d-none name"><code>subgroup.Rmd</code></div>
    </div>

    
    
<p>This vignette explains how to incorporate a subgroup variable into an
MMRM using the <code>brms.mmrm</code> package. Here, we assume the
subgroup variable has already been selected in advance (perhaps
pre-specified in a trial protocol) because interactions are anticipated
or of particular interest. Especially if heterogeneous patient
populations are studied, it is important to check that the estimated
overall effect is broadly applicable to relevant subgroups (<span class="citation">ICH (1998)</span>, <span class="citation">EMA
(2019)</span>). It is worth noting, however, that subgroup variable
selection is a thorough process that requires deep domain knowledge,
careful adjustments for multiplicity, and potentially different modeling
approaches, all of which belongs outside the scope of this vignette.
Limitations of one-variable-at-a-time subgroup analyses to detect
treatment effect heterogeneity have been described in the literature
<span class="citation">(Kent 2023)</span>. For literature on data-driven
subgroup identification methods in clinical trials, we refer to <span class="citation">Lipkovich et al. (2017)</span> and <span class="citation">Lipkovich et al. (2023)</span>.</p>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The subgroup variable must be categorical.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/brms.mmrm/" class="external-link">brms.mmrm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0L</span><span class="op">)</span></span>
<span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_simulate_outline.html">brm_simulate_outline</a></span><span class="op">(</span></span>
<span>  n_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_subgroup <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n_patient <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  n_time <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  rate_dropout <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  rate_lapse <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">raw_data</span></span>
<span><span class="co">#&gt; # A tibble: 900 × 6</span></span>
<span><span class="co">#&gt;    response missing group   subgroup   time   patient    </span></span>
<span><span class="co">#&gt;       &lt;dbl&gt; &lt;lgl&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;      </span></span>
<span><span class="co">#&gt;  1  1.26    FALSE   group_1 subgroup_1 time_1 patient_001</span></span>
<span><span class="co">#&gt;  2 -0.326   FALSE   group_1 subgroup_1 time_2 patient_001</span></span>
<span><span class="co">#&gt;  3  1.33    FALSE   group_1 subgroup_1 time_3 patient_001</span></span>
<span><span class="co">#&gt;  4  1.27    FALSE   group_1 subgroup_1 time_1 patient_002</span></span>
<span><span class="co">#&gt;  5  0.415   FALSE   group_1 subgroup_1 time_2 patient_002</span></span>
<span><span class="co">#&gt;  6 -1.54    FALSE   group_1 subgroup_1 time_3 patient_002</span></span>
<span><span class="co">#&gt;  7 -0.929   FALSE   group_1 subgroup_1 time_1 patient_003</span></span>
<span><span class="co">#&gt;  8 -0.295   FALSE   group_1 subgroup_1 time_2 patient_003</span></span>
<span><span class="co">#&gt;  9 -0.00577 FALSE   group_1 subgroup_1 time_3 patient_003</span></span>
<span><span class="co">#&gt; 10  2.40    FALSE   group_1 subgroup_1 time_1 patient_004</span></span>
<span><span class="co">#&gt; # ℹ 890 more rows</span></span></code></pre></div>
<p>Each categorical subgroup level should have adequate representation
among all treatment groups at all discrete time points. Otherwise, some
marginal means of interest may not be estimable.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">raw_data</span>, <span class="va">group</span>, <span class="va">subgroup</span>, <span class="va">time</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 18 × 4</span></span>
<span><span class="co">#&gt;    group   subgroup   time       n</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 group_1 subgroup_1 time_1    50</span></span>
<span><span class="co">#&gt;  2 group_1 subgroup_1 time_2    50</span></span>
<span><span class="co">#&gt;  3 group_1 subgroup_1 time_3    50</span></span>
<span><span class="co">#&gt;  4 group_1 subgroup_2 time_1    50</span></span>
<span><span class="co">#&gt;  5 group_1 subgroup_2 time_2    50</span></span>
<span><span class="co">#&gt;  6 group_1 subgroup_2 time_3    50</span></span>
<span><span class="co">#&gt;  7 group_2 subgroup_1 time_1    50</span></span>
<span><span class="co">#&gt;  8 group_2 subgroup_1 time_2    50</span></span>
<span><span class="co">#&gt;  9 group_2 subgroup_1 time_3    50</span></span>
<span><span class="co">#&gt; 10 group_2 subgroup_2 time_1    50</span></span>
<span><span class="co">#&gt; 11 group_2 subgroup_2 time_2    50</span></span>
<span><span class="co">#&gt; 12 group_2 subgroup_2 time_3    50</span></span>
<span><span class="co">#&gt; 13 group_3 subgroup_1 time_1    50</span></span>
<span><span class="co">#&gt; 14 group_3 subgroup_1 time_2    50</span></span>
<span><span class="co">#&gt; 15 group_3 subgroup_1 time_3    50</span></span>
<span><span class="co">#&gt; 16 group_3 subgroup_2 time_1    50</span></span>
<span><span class="co">#&gt; 17 group_3 subgroup_2 time_2    50</span></span>
<span><span class="co">#&gt; 18 group_3 subgroup_2 time_3    50</span></span></code></pre></div>
<p>When you create the special classed dataset for
<code>brms.mmrm</code> using <code><a href="../reference/brm_data.html">brm_data()</a></code>, please supply the
name of the subgroup variable and a reference subgroup level.
Post-processing functions will use the reference subgroup level to
compare pairs of subgroups: for example, the treatment effect of
<code>subgroup_2</code> minus the treatment effect of the reference
subgroup level you choose.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_data.html">brm_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">raw_data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  role <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  baseline <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  subgroup <span class="op">=</span> <span class="st">"subgroup"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  patient <span class="op">=</span> <span class="st">"patient"</span>,</span>
<span>  reference_group <span class="op">=</span> <span class="st">"group_1"</span>,</span>
<span>  reference_subgroup <span class="op">=</span> <span class="st">"subgroup_1"</span>,</span>
<span>  reference_time <span class="op">=</span> <span class="st">"time_1"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; brm_data [900 × 5] (S3: brm_data/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ response: num [1:900] 1.263 -0.326 1.33 1.272 0.415 ...</span></span>
<span><span class="co">#&gt;  $ group   : chr [1:900] "group_1" "group_1" "group_1" "group_1" ...</span></span>
<span><span class="co">#&gt;  $ subgroup: chr [1:900] "subgroup_1" "subgroup_1" "subgroup_1" "subgroup_1" ...</span></span>
<span><span class="co">#&gt;  $ time    : chr [1:900] "time_1" "time_2" "time_3" "time_1" ...</span></span>
<span><span class="co">#&gt;  $ patient : chr [1:900] "patient_001" "patient_001" "patient_001" "patient_002" ...</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_outcome")= chr "response"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_role")= chr "response"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_group")= chr "group"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_subgroup")= chr "subgroup"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_time")= chr "time"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_patient")= chr "patient"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_covariates")= chr(0) </span></span>
<span><span class="co">#&gt;  - attr(*, "brm_reference_group")= chr "group_1"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_reference_subgroup")= chr "subgroup_1"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_reference_time")= chr "time_1"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_levels_group")= chr [1:3] "group_1" "group_2" "group_3"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_levels_subgroup")= chr [1:2] "subgroup_1" "subgroup_2"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_levels_time")= chr [1:3] "time_1" "time_2" "time_3"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_labels_group")= chr [1:3] "group_1" "group_2" "group_3"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_labels_subgroup")= chr [1:2] "subgroup_1" "subgroup_2"</span></span>
<span><span class="co">#&gt;  - attr(*, "brm_labels_time")= chr [1:3] "time_1" "time_2" "time_3"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="formula">Formula<a class="anchor" aria-label="anchor" href="#formula"></a>
</h2>
<p>For subgroup analysis, the formula should have terms that include the
subgroup variable. All plausible interactions are optional via arguments
of <code><a href="../reference/brm_formula.html">brm_formula()</a></code>. For this specific example, we disable all
interactions except group-subgroup interaction.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula_subgroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_formula.html">brm_formula</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  group_subgroup_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subgroup_time <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">formula_subgroup</span></span>
<span><span class="co">#&gt; response ~ group + group:subgroup + group:time + subgroup + time + unstr(time = time, gr = patient) </span></span>
<span><span class="co">#&gt; sigma ~ 0 + time</span></span></code></pre></div>
<p>To create an analogous non-subgroup reduced model, disable each of
the terms that involve the subgroup. This will be useful later on for
measuring the impact of the subgroup as a whole, without needing to
restrict to a specific level of the subgroup.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;If analyzing change from baseline, you would also need
to set &lt;code&gt;baseline_subgroup = FALSE&lt;/code&gt; and
&lt;code&gt;baseline_subgroup_time = FALSE&lt;/code&gt; in the formula of the
reduced model.&lt;/p&gt;"><sup>1</sup></a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">formula_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_formula.html">brm_formula</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  group_subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_subgroup_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subgroup_time <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">formula_reduced</span></span>
<span><span class="co">#&gt; response ~ group + group:time + time + unstr(time = time, gr = patient) </span></span>
<span><span class="co">#&gt; sigma ~ 0 + time</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h2>
<p>To run the full subgroup and reduced non-subgroup models, use
<code><a href="../reference/brm_model.html">brm_model()</a></code> as usual. Remember to supply the appropriate
formula to each case.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_subgroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_model.html">brm_model</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">formula_subgroup</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Compiling Stan program...</span></span>
<span><span class="co">#&gt; Start sampling</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_model.html">brm_model</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">formula_reduced</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Compiling Stan program...</span></span>
<span><span class="co">#&gt; Start sampling</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="marginals">Marginals<a class="anchor" aria-label="anchor" href="#marginals"></a>
</h2>
<p>For the subgroup model, <code><a href="../reference/brm_marginal_draws.html">brm_marginal_draws()</a></code> can
summarize subgroup-specific and non-subgroup-specific marginal means.
The latter is useful for direct comparison with the non-subgroup reduced
model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws_subgroup_specific</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_draws.html">brm_marginal_draws</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">model_subgroup</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  use_subgroup <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws_subgroup_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_draws.html">brm_marginal_draws</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">model_subgroup</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  use_subgroup <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">draws_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_draws.html">brm_marginal_draws</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">model_reduced</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  use_subgroup <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For <code>draws_subgroup_specific</code>, the marginals of the time
difference (change from baseline) and treatment difference are the same
as before, except now they are subgroup-specific.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">draws_subgroup_specific</span><span class="op">$</span><span class="va">difference_group</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4,000 × 11</span></span>
<span><span class="co">#&gt;    .chain .draw .iteration `group_2|subgroup_1|time_2` group_2|subgroup_1|tim…¹</span></span>
<span><span class="co">#&gt;     &lt;int&gt; &lt;int&gt;      &lt;int&gt;                       &lt;dbl&gt;                    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1      1     1          1                     0.167                     0.0351</span></span>
<span><span class="co">#&gt;  2      1     2          2                     0.160                    -0.143 </span></span>
<span><span class="co">#&gt;  3      1     3          3                     0.182                    -0.125 </span></span>
<span><span class="co">#&gt;  4      1     4          4                     0.288                    -0.179 </span></span>
<span><span class="co">#&gt;  5      1     5          5                    -0.0850                   -0.314 </span></span>
<span><span class="co">#&gt;  6      1     6          6                    -0.0195                   -0.278 </span></span>
<span><span class="co">#&gt;  7      1     7          7                    -0.0925                   -0.314 </span></span>
<span><span class="co">#&gt;  8      1     8          8                     0.421                    -0.0122</span></span>
<span><span class="co">#&gt;  9      1     9          9                     0.222                    -0.136 </span></span>
<span><span class="co">#&gt; 10      1    10         10                     0.00918                  -0.262 </span></span>
<span><span class="co">#&gt; # ℹ 3,990 more rows</span></span>
<span><span class="co">#&gt; # ℹ abbreviated name: ¹​`group_2|subgroup_1|time_3`</span></span>
<span><span class="co">#&gt; # ℹ 6 more variables: `group_2|subgroup_2|time_2` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `group_2|subgroup_2|time_3` &lt;dbl&gt;, `group_3|subgroup_1|time_2` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `group_3|subgroup_1|time_3` &lt;dbl&gt;, `group_3|subgroup_2|time_2` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `group_3|subgroup_2|time_3` &lt;dbl&gt;</span></span></code></pre></div>
<p>In addition, there is a new <code>difference_subgroup</code> table.
The posterior samples in <code>difference_subgroup</code> measure the
differences between each subgroup level and the reference subgroup level
with respect to the treatment effects in
<code>difference_group</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">draws_subgroup_specific</span><span class="op">$</span><span class="va">difference_subgroup</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4,000 × 7</span></span>
<span><span class="co">#&gt;    .chain .draw .iteration `group_2|subgroup_2|time_2` group_2|subgroup_2|tim…¹</span></span>
<span><span class="co">#&gt;     &lt;int&gt; &lt;int&gt;      &lt;int&gt;                       &lt;dbl&gt;                    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1      1     1          1                    0                       -5.55e-17</span></span>
<span><span class="co">#&gt;  2      1     2          2                    0                        0       </span></span>
<span><span class="co">#&gt;  3      1     3          3                    5.55e-17                -2.78e-17</span></span>
<span><span class="co">#&gt;  4      1     4          4                    0                        0       </span></span>
<span><span class="co">#&gt;  5      1     5          5                    0                        0       </span></span>
<span><span class="co">#&gt;  6      1     6          6                    0                       -5.55e-17</span></span>
<span><span class="co">#&gt;  7      1     7          7                    0                        0       </span></span>
<span><span class="co">#&gt;  8      1     8          8                    1.11e-16                 5.55e-17</span></span>
<span><span class="co">#&gt;  9      1     9          9                    0                        5.55e-17</span></span>
<span><span class="co">#&gt; 10      1    10         10                    0                        5.55e-17</span></span>
<span><span class="co">#&gt; # ℹ 3,990 more rows</span></span>
<span><span class="co">#&gt; # ℹ abbreviated name: ¹​`group_2|subgroup_2|time_3`</span></span>
<span><span class="co">#&gt; # ℹ 2 more variables: `group_3|subgroup_2|time_2` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `group_3|subgroup_2|time_3` &lt;dbl&gt;</span></span></code></pre></div>
<p>The <code><a href="../reference/brm_marginal_summaries.html">brm_marginal_summaries()</a></code> and
<code><a href="../reference/brm_marginal_probabilities.html">brm_marginal_probabilities()</a></code> are automatically aware of any
subgroup-specific marginals from <code><a href="../reference/brm_marginal_draws.html">brm_marginal_draws()</a></code>.
Notably, <code><a href="../reference/brm_marginal_summaries.html">brm_marginal_summaries()</a></code> summarizes the subgroup
differences in the <code>difference_subgroup</code> table from
<code><a href="../reference/brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summaries_subgroup_specific</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_summaries.html">brm_marginal_summaries</a></span><span class="op">(</span></span>
<span>  <span class="va">draws_subgroup_specific</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries_subgroup_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_summaries.html">brm_marginal_summaries</a></span><span class="op">(</span></span>
<span>  <span class="va">draws_subgroup_comparison</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_summaries.html">brm_marginal_summaries</a></span><span class="op">(</span></span>
<span>  <span class="va">draws_reduced</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries_subgroup_specific</span></span>
<span><span class="co">#&gt; # A tibble: 250 × 7</span></span>
<span><span class="co">#&gt;    marginal         statistic group   subgroup   time     value    mcse</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;            &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 difference_group lower     group_2 subgroup_1 time_2 -0.314  0.0116 </span></span>
<span><span class="co">#&gt;  2 difference_group lower     group_2 subgroup_1 time_3 -0.542  0.00881</span></span>
<span><span class="co">#&gt;  3 difference_group lower     group_2 subgroup_2 time_2 -0.314  0.0116 </span></span>
<span><span class="co">#&gt;  4 difference_group lower     group_2 subgroup_2 time_3 -0.542  0.00881</span></span>
<span><span class="co">#&gt;  5 difference_group lower     group_3 subgroup_1 time_2 -0.118  0.00782</span></span>
<span><span class="co">#&gt;  6 difference_group lower     group_3 subgroup_1 time_3 -0.277  0.0152 </span></span>
<span><span class="co">#&gt;  7 difference_group lower     group_3 subgroup_2 time_2 -0.118  0.00782</span></span>
<span><span class="co">#&gt;  8 difference_group lower     group_3 subgroup_2 time_3 -0.277  0.0152 </span></span>
<span><span class="co">#&gt;  9 difference_group mean      group_2 subgroup_1 time_2  0.0882 0.00443</span></span>
<span><span class="co">#&gt; 10 difference_group mean      group_2 subgroup_1 time_3 -0.171  0.00412</span></span>
<span><span class="co">#&gt; # ℹ 240 more rows</span></span></code></pre></div>
<p><code><a href="../reference/brm_marginal_probabilities.html">brm_marginal_probabilities()</a></code> still focuses on treatment
effects, not on differences between pairs of subgroup levels.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_marginal_probabilities.html">brm_marginal_probabilities</a></span><span class="op">(</span></span>
<span>  draws <span class="op">=</span> <span class="va">draws_subgroup_specific</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  direction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"greater"</span>, <span class="st">"less"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 16 × 6</span></span>
<span><span class="co">#&gt;    direction threshold group   subgroup   time   value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 greater        -0.1 group_2 subgroup_1 time_2 0.825</span></span>
<span><span class="co">#&gt;  2 greater        -0.1 group_2 subgroup_1 time_3 0.357</span></span>
<span><span class="co">#&gt;  3 greater        -0.1 group_2 subgroup_2 time_2 0.825</span></span>
<span><span class="co">#&gt;  4 greater        -0.1 group_2 subgroup_2 time_3 0.357</span></span>
<span><span class="co">#&gt;  5 greater        -0.1 group_3 subgroup_1 time_2 0.968</span></span>
<span><span class="co">#&gt;  6 greater        -0.1 group_3 subgroup_1 time_3 0.854</span></span>
<span><span class="co">#&gt;  7 greater        -0.1 group_3 subgroup_2 time_2 0.968</span></span>
<span><span class="co">#&gt;  8 greater        -0.1 group_3 subgroup_2 time_3 0.854</span></span>
<span><span class="co">#&gt;  9 less            0.1 group_2 subgroup_1 time_2 0.525</span></span>
<span><span class="co">#&gt; 10 less            0.1 group_2 subgroup_1 time_3 0.918</span></span>
<span><span class="co">#&gt; 11 less            0.1 group_2 subgroup_2 time_2 0.525</span></span>
<span><span class="co">#&gt; 12 less            0.1 group_2 subgroup_2 time_3 0.918</span></span>
<span><span class="co">#&gt; 13 less            0.1 group_3 subgroup_1 time_2 0.205</span></span>
<span><span class="co">#&gt; 14 less            0.1 group_3 subgroup_1 time_3 0.504</span></span>
<span><span class="co">#&gt; 15 less            0.1 group_3 subgroup_2 time_2 0.205</span></span>
<span><span class="co">#&gt; 16 less            0.1 group_3 subgroup_2 time_3 0.504</span></span></code></pre></div>
<p><code>brm_marignal_data()</code> can produce either subgroup-specific
or non-subgroup-specific summary statistics.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summaries_data_subgroup</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_data.html">brm_marginal_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  use_subgroup <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries_data_subgroup</span></span>
<span><span class="co">#&gt; # A tibble: 126 × 5</span></span>
<span><span class="co">#&gt;    statistic group   subgroup   time   value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 lower     group_1 subgroup_1 time_1 0.170</span></span>
<span><span class="co">#&gt;  2 lower     group_1 subgroup_1 time_2 0.244</span></span>
<span><span class="co">#&gt;  3 lower     group_1 subgroup_1 time_3 0.169</span></span>
<span><span class="co">#&gt;  4 lower     group_1 subgroup_2 time_1 0.484</span></span>
<span><span class="co">#&gt;  5 lower     group_1 subgroup_2 time_2 0.364</span></span>
<span><span class="co">#&gt;  6 lower     group_1 subgroup_2 time_3 0.266</span></span>
<span><span class="co">#&gt;  7 lower     group_2 subgroup_1 time_1 0.421</span></span>
<span><span class="co">#&gt;  8 lower     group_2 subgroup_1 time_2 0.221</span></span>
<span><span class="co">#&gt;  9 lower     group_2 subgroup_1 time_3 0.208</span></span>
<span><span class="co">#&gt; 10 lower     group_2 subgroup_2 time_1 0.220</span></span>
<span><span class="co">#&gt; # ℹ 116 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summaries_data_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/brm_marginal_data.html">brm_marginal_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  use_subgroup <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries_data_reduced</span></span>
<span><span class="co">#&gt; # A tibble: 63 × 4</span></span>
<span><span class="co">#&gt;    statistic group   time     value</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 lower     group_1 time_1  0.251 </span></span>
<span><span class="co">#&gt;  2 lower     group_1 time_2  0.219 </span></span>
<span><span class="co">#&gt;  3 lower     group_1 time_3  0.143 </span></span>
<span><span class="co">#&gt;  4 lower     group_2 time_1  0.237 </span></span>
<span><span class="co">#&gt;  5 lower     group_2 time_2  0.252 </span></span>
<span><span class="co">#&gt;  6 lower     group_2 time_3 -0.0331</span></span>
<span><span class="co">#&gt;  7 lower     group_3 time_1  0.104 </span></span>
<span><span class="co">#&gt;  8 lower     group_3 time_2  0.332 </span></span>
<span><span class="co">#&gt;  9 lower     group_3 time_3  0.110 </span></span>
<span><span class="co">#&gt; 10 mean      group_1 time_1  0.0632</span></span>
<span><span class="co">#&gt; # ℹ 53 more rows</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-comparison">Model comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<p>Metrics from <code>brms</code> can compare the full subgroup and
reduced non-subgroup model to assess the effect of the subgroup as a
whole. We can easily compute the widely applicable information criterion
(WAIC) of each model.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/waic.html" class="external-link">waic</a></span><span class="op">(</span><span class="va">model_subgroup</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computed from 4000 by 900 log-likelihood matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Estimate   SE</span></span>
<span><span class="co">#&gt; elpd_waic  -1275.6 20.0</span></span>
<span><span class="co">#&gt; p_waic        19.9  1.0</span></span>
<span><span class="co">#&gt; waic        2551.2 39.9</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/waic.html" class="external-link">waic</a></span><span class="op">(</span><span class="va">model_reduced</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computed from 4000 by 900 log-likelihood matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Estimate   SE</span></span>
<span><span class="co">#&gt; elpd_waic  -1274.1 20.0</span></span>
<span><span class="co">#&gt; p_waic        17.3  0.9</span></span>
<span><span class="co">#&gt; waic        2548.2 40.1</span></span></code></pre></div>
<p>Likewise, we can compare the models in terms of the expected log
predictive density (ELPD) based on approximate Pareto-smoothed
leave-one-out cross-validation.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_subgroup</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="va">model_subgroup</span><span class="op">)</span></span>
<span><span class="va">loo_reduced</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html" class="external-link">loo</a></span><span class="op">(</span><span class="va">model_reduced</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_subgroup</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computed from 4000 by 900 log-likelihood matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          Estimate   SE</span></span>
<span><span class="co">#&gt; elpd_loo  -1275.7 20.0</span></span>
<span><span class="co">#&gt; p_loo        19.9  1.0</span></span>
<span><span class="co">#&gt; looic      2551.3 39.9</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; Monte Carlo SE of elpd_loo is 0.1.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All Pareto k estimates are good (k &lt; 0.5).</span></span>
<span><span class="co">#&gt; See help('pareto-k-diagnostic') for details.</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo_reduced</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computed from 4000 by 900 log-likelihood matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          Estimate   SE</span></span>
<span><span class="co">#&gt; elpd_loo  -1274.1 20.0</span></span>
<span><span class="co">#&gt; p_loo        17.3  0.9</span></span>
<span><span class="co">#&gt; looic      2548.3 40.1</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; Monte Carlo SE of elpd_loo is 0.1.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All Pareto k estimates are good (k &lt; 0.5).</span></span>
<span><span class="co">#&gt; See help('pareto-k-diagnostic') for details.</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">loo</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html" class="external-link">loo_compare</a></span><span class="op">(</span><span class="va">loo_subgroup</span>, <span class="va">loo_reduced</span><span class="op">)</span></span>
<span><span class="co">#&gt;                elpd_diff se_diff</span></span>
<span><span class="co">#&gt; model_reduced   0.0       0.0   </span></span>
<span><span class="co">#&gt; model_subgroup -1.5       1.6</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p><code><a href="../reference/brm_plot_draws.html">brm_plot_draws()</a></code> is aware of any subgroup-specific
marginal means.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_plot_draws.html">brm_plot_draws</a></span><span class="op">(</span><span class="va">draws_subgroup_specific</span><span class="op">$</span><span class="va">difference_group</span><span class="op">)</span></span></code></pre></div>
<p><img src="subgroup/draws-1.png"></p>
<p>You can adjust visual aesthetics to compare subgroup levels side by
side if subgroup level is the primary comparison of interest.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_plot_draws.html">brm_plot_draws</a></span><span class="op">(</span></span>
<span>  <span class="va">draws_subgroup_specific</span><span class="op">$</span><span class="va">difference_group</span>,</span>
<span>  axis <span class="op">=</span> <span class="st">"subgroup"</span>,</span>
<span>  facet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"group"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="subgroup/drawscustom-1.png"></p>
<p>The following function call compares the subgroup model results
against the subgroup data.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_plot_compare.html">brm_plot_compare</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">summaries_data_subgroup</span>,</span>
<span>  model <span class="op">=</span> <span class="va">summaries_subgroup_specific</span>,</span>
<span>  marginal <span class="op">=</span> <span class="st">"response"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="subgroup/subgroup-vs-data-1.png"></p>
<p>You can adjust plot aesthetics to view subgroup levels side by side
as the primary comparison of interest.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_plot_compare.html">brm_plot_compare</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">summaries_data_subgroup</span>,</span>
<span>  model <span class="op">=</span> <span class="va">summaries_subgroup_specific</span>,</span>
<span>  marginal <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  compare <span class="op">=</span> <span class="st">"subgroup"</span>,</span>
<span>  axis <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  facet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span>, <span class="st">"source"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="subgroup/subgroup-vs-data-levels-1.png"></p>
<p>We can also visually compare the treatment effects of the full
subgroup and reduced non-subgroup models, marginalizing over subgroup
levels in both cases.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/brm_plot_compare.html">brm_plot_compare</a></span><span class="op">(</span></span>
<span>  subgroup <span class="op">=</span> <span class="va">summaries_subgroup_comparison</span>,</span>
<span>  reduced <span class="op">=</span> <span class="va">summaries_reduced</span>,</span>
<span>  marginal <span class="op">=</span> <span class="st">"difference_group"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="subgroup/reduced-model-comparison-1.png"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-EMA2019" class="csl-entry">
EMA (2019), <em>Guideline on the investigation of subgroups in
confirmatory clinical trials</em>, European Medicines Agency; <a href="https://www.ema.europa.eu/en/investigation-subgroups-confirmatory-clinical-trials-scientific-guideline" class="external-link uri">https://www.ema.europa.eu/en/investigation-subgroups-confirmatory-clinical-trials-scientific-guideline</a>.
</div>
<div id="ref-ICH1998" class="csl-entry">
ICH (1998), <span>“International council for harmonisation of technical
requirements for pharmaceuticals for human use (ICH) E9 guideline.
Statistical principles for clinical trials,”</span> <a href="https://database.ich.org/sites/default/files/E9_Guideline.pdf" class="external-link uri">https://database.ich.org/sites/default/files/E9_Guideline.pdf</a>.
</div>
<div id="ref-Kent2023" class="csl-entry">
Kent, D. M. (2023), <span>“<span class="nocase"><span>O</span>verall
average treatment effects from clinical trials, one-variable-at-a-time
subgroup analyses and predictive approaches to heterogeneous treatment
effects: <span>T</span>oward a more patient-centered evidence-based
medicine</span>,”</span> <em>Clin Trials</em>, 20, 328–337.
</div>
<div id="ref-Lipkovich2017" class="csl-entry">
Lipkovich, I., Dmitrienko, A., and B, R. (2017), <span>“<span class="nocase"><span>T</span>utorial in biostatistics: data-driven
subgroup identification and analysis in clinical trials</span>,”</span>
<em>Stat Med</em>, 36, 136–196.
</div>
<div id="ref-Lipkovich2023" class="csl-entry">
Lipkovich, I., Svensson, D., Ratitch, B., and Dmitrienko, A. (2023),
<span>“<span class="nocase"><span>O</span>verview of modern approaches
for identifying and evaluating heterogeneous treatment effects from
clinical data</span>,”</span> <em>Clin Trials</em>, 20, 380–393.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by William Michael Landau, Kevin Kunzmann, Yoni Sidi, Christian Stock, Eli Lilly and Company, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
