<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="brms.mmrm">
<title>Simulation-based calibration • brms.mmrm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulation-based calibration">
<meta property="og:description" content="brms.mmrm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">brms.mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Usage</h6>
    <a class="dropdown-item" href="../articles/usage.html">Usage</a>
    <a class="dropdown-item" href="../articles/subgroup.html">Subgroup analysis</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Validation</h6>
    <a class="dropdown-item" href="../articles/sbc.html">Simulation-based calibration</a>
    <a class="dropdown-item" href="../articles/fev1.html">FEV1 data comparison between Bayesian and frequentist MMRMs</a>
    <a class="dropdown-item" href="../articles/bcva.html">BCVA data comparison between Bayesian and frequentist MMRMs</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/brms.mmrm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Simulation-based calibration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/brms.mmrm/blob/HEAD/vignettes/sbc.Rmd" class="external-link"><code>vignettes/sbc.Rmd</code></a></small>
      <div class="d-none name"><code>sbc.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>This vignette shows the results of a simulation-based calibration
(SBC) study to validate the implementation of the models in
<code>brms.mmrm</code>. SBC tests the ability of a Bayesian model to
recapture the parameters used to simulate prior predictive data. For
details on SBC, please read <span class="citation">Talts et al.
(2020)</span> and the <a href="https://hyunjimoon.github.io/SBC/" class="external-link"><code>SBC</code></a> R package
<span class="citation">(Kim et al. 2022)</span>. This particular SBC
study uses the <a href="https://docs.ropensci.org/targets/" class="external-link"><code>targets</code></a>
pipeline in the <a href="https://github.com/openpharma/brms.mmrm/tree/main/sbc" class="external-link"><code>sbc</code></a>
subdirectory of the <a href="https://github.com/openpharma/brms.mmrm" class="external-link"><code>brms.mmrm</code></a>
package source code.</p>
</div>
<div class="section level2">
<h2 id="simple-scenario">Simple scenario<a class="anchor" aria-label="anchor" href="#simple-scenario"></a>
</h2>
<p>In the simple scenario, we simulate datasets from the prior
predictive distribution assuming 3 treatment groups, 4 time points, 100
patients per treatment group, no adjustment for covariates, and no
missing responses. The model formula is:</p>
<pre><code><span><span class="co">#&gt; response ~ 0 + group + group:time + time + unstr(time = time, gr = patient) </span></span>
<span><span class="co">#&gt; sigma ~ 0 + time</span></span></code></pre>
<p>The prior was randomly generated and used for both simulation and
analysis:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fst</span><span class="fu">::</span><span class="fu"><a href="http://www.fstpackage.org/reference/write_fst.html" class="external-link">read_fst</a></span><span class="op">(</span><span class="st">"sbc/prior_simple.fst"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        prior    class         coef  dpar</span></span>
<span><span class="co">#&gt; 1  lkj_corr_cholesky(1.1759) Lcortime                   </span></span>
<span><span class="co">#&gt; 2     normal(-0.108, 1.9497)        b groupgroup_1      </span></span>
<span><span class="co">#&gt; 3     normal(0.0441, 1.3727)        b groupgroup_2      </span></span>
<span><span class="co">#&gt; 4    normal(-0.2303, 0.2806)        b groupgroup_3      </span></span>
<span><span class="co">#&gt; 5     normal(0.0631, 1.6016)        b   timetime_2      </span></span>
<span><span class="co">#&gt; 6       normal(0.16, 1.4724)        b   timetime_3      </span></span>
<span><span class="co">#&gt; 7     normal(0.0631, 1.7156)        b   timetime_4      </span></span>
<span><span class="co">#&gt; 8     normal(0.0389, 2.2844)        b   timetime_1 sigma</span></span>
<span><span class="co">#&gt; 9      normal(0.1793, 1.808)        b   timetime_2 sigma</span></span>
<span><span class="co">#&gt; 10    normal(0.1637, 1.4719)        b   timetime_3 sigma</span></span>
<span><span class="co">#&gt; 11    normal(0.0186, 0.7794)        b   timetime_4 sigma</span></span></code></pre></div>
<p>The following histograms show the SBC rank statistics which compare
the prior parameter draws draws to the posterior draws. If the data
simulation code and modeling code are both correct and consistent, then
the rank statistics should be uniformly distributed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">read_ranks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">path</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">fst</span><span class="fu">::</span><span class="fu"><a href="http://www.fstpackage.org/reference/write_fst.html" class="external-link">read_fst</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>      cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      names_to <span class="op">=</span> <span class="st">"parameter"</span>,</span>
<span>      values_to <span class="op">=</span> <span class="st">"rank"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">plot_ranks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rank</span><span class="op">)</span>,</span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">ranks</span><span class="op">$</span><span class="va">rank</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">parameter</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simple_ranks</span> <span class="op">&lt;-</span> <span class="fu">read_ranks</span><span class="op">(</span><span class="st">"sbc/simple.fst"</span><span class="op">)</span></span></code></pre></div>
<p>Fixed effect parameter ranks:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simple_ranks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^b_"</span>, <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^b_sigma"</span>, <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_ranks</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sbc_files/figure-html/unnamed-chunk-6-1.png" width="768">
Log-scale standard deviation parameter ranks:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simple_ranks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"b_sigma"</span>, <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_ranks</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sbc_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<p>Correlation parameter ranks:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simple_ranks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"cortime_"</span>, <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_ranks</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sbc_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="complex-scenario">Complex scenario<a class="anchor" aria-label="anchor" href="#complex-scenario"></a>
</h2>
<p>In the complex scenario, we simulate datasets from the prior
predictive distribution assuming 2 treatment groups, 2 subgroup levels,
3 time points, 150 patients per treatment group, adjustment for two
continuous and two categorical baseline covariates, 30% dropout, and an
8% rate of independent/sporadic missing values. The model formula
is:</p>
<pre><code><span><span class="co">#&gt; response ~ group + group:subgroup + group:subgroup:time + group:time + subgroup + subgroup:time + time + continuous1 + continuous2 + balanced + unbalanced + unstr(time = time, gr = patient) </span></span>
<span><span class="co">#&gt; sigma ~ 0 + time</span></span></code></pre>
<p>The prior was randomly generated and used for both simulation and
analysis:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fst</span><span class="fu">::</span><span class="fu"><a href="http://www.fstpackage.org/reference/write_fst.html" class="external-link">read_fst</a></span><span class="op">(</span><span class="st">"sbc/prior_complex.fst"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                        prior     class</span></span>
<span><span class="co">#&gt; 1  lkj_corr_cholesky(1.4621)  Lcortime</span></span>
<span><span class="co">#&gt; 2    normal(-0.1661, 2.3091) Intercept</span></span>
<span><span class="co">#&gt; 3    normal(-0.1831, 1.8732)         b</span></span>
<span><span class="co">#&gt; 4     normal(0.1578, 2.8225)         b</span></span>
<span><span class="co">#&gt; 5    normal(-0.1069, 1.7987)         b</span></span>
<span><span class="co">#&gt; 6    normal(-0.1071, 0.5407)         b</span></span>
<span><span class="co">#&gt; 7     normal(-0.1028, 0.464)         b</span></span>
<span><span class="co">#&gt; 8     normal(-0.007, 0.7129)         b</span></span>
<span><span class="co">#&gt; 9     normal(0.1007, 1.8179)         b</span></span>
<span><span class="co">#&gt; 10   normal(-0.1965, 2.9243)         b</span></span>
<span><span class="co">#&gt; 11   normal(-0.0911, 1.5937)         b</span></span>
<span><span class="co">#&gt; 12    normal(0.0536, 0.7669)         b</span></span>
<span><span class="co">#&gt; 13    normal(0.0973, 0.5859)         b</span></span>
<span><span class="co">#&gt; 14    normal(0.0741, 2.3458)         b</span></span>
<span><span class="co">#&gt; 15     normal(-0.17, 2.9882)         b</span></span>
<span><span class="co">#&gt; 16    normal(0.1211, 0.7527)         b</span></span>
<span><span class="co">#&gt; 17    normal(-0.234, 2.0401)         b</span></span>
<span><span class="co">#&gt; 18   normal(-0.0457, 2.2697)         b</span></span>
<span><span class="co">#&gt; 19    normal(-0.181, 2.8068)         b</span></span>
<span><span class="co">#&gt; 20    normal(0.1093, 2.3647)         b</span></span>
<span><span class="co">#&gt; 21    normal(-0.0878, 1.165)         b</span></span>
<span><span class="co">#&gt; 22   normal(-0.2374, 1.5208)         b</span></span>
<span><span class="co">#&gt;                                          coef  dpar</span></span>
<span><span class="co">#&gt; 1                                                  </span></span>
<span><span class="co">#&gt; 2                                                  </span></span>
<span><span class="co">#&gt; 3                              balancedlevel2      </span></span>
<span><span class="co">#&gt; 4                              balancedlevel3      </span></span>
<span><span class="co">#&gt; 5                                 continuous1      </span></span>
<span><span class="co">#&gt; 6                                 continuous2      </span></span>
<span><span class="co">#&gt; 7                                groupgroup_2      </span></span>
<span><span class="co">#&gt; 8             groupgroup_2:subgroupsubgroup_2      </span></span>
<span><span class="co">#&gt; 9  groupgroup_2:subgroupsubgroup_2:timetime_2      </span></span>
<span><span class="co">#&gt; 10 groupgroup_2:subgroupsubgroup_2:timetime_3      </span></span>
<span><span class="co">#&gt; 11                    groupgroup_2:timetime_2      </span></span>
<span><span class="co">#&gt; 12                    groupgroup_2:timetime_3      </span></span>
<span><span class="co">#&gt; 13                         subgroupsubgroup_2      </span></span>
<span><span class="co">#&gt; 14              subgroupsubgroup_2:timetime_2      </span></span>
<span><span class="co">#&gt; 15              subgroupsubgroup_2:timetime_3      </span></span>
<span><span class="co">#&gt; 16                                 timetime_2      </span></span>
<span><span class="co">#&gt; 17                                 timetime_3      </span></span>
<span><span class="co">#&gt; 18                           unbalancedlevel2      </span></span>
<span><span class="co">#&gt; 19                           unbalancedlevel3      </span></span>
<span><span class="co">#&gt; 20                                 timetime_1 sigma</span></span>
<span><span class="co">#&gt; 21                                 timetime_2 sigma</span></span>
<span><span class="co">#&gt; 22                                 timetime_3 sigma</span></span></code></pre></div>
<p>The following histograms show the SBC rank statistics which compare
the prior parameter draws draws to the posterior draws. If the data
simulation code and modeling code are both correct and consistent, then
the rank statistics should be uniformly distributed.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complex_ranks</span> <span class="op">&lt;-</span> <span class="fu">read_ranks</span><span class="op">(</span><span class="st">"sbc/complex.fst"</span><span class="op">)</span></span></code></pre></div>
<p>Fixed effect parameter ranks:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complex_ranks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^b_"</span>, <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^b_sigma"</span>, <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_ranks</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sbc_files/figure-html/unnamed-chunk-12-1.png" width="768">
Log-scale standard deviation parameter ranks:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complex_ranks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"b_sigma"</span>, <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_ranks</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sbc_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<p>Correlation parameter ranks:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complex_ranks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"cortime_"</span>, <span class="va">parameter</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">plot_ranks</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sbc_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The SBC rank statistics look uniformly distributed. In other words,
the posterior distribution from the <code>brms</code>/Stan MMRM modeling
code matches the prior from which the datasets were simulated. This is
evidence that both the subgroup and non-subgroup models in
<code>brms.mmrm</code> are implemented correctly.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-sbc" class="csl-entry">
Kim, S., Moon, H., Modrák, M., and Säilynoja, T. (2022), <em>SBC:
Simulation based calibration for rstan/cmdstanr models</em>.
</div>
<div id="ref-talts2020" class="csl-entry">
Talts, S., Betancourt, M., Simpson, D., Vehtari, A., and Gelman, A.
(2020), <span>“<a href="https://arxiv.org/abs/1804.06788" class="external-link">Validating
bayesian inference algorithms with simulation-based
calibration</a>.”</span>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by William Michael Landau, Kevin Kunzmann, Yoni Sidi, Christian Stock, Eli Lilly and Company, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
