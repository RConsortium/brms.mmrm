[{"path":[]},{"path":"/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement .landau@gmail.com. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"id_1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"id_2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"id_3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"id_4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to brms.mmrm","title":"Contributing to brms.mmrm","text":"outlines propose change brms.mmrm. detailed info contributing , tidyverse packages, please see development contributing guide.","code":""},{"path":"/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to brms.mmrm","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to brms.mmrm","text":"want make bigger change, ’s good idea first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed).","code":""},{"path":"/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to brms.mmrm","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"RConsortium/brms.mmrm\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to brms.mmrm","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2, Markdown syntax, documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"/CONTRIBUTING.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Contributing to brms.mmrm","text":"Please note brms.mmrm project released Contributor Code Conduct. contributing project agree abide terms.","code":""},{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 Eli Lilly Company, Boehringer-Ingelheim, Sage Therapeutics Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/articles/comparison.html","id":"about","dir":"Articles","previous_headings":"","what":"About","title":"Comparison of Bayesian and frequentist MMRM fits","text":"vignette provides example comparison Bayesian MMRM fit, obtained brms.mmrm::brm_model(), frequentist MMRM fit, obtained mmrm::mmrm(). overview parameter estimates differences type MMRM given summary (Table 4) end.","code":""},{"path":"/articles/comparison.html","id":"prerequisites","dir":"Articles","previous_headings":"","what":"Prerequisites","title":"Comparison of Bayesian and frequentist MMRM fits","text":"Load required packages: Set seed:","code":"> packages <- c( +   \"dplyr\", +   \"tidyr\", +   \"ggplot2\", +   \"gt\", +   \"gtsummary\", +   \"purrr\", +   \"parallel\", +   \"brms.mmrm\", +   \"mmrm\", +   \"emmeans\", +   \"posterior\" + ) > invisible(lapply(packages, library, character.only = TRUE)) > set.seed(123L)"},{"path":[]},{"path":"/articles/comparison.html","id":"pre-processing","dir":"Articles","previous_headings":"Data","what":"Pre-processing","title":"Comparison of Bayesian and frequentist MMRM fits","text":"fev_dat dataset used contained mmrm-package: artificial (simulated) dataset clinical trial investigating effect active treatment FEV1 (forced expired volume one second), compared placebo. FEV1 measure quickly lungs can emptied low levels may indicate chronic obstructive pulmonary disease (COPD). dataset tibble 800 rows 7 variables: USUBJID (subject ID), AVISIT (visit number), ARMCD (treatment, TRT PBO), RACE (3-category race), SEX (sex), FEV1_BL (FEV1 baseline, %), FEV1 (FEV1 study visits), WEIGHT (weighting variable). analysis, change baseline FEV1 used endpoint corresponding new variable (FEV1_CHG) created. Create preprocess dataset MMRM analysis: First rows dataset: Table 1. First rows dataset.","code":"> data(fev_data, package = \"mmrm\") > fev_data <- fev_data |> +   mutate(\"FEV1_CHG\" = FEV1 - FEV1_BL) > fev_data <- brm_data( +   data = fev_data, +   outcome = \"FEV1_CHG\", +   role = \"change\", +   group = \"ARMCD\", +   time = \"AVISIT\", +   patient = \"USUBJID\", +   baseline = \"FEV1_BL\", +   reference_group = \"PBO\", +   covariates = c(\"RACE\", \"SEX\") + ) |> +   mutate(ARMCD = factor(ARMCD), AVISIT = factor(AVISIT)) > head(fev_data) |> +   gt() |> +   tab_caption(caption = md(\"Table 1. First rows of dataset.\"))"},{"path":"/articles/comparison.html","id":"descriptive-statistics","dir":"Articles","previous_headings":"Data","what":"Descriptive statistics","title":"Comparison of Bayesian and frequentist MMRM fits","text":"Table baseline characteristics: Table 2. Baseline characteristics. Table change baseline FEV1 52 weeks: Table 3. Change baseline. Figure 1. Change baseline FEV1 4 visit time points.","code":"> fev_data |> +   select(ARMCD, USUBJID, SEX, RACE, FEV1_BL) |> +   distinct() |> +   select(-USUBJID) |> +   tbl_summary( +     by = c(ARMCD), +     statistic = list( +       all_continuous() ~ \"{mean} ({sd})\", +       all_categorical() ~ \"{n} / {N} ({p}%)\" +     ) +   ) |> +   modify_caption(\"Table 2. Baseline characteristics.\") > fev_data |> +   pull(AVISIT) |> +   unique() |> +   sort() |> +   purrr::map( +     .f = ~ fev_data |> +       filter(AVISIT %in% .x) |> +       tbl_summary( +         by = ARMCD, +         include = FEV1_CHG, +         type = FEV1_CHG ~ \"continuous2\", +         statistic = FEV1_CHG ~ c(\"{mean} ({sd})\", +                                  \"{median} ({p25}, {p75})\", +                                  \"{min}, {max}\"), +         label = list(FEV1_CHG = paste(\"Visit \", .x)) +       ) +   ) |> +   tbl_stack(quiet = TRUE) |> +   modify_caption(\"Table 3. Change from baseline.\") > fev_data |> +   group_by(ARMCD) |> +   ggplot(aes(x = AVISIT, y = FEV1_CHG, fill = factor(ARMCD))) + +   geom_hline(yintercept = 0, col = \"grey\", size = 1.2) + +   geom_boxplot(na.rm = TRUE) + +   labs(x = \"Visit\", +        y = \"Change from baseline in FEV1\", +        fill = \"Treatment\") + +   scale_fill_manual(values = c(\"darkgoldenrod2\", \"coral2\")) + +   theme_bw()"},{"path":[]},{"path":"/articles/comparison.html","id":"bayesian-model","dir":"Articles","previous_headings":"Fitting MMRMs","what":"Bayesian model","title":"Comparison of Bayesian and frequentist MMRM fits","text":"Model formula: Fit model (using multiple cores, available, avoid long runtime): Summary results:","code":"> b_mmrm_formula <- brm_formula( +   data = fev_data, +   intercept = TRUE, +   baseline = TRUE, +   group = FALSE, +   time = TRUE, +   baseline_time = FALSE, +   group_time = TRUE, +   correlation = \"unstructured\" + ) > print(b_mmrm_formula) FEV1_CHG ~ FEV1_BL + ARMCD:AVISIT + AVISIT + RACE + SEX + unstr(time = AVISIT, gr = USUBJID)  sigma ~ 0 + AVISIT > n_cores <- ifelse( +   test = detectCores() > 1, +   yes = min(2, detectCores()), +   no = 1 + ) > b_mmrm_fit <- brm_model( +   data = filter(fev_data, !is.na(FEV1_CHG)), +   formula = b_mmrm_formula, +   iter = 1500, +   chains = max(1, n_cores), +   cores = n_cores, +   refresh = 0 + ) > summary(b_mmrm_fit)  Family: gaussian    Links: mu = identity; sigma = log  Formula: FEV1_CHG ~ FEV1_BL + ARMCD:AVISIT + AVISIT + RACE + SEX + unstr(time = AVISIT, gr = USUBJID)           sigma ~ 0 + AVISIT    Data: data[!is.na(data[[attr(data, \"brm_outcome\")]]), ] (Number of observations: 537)    Draws: 2 chains, each with iter = 1500; warmup = 750; thin = 1;          total post-warmup draws = 1500  Correlation Structures:                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS cortime(VIS1,VIS2)     0.36      0.08     0.19     0.52 1.00     2550     1229 cortime(VIS1,VIS3)     0.14      0.10    -0.06     0.31 1.00     3032     1305 cortime(VIS2,VIS3)     0.04      0.10    -0.16     0.23 1.00     1928     1012 cortime(VIS1,VIS4)     0.17      0.11    -0.06     0.39 1.00     2638     1262 cortime(VIS2,VIS4)     0.11      0.09    -0.06     0.28 1.00     2404     1204 cortime(VIS3,VIS4)     0.01      0.10    -0.17     0.21 1.01     2579      855  Population-Level Effects:                             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS Intercept                     24.36      1.49    21.47    27.06 1.00     2163     1045 FEV1_BL                       -0.84      0.03    -0.90    -0.78 1.00     2979     1213 AVISITVIS2                     4.80      0.86     3.13     6.49 1.00     1604     1119 AVISITVIS3                    10.37      0.88     8.61    12.12 1.00     1338      877 AVISITVIS4                    15.16      1.30    12.62    17.79 1.00     1755     1273 RACEBlackorAfricanAmerican     1.40      0.58     0.29     2.54 1.00     1983     1032 RACEWhite                      5.44      0.61     4.31     6.64 1.00     2341     1238 SEXFemale                      0.35      0.51    -0.63     1.36 1.00     2932      965 AVISITVIS1:ARMCDTRT            3.98      1.10     1.78     6.10 1.00     1586      960 AVISITVIS2:ARMCDTRT            3.93      0.86     2.22     5.53 1.00     2091      838 AVISITVIS3:ARMCDTRT            2.98      0.67     1.66     4.33 1.00     3024     1304 AVISITVIS4:ARMCDTRT            4.46      1.66     1.22     7.72 1.01     2110     1307 sigma_AVISITVIS1               1.83      0.06     1.72     1.96 1.00     2312     1088 sigma_AVISITVIS2               1.59      0.06     1.48     1.71 1.00     2553     1228 sigma_AVISITVIS3               1.33      0.06     1.20     1.45 1.00     2458     1188 sigma_AVISITVIS4               2.28      0.06     2.17     2.40 1.00     2565     1006  Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS and Tail_ESS are effective sample size measures, and Rhat is the potential scale reduction factor on split chains (at convergence, Rhat = 1)."},{"path":"/articles/comparison.html","id":"frequentist-model","dir":"Articles","previous_headings":"Fitting MMRMs","what":"Frequentist model","title":"Comparison of Bayesian and frequentist MMRM fits","text":"Fit model: Summary results:","code":"> f_mmrm_fit <- mmrm::mmrm( +   formula = FEV1_CHG ~ FEV1_BL + AVISIT + ARMCD:AVISIT + RACE + SEX + +     us(AVISIT | USUBJID), +   data = fev_data + ) > summary(f_mmrm_fit) mmrm fit  Formula:     FEV1_CHG ~ FEV1_BL + AVISIT + ARMCD:AVISIT + RACE + SEX + us(AVISIT |      USUBJID) Data:        fev_data (used 537 observations from 197 subjects with maximum 4 timepoints) Covariance:  unstructured (10 variance parameters) Method:      Satterthwaite Vcov Method: Asymptotic Inference:   REML  Model selection criteria:      AIC      BIC   logLik deviance    3381.4   3414.2  -1680.7   3361.4   Coefficients:                                 Estimate Std. Error        df t value Pr(>|t|)     (Intercept)                    24.35372    1.40754 257.97000  17.302  < 2e-16 *** FEV1_BL                        -0.84022    0.02777 190.27000 -30.251  < 2e-16 *** AVISITVIS2                      4.79036    0.79848 144.82000   5.999 1.51e-08 *** AVISITVIS3                     10.36601    0.81318 157.08000  12.748  < 2e-16 *** AVISITVIS4                     15.19231    1.30857 139.25000  11.610  < 2e-16 *** RACEBlack or African American   1.41921    0.57874 169.56000   2.452 0.015211 *   RACEWhite                       5.45679    0.61626 157.54000   8.855 1.65e-15 *** SEXFemale                       0.33812    0.49273 166.43000   0.686 0.493529     AVISITVIS1:ARMCDTRT             3.98329    1.04540 142.32000   3.810 0.000206 *** AVISITVIS2:ARMCDTRT             3.93076    0.81351 142.26000   4.832 3.46e-06 *** AVISITVIS3:ARMCDTRT             2.98372    0.66567 129.61000   4.482 1.61e-05 *** AVISITVIS4:ARMCDTRT             4.40400    1.66049 132.88000   2.652 0.008970 **  --- Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  Covariance estimate:         VIS1    VIS2    VIS3    VIS4 VIS1 37.8301 11.3255  3.4796 10.6844 VIS2 11.3255 23.5476  0.7760  5.5103 VIS3  3.4796  0.7760 13.8037  0.5683 VIS4 10.6844  5.5103  0.5683 92.9625"},{"path":[]},{"path":"/articles/comparison.html","id":"extract-estimates-from-bayesian-model","dir":"Articles","previous_headings":"Comparison","what":"Extract estimates from Bayesian model","title":"Comparison of Bayesian and frequentist MMRM fits","text":"","code":"> b_mmrm_draws <- b_mmrm_fit |> as_draws_df() > visit_levels <- sort(unique(as.character(fev_data$AVISIT))) > for (level in visit_levels) { +   name <- paste0(\"b_sigma_AVISIT\", level) +   b_mmrm_draws[[name]] <- exp(b_mmrm_draws[[name]]) + } > b_mmrm_summary <- b_mmrm_draws |> +   summarize_draws() |> +   select(variable, mean, sd) |> +   filter(!(variable %in% c(\"lprior\", \"lp__\"))) |> +   rename(bayes_estimate = mean, bayes_se = sd) |> +   mutate( +     variable = variable |> +       tolower() |> +       gsub(pattern = \"b_\", replacement = \"\") |> +       gsub(pattern = \"b_sigma_AVISIT\", replacement = \"sigma_\") |> +       gsub(pattern = \"cortime\", replacement = \"correlation\") |> +       gsub(pattern = \"__\", replacement = \"_\") +   )"},{"path":"/articles/comparison.html","id":"extract-estimates-from-frequentist-model","dir":"Articles","previous_headings":"Comparison","what":"Extract estimates from frequentist model","title":"Comparison of Bayesian and frequentist MMRM fits","text":"","code":"> f_mmrm_fixed <- summary(f_mmrm_fit)$coefficients |> +   as_tibble(rownames = \"variable\") |> +   mutate(variable = tolower(variable)) |> +   mutate(variable = gsub(\"(\", \"\", variable, fixed = TRUE)) |> +   mutate(variable = gsub(\")\", \"\", variable, fixed = TRUE)) |> +   rename(freq_estimate = Estimate, freq_se = `Std. Error`) |> +   select(variable, freq_estimate, freq_se) > f_mmrm_variance <- tibble( +   variable = paste0(\"sigma_AVISIT\", visit_levels) |> tolower(), +   freq_estimate = sqrt(diag(f_mmrm_fit$cov)) + ) > f_diagonal_factor <- diag(1 / sqrt(diag(f_mmrm_fit$cov))) > f_corr_matrix <- f_diagonal_factor %*% f_mmrm_fit$cov %*% f_diagonal_factor > colnames(f_corr_matrix) <- visit_levels > f_mmrm_correlation <- f_corr_matrix |> +   as.data.frame() |> +   as_tibble() |> +   mutate(x1 = visit_levels) |> +   pivot_longer(cols = -any_of(\"x1\"), +                names_to = \"x2\", +                values_to = \"freq_estimate\") |> +   filter(as.numeric(gsub(\"[^0-9]\", \"\", x1)) < +            as.numeric(gsub(\"[^0-9]\", \"\", x2))) |> +   mutate(variable = sprintf(\"correlation_%s_%s\", x1, x2)) |> +   select(variable, freq_estimate) > f_mmrm_summary <- bind_rows(f_mmrm_fixed, +                             f_mmrm_variance, +                             f_mmrm_correlation) |> +   mutate(variable = gsub(\"\\\\s+\", \"\", variable) |> tolower())"},{"path":"/articles/comparison.html","id":"Summary","dir":"Articles","previous_headings":"Comparison","what":"Summary","title":"Comparison of Bayesian and frequentist MMRM fits","text":"Table 4. Contrasting Bayesian frequentist MMRM fits.","code":"> b_f_comparison <- full_join(x = b_mmrm_summary, +                             y = f_mmrm_summary, +                             by = \"variable\") |> +   mutate(diff_estimate = bayes_estimate - freq_estimate, +          diff_se = bayes_se - freq_se) |> +   select(variable, ends_with(\"estimate\"), ends_with(\"se\")) > gt(b_f_comparison) |> +   fmt_number(decimals = 4) |> +   tab_caption( +     caption = md(\"Table 4. Contrasting Bayesian and frequentist MMRM fits.\") +   ) |> +   tab_spanner(label = \"Estimate\", columns = ends_with(\"estimate\")) |> +   tab_spanner(label = \"Standard error\", columns = ends_with(\"se\")) |> +   cols_label( +     variable = \"Variable\", +     bayes_estimate = \"Bayesian\", +     freq_estimate = \"Frequentist\", +     diff_estimate = \"Difference\", +     bayes_se = \"Bayesian\", +     freq_se = \"Frequentist\", +     diff_se = \"Difference\", +   )"},{"path":"/articles/methods.html","id":"model","dir":"Articles","previous_headings":"","what":"Model","title":"Methods","text":"MMRM brms.mmrm mathematically expressed follows. Subsequent sections define notation, data, parameters, priors. \\[ \\begin{aligned} &y_i \\stackrel{\\text{ind}}{\\sim} \\text{Multivariate-Normal} \\left (\\text{mean} = X_{} \\beta, \\ \\text{covariance} = \\text{diag}(\\sigma) \\cdot \\Lambda \\cdot \\text{diag}(\\sigma) \\right ) \\\\ &\\qquad \\beta_p \\stackrel{\\text{ind}}{\\sim} q_p() \\\\ &\\qquad \\Lambda \\sim r() \\\\ &\\qquad \\tau = \\log(\\sigma) \\\\ &\\qquad \\qquad \\tau_t \\stackrel{\\text{ind}}{\\sim} s_t() \\end{aligned} \\]","code":""},{"path":"/articles/methods.html","id":"notation","dir":"Articles","previous_headings":"","what":"Notation","title":"Methods","text":"\\(\\): positive integer index subject patient study. \\(t\\): positive integer index discrete time point study. \\(p\\): positive integer index model coefficient parameter \\(\\beta_p\\). \\(\\theta_j \\stackrel{\\text{ind}}{\\sim} f()\\): assuming \\(j\\) positive integer index ranges 1 positive integer \\(J\\), notation declares parameters \\(\\theta_1, \\ldots, \\theta_J\\) independent follow prior distribution common probability density function \\(f()\\). \\(\\theta_j \\stackrel{\\text{ind}}{\\sim} f_j()\\): , except \\(\\theta_j\\) parameter follows separate prior distribution probability density function \\(p_j()\\). \\(p_i()\\) \\(f_j()\\) may differ \\(\\ne j\\). \\(\\text{diag}(\\theta)\\): diagonal matrix scalar elements vector \\(\\theta\\) diagonal -diagonal elements equal 0. number rows number columns matrix equal number elements vector \\(\\theta\\).","code":""},{"path":"/articles/methods.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Methods","text":"\\(y_i\\): numeric vector outcome observations subject \\(\\). number elements vector equals number discrete time points study, purposes model specification, sorted chronologically first element \\(y_i\\) observed first study. One elements \\(y_i\\) may missing due dropout, discontinuation, etc. likelihood model assumes \\(y_i\\) independent \\(y_j\\) \\(\\ne j\\). \\(X_i\\): matrix containing rows model matrix correspond subject \\(\\). rows \\(X_i\\) correspond elements vector \\(y_i\\) (equivalently, discrete time points study), columns \\(X_i\\) correspond model coefficient parameters \\(\\beta_p\\). composition \\(X_i\\) determined covariates input dataset choice model formula supplied user (via brm_formula()).","code":""},{"path":"/articles/methods.html","id":"parameters","dir":"Articles","previous_headings":"","what":"Parameters","title":"Methods","text":"\\(\\beta\\): vector model coefficients. \\(\\beta_p\\) scalar element \\(p\\) \\(\\beta\\). \\(\\Lambda\\): matrix pairwise correlations among pair time points within subjects. Outcomes measured different subjects assumed independent, outcomes observed different time points subject assumed correlated according matrix. \\(\\Lambda\\) positive-definite symmetric, number rows columns equal number discrete time points study. \\(\\sigma\\): vector time-point-specific standard deviations residuals linear scale. \\(\\sigma_t\\) scalar element \\(t\\) \\(\\sigma\\). \\(\\tau\\): \\(\\sigma\\), natural logarithmic scale. scalar element \\(\\tau_t\\) \\(\\tau\\) defined natural logarithm \\(\\sigma_t\\).","code":""},{"path":"/articles/methods.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"Methods","text":"priors parameters depend prior argument brm_model() related functions. priors specified user, brms package sets defaults. can view default priors using get_prior() function brms. See brms information brms sets default priors. \\(q_p()\\): univariate prior model coefficient \\(\\beta_p\\). \\(r()\\): matrix prior within-subject residual correlation matrix parameter \\(\\Lambda\\). \\(s_t()\\): univariate prior natural-log-standard-deviation parameter \\(\\tau_t\\) discrete time point \\(t\\).","code":""},{"path":"/articles/methods.html","id":"sampling","dir":"Articles","previous_headings":"","what":"Sampling","title":"Methods","text":"brms.mmrm, brms, fits model data using Markov chain Monte Carlo (MCMC) capabilities Stan (Stan Development Team 2023). Please read https://mc-stan.org/users/documentation/ details methodology Stan. result MCMC collection draws full joint posterior distribution parameters given data. Individual draws scalar parameters \\(\\beta_3\\) considered draws marginal posterior distribution e.g. \\(\\beta_3\\) given data.","code":""},{"path":"/articles/methods.html","id":"inference","dir":"Articles","previous_headings":"","what":"Inference","title":"Methods","text":"Inference brms.mmrm, uses estimated marginal posterior distribution mean response combination study arm time point. emmeans package (Lenth 2016) derives marginal posteriors averaging covariates nuisance parameters. averaging process, levels categorical nuisance parameters weighted proportionally frequencies dataset (wt.nuis = \"proportional\" emmeans::ref_grid()). brm_marginal_draws() function, described usage vignette, derives posterior draws marginals using posterior draws model coefficients \\(\\beta_p\\). , downstream functions like brm_marginal_probabilities() compute numerical summaries marginal draws.","code":""},{"path":"/articles/methods.html","id":"subgroup-analysis","dir":"Articles","previous_headings":"","what":"Subgroup analysis","title":"Methods","text":"model supports subgroup analysis addition categorical variable data denote subgroup levels. analyze subgroup, new fixed effects parameters \\(\\beta_p\\) columns model matrices \\(X_i\\) added model describe additive effect subgroup plausible two-way three-way interactions treatment group, discrete time, baseline (applicable). Marginal means may include subgroup-specific terms, model comparison via widely applicable information criterion (WAIC) expected log predictive density (ELPD) implemented via R packages loo brms (Gabry et al. (2019), Gelman Hill (2007), Vehtari et al. (2017), Vehtari et al. (2019)).","code":""},{"path":[]},{"path":"/articles/sbc.html","id":"about","dir":"Articles","previous_headings":"","what":"About","title":"Simulation-based calibration","text":"vignette shows results simulation-based calibration (SBC) study validate implementation models brms.mmrm. SBC tests ability Bayesian model recapture parameters used simulate prior predictive data. details SBC, please read Talts et al. (2020) SBC R package (Kim et al. 2022). particular SBC study uses targets pipeline sbc subdirectory brms.mmrm package source code.","code":""},{"path":"/articles/sbc.html","id":"simple-scenario","dir":"Articles","previous_headings":"","what":"Simple scenario","title":"Simulation-based calibration","text":"simple scenario, simulate datasets prior predictive distribution assuming 3 treatment groups, 4 time points, 100 patients per treatment group, adjustment covariates, missing responses. model formula : prior randomly generated used simulation analysis: following histograms show SBC rank statistics compare prior parameter draws draws posterior draws. data simulation code modeling code correct consistent, rank statistics uniformly distributed. Fixed effect parameter ranks: Log-scale standard deviation parameter ranks:  Correlation parameter ranks:","code":"#> response ~ 0 + group + time + unstr(time = time, gr = patient)  #> sigma ~ 0 + time fst::read_fst(\"sbc/prior_simple.fst\") #>                        prior    class         coef  dpar #> 1  lkj_corr_cholesky(1.1759) Lcortime                    #> 2     normal(-0.108, 1.9497)        b groupgroup_1       #> 3     normal(0.0441, 1.3727)        b groupgroup_2       #> 4    normal(-0.2303, 0.2806)        b groupgroup_3       #> 5     normal(0.0631, 1.6016)        b   timetime_2       #> 6       normal(0.16, 1.4724)        b   timetime_3       #> 7     normal(0.0631, 1.7156)        b   timetime_4       #> 8     normal(0.0389, 2.2844)        b   timetime_1 sigma #> 9      normal(0.1793, 1.808)        b   timetime_2 sigma #> 10    normal(0.1637, 1.4719)        b   timetime_3 sigma #> 11    normal(0.0186, 0.7794)        b   timetime_4 sigma library(dplyr) library(ggplot2) library(tibble) library(tidyr)  read_ranks <- function(path) {   fst::read_fst(path) %>%     tibble::as_tibble() %>%     pivot_longer(       cols = everything(),       names_to = \"parameter\",       values_to = \"rank\"     ) }  plot_ranks <- function(ranks) {   ggplot(ranks) +     geom_histogram(       aes(x = rank),       breaks = seq(from = 0, to = max(ranks$rank), length.out = 10)     ) +     facet_wrap(~parameter) } simple_ranks <- read_ranks(\"sbc/simple.fst\") simple_ranks %>%   filter(grepl(\"^b_\", parameter)) %>%   filter(!grepl(\"^b_sigma\", parameter)) %>%   plot_ranks() simple_ranks %>%   filter(grepl(\"b_sigma\", parameter)) %>%   plot_ranks() simple_ranks %>%   filter(grepl(\"cortime_\", parameter)) %>%   plot_ranks()"},{"path":"/articles/sbc.html","id":"complex-scenario","dir":"Articles","previous_headings":"","what":"Complex scenario","title":"Simulation-based calibration","text":"complex scenario, simulate datasets prior predictive distribution assuming 2 treatment groups, 2 subgroup levels, 3 time points, 150 patients per treatment group, adjustment two continuous two categorical baseline covariates, 30% dropout, 8% rate independent/sporadic missing values. model formula : prior randomly generated used simulation analysis: following histograms show SBC rank statistics compare prior parameter draws draws posterior draws. data simulation code modeling code correct consistent, rank statistics uniformly distributed. Fixed effect parameter ranks: Log-scale standard deviation parameter ranks:  Correlation parameter ranks:","code":"#> response ~ group + group:subgroup + group:subgroup:time + group:time + subgroup + subgroup:time + time + continuous1 + continuous2 + balanced + unbalanced + unstr(time = time, gr = patient)  #> sigma ~ 0 + time fst::read_fst(\"sbc/prior_complex.fst\") #>                        prior     class #> 1  lkj_corr_cholesky(1.4621)  Lcortime #> 2    normal(-0.1661, 2.3091) Intercept #> 3    normal(-0.1831, 1.8732)         b #> 4     normal(0.1578, 2.8225)         b #> 5    normal(-0.1069, 1.7987)         b #> 6    normal(-0.1071, 0.5407)         b #> 7     normal(-0.1028, 0.464)         b #> 8     normal(-0.007, 0.7129)         b #> 9     normal(0.1007, 1.8179)         b #> 10   normal(-0.1965, 2.9243)         b #> 11   normal(-0.0911, 1.5937)         b #> 12    normal(0.0536, 0.7669)         b #> 13    normal(0.0973, 0.5859)         b #> 14    normal(0.0741, 2.3458)         b #> 15     normal(-0.17, 2.9882)         b #> 16    normal(0.1211, 0.7527)         b #> 17    normal(-0.234, 2.0401)         b #> 18   normal(-0.0457, 2.2697)         b #> 19    normal(-0.181, 2.8068)         b #> 20    normal(0.1093, 2.3647)         b #> 21    normal(-0.0878, 1.165)         b #> 22   normal(-0.2374, 1.5208)         b #>                                          coef  dpar #> 1                                                   #> 2                                                   #> 3                              balancedlevel2       #> 4                              balancedlevel3       #> 5                                 continuous1       #> 6                                 continuous2       #> 7                                groupgroup_2       #> 8             groupgroup_2:subgroupsubgroup_2       #> 9  groupgroup_2:subgroupsubgroup_2:timetime_2       #> 10 groupgroup_2:subgroupsubgroup_2:timetime_3       #> 11                    groupgroup_2:timetime_2       #> 12                    groupgroup_2:timetime_3       #> 13                         subgroupsubgroup_2       #> 14              subgroupsubgroup_2:timetime_2       #> 15              subgroupsubgroup_2:timetime_3       #> 16                                 timetime_2       #> 17                                 timetime_3       #> 18                           unbalancedlevel2       #> 19                           unbalancedlevel3       #> 20                                 timetime_1 sigma #> 21                                 timetime_2 sigma #> 22                                 timetime_3 sigma complex_ranks <- read_ranks(\"sbc/complex.fst\") complex_ranks %>%   filter(grepl(\"^b_\", parameter)) %>%   filter(!grepl(\"^b_sigma\", parameter)) %>%   plot_ranks() complex_ranks %>%   filter(grepl(\"b_sigma\", parameter)) %>%   plot_ranks() complex_ranks %>%   filter(grepl(\"cortime_\", parameter)) %>%   plot_ranks()"},{"path":"/articles/sbc.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Simulation-based calibration","text":"SBC rank statistics look uniformly distributed. words, posterior distribution brms/Stan MMRM modeling code matches prior datasets simulated. evidence subgroup non-subgroup models brms.mmrm implemented correctly.","code":""},{"path":[]},{"path":"/articles/simulation.html","id":"simple","dir":"Articles","previous_headings":"","what":"Simple","title":"Simulation","text":"brm_simulate_simple() simulates dataset prior predictive distribution simple special case MMRM.1 data element classed tibble can directly supply brm_formula() brm_model(). parameters element corresponding parameter values simulated joint prior. Arguments brm_simulate_simple() control hyperparameters. model_matrix element regression model matrix fixed effect parameters.","code":"library(brms.mmrm) set.seed(0) sim <- brm_simulate_simple(   n_group = 3,   n_patient = 100,   n_time = 4 ) sim$data #> # A tibble: 1,200 × 4 #>    response group   time   patient     #>       <dbl> <chr>   <chr>  <chr>       #>  1    1.11  group_1 time_1 patient_001 #>  2    2.15  group_1 time_2 patient_001 #>  3    2.54  group_1 time_3 patient_001 #>  4   -1.73  group_1 time_4 patient_001 #>  5    1.11  group_1 time_1 patient_002 #>  6    2.64  group_1 time_2 patient_002 #>  7    1.69  group_1 time_3 patient_002 #>  8    0.783 group_1 time_4 patient_002 #>  9    0.118 group_1 time_1 patient_003 #> 10    2.48  group_1 time_2 patient_003 #> # ℹ 1,190 more rows str(sim$parameters) #> List of 5 #>  $ beta      : num [1:6] 1.263 -0.326 1.33 1.272 0.415 ... #>  $ tau       : num [1:4] -0.092857 -0.029472 -0.000577 0.240465 #>  $ sigma     : num [1:4] 0.911 0.971 0.999 1.272 #>  $ lambda    : num [1:4, 1:4] 1 0.415 -0.818 -0.282 0.415 ... #>  $ covariance: num [1:4, 1:4] 0.831 0.368 -0.745 -0.326 0.368 ... head(sim$model_matrix) #>   groupgroup_1 groupgroup_2 groupgroup_3 timetime_2 timetime_3 timetime_4 #> 1            1            0            0          0          0          0 #> 2            1            0            0          1          0          0 #> 3            1            0            0          0          1          0 #> 4            1            0            0          0          0          1 #> 5            1            0            0          0          0          0 #> 6            1            0            0          1          0          0"},{"path":"/articles/simulation.html","id":"change-from-baseline","dir":"Articles","previous_headings":"","what":"Change from baseline","title":"Simulation","text":"brm_data_change() can convert outcome variable raw response change baseline. applies real datasets passed [brm_data()] well simulated ones e.g. [brm_simulate_simple()]. dataset uses raw response baseline time point \"time_1\" brm_data_change() subtracts baseline, replaces raw response column new change baseline column, adds new column original baseline raw response, adjusts internal attributes classed object accordingly.","code":"sim$data #> # A tibble: 1,200 × 4 #>    response group   time   patient     #>       <dbl> <chr>   <chr>  <chr>       #>  1    1.11  group_1 time_1 patient_001 #>  2    2.15  group_1 time_2 patient_001 #>  3    2.54  group_1 time_3 patient_001 #>  4   -1.73  group_1 time_4 patient_001 #>  5    1.11  group_1 time_1 patient_002 #>  6    2.64  group_1 time_2 patient_002 #>  7    1.69  group_1 time_3 patient_002 #>  8    0.783 group_1 time_4 patient_002 #>  9    0.118 group_1 time_1 patient_003 #> 10    2.48  group_1 time_2 patient_003 #> # ℹ 1,190 more rows brm_data_change(   data = sim$data,   name_change = \"new_change\",   name_baseline = \"new_baseline\" ) #> # A tibble: 900 × 5 #>    new_change new_baseline group   time   patient     #>         <dbl>        <dbl> <chr>   <chr>  <chr>       #>  1      1.04         1.11  group_1 time_2 patient_001 #>  2      1.43         1.11  group_1 time_3 patient_001 #>  3     -2.84         1.11  group_1 time_4 patient_001 #>  4      1.53         1.11  group_1 time_2 patient_002 #>  5      0.576        1.11  group_1 time_3 patient_002 #>  6     -0.328        1.11  group_1 time_4 patient_002 #>  7      2.37         0.118 group_1 time_2 patient_003 #>  8      3.07         0.118 group_1 time_3 patient_003 #>  9     -1.14         0.118 group_1 time_4 patient_003 #> 10      1.57         1.29  group_1 time_2 patient_004 #> # ℹ 890 more rows"},{"path":"/articles/simulation.html","id":"advanced","dir":"Articles","previous_headings":"","what":"Advanced","title":"Simulation","text":"nuanced simulation, build dataset layer layer. Begin brm_simulate_outline() create initial structure random missingness pattern. brm_simulate_outline(), missing responses can come either transitory intercurrent events dropouts. missing column indicates outcome values missing (NA_real_) later step. response column entirely missing now simulated later. Optionally add random continuous covariates brm_simulate_continuous() random categorical covariates using brm_simulate_categorical(). case, covariates non-time-varying, means patient gets one unique value. described next section, brms.mmrm convenient function brm_simulate_prior() simulate outcome variable response using data skeleton prior predictive distribution. However, prefer full custom approach, may need granular details parameterization, requires model matrix. Fortunately, brms supports make_standata() function provide , given dataset formula. may need temporarily set response variable something non-missing, may wish specify custom prior.","code":"data <- brm_simulate_outline(   n_group = 2,   n_patient = 100,   n_time = 4,   rate_dropout = 0.3 )  data #> # A tibble: 800 × 5 #>    response missing group   time   patient     #>       <dbl> <lgl>   <chr>   <chr>  <chr>       #>  1       NA FALSE   group_1 time_1 patient_001 #>  2       NA TRUE    group_1 time_2 patient_001 #>  3       NA TRUE    group_1 time_3 patient_001 #>  4       NA TRUE    group_1 time_4 patient_001 #>  5       NA FALSE   group_1 time_1 patient_002 #>  6       NA FALSE   group_1 time_2 patient_002 #>  7       NA TRUE    group_1 time_3 patient_002 #>  8       NA TRUE    group_1 time_4 patient_002 #>  9       NA FALSE   group_1 time_1 patient_003 #> 10       NA FALSE   group_1 time_2 patient_003 #> # ℹ 790 more rows data <- data %>%   brm_simulate_continuous(names = c(\"biomarker1\", \"biomarker2\")) %>%   brm_simulate_categorical(     names = c(\"status1\", \"status2\"),     levels = c(\"present\", \"absent\")   )  data #> # A tibble: 800 × 9 #>    response missing group   time   patient     biomarker1 biomarker2 status1 status2 #>       <dbl> <lgl>   <chr>   <chr>  <chr>            <dbl>      <dbl> <chr>   <chr>   #>  1       NA FALSE   group_1 time_1 patient_001      0.328     -0.655 present absent  #>  2       NA TRUE    group_1 time_2 patient_001      0.328     -0.655 present absent  #>  3       NA TRUE    group_1 time_3 patient_001      0.328     -0.655 present absent  #>  4       NA TRUE    group_1 time_4 patient_001      0.328     -0.655 present absent  #>  5       NA FALSE   group_1 time_1 patient_002      1.04      -0.779 absent  absent  #>  6       NA FALSE   group_1 time_2 patient_002      1.04      -0.779 absent  absent  #>  7       NA TRUE    group_1 time_3 patient_002      1.04      -0.779 absent  absent  #>  8       NA TRUE    group_1 time_4 patient_002      1.04      -0.779 absent  absent  #>  9       NA FALSE   group_1 time_1 patient_003      0.717     -0.954 present absent  #> 10       NA FALSE   group_1 time_2 patient_003      0.717     -0.954 present absent  #> # ℹ 790 more rows library(brms) formula <- brm_formula(data = data) formula #> response ~ group + group:time + time + biomarker1 + biomarker2 + status1 + status2 + unstr(time = time, gr = patient)  #> sigma ~ 0 + time  stan_data <- make_standata(   formula = formula,   data = mutate(data, response = 0) ) model_matrix <- stan_data$X head(model_matrix) #>   Intercept groupgroup_2 timetime_2 timetime_3 timetime_4 biomarker1 biomarker2 status1present #> 1         1            0          0          0          0  0.3283275 -0.6547971              1 #> 2         1            0          1          0          0  0.3283275 -0.6547971              1 #> 3         1            0          0          1          0  0.3283275 -0.6547971              1 #> 4         1            0          0          0          1  0.3283275 -0.6547971              1 #> 5         1            0          0          0          0  1.0385746 -0.7793828              0 #> 6         1            0          1          0          0  1.0385746 -0.7793828              0 #>   status2present groupgroup_2:timetime_2 groupgroup_2:timetime_3 groupgroup_2:timetime_4 #> 1              0                       0                       0                       0 #> 2              0                       0                       0                       0 #> 3              0                       0                       0                       0 #> 4              0                       0                       0                       0 #> 5              0                       0                       0                       0 #> 6              0                       0                       0                       0"},{"path":"/articles/simulation.html","id":"prior","dir":"Articles","previous_headings":"","what":"Prior","title":"Simulation","text":"Function brm_simulate_prior() simulates prior predictive distribution. requires dataset formula, accepts custom prior constructed brms::set_prior(). output object sim multiple draws prior predictive distribution. sim$outcome outcome draws, sim$parameters parameter draws. sim$model_matrix model matrix, sim$model full brms model fit object. can pass sim$model functions brms bayesplot pp_check(). addition, sim$data copy original dataset, outcome variable taken final draw prior predictive distribution. addition, missingness pattern automatically applied sim$data$response NA_real_ whenever sim$data$missing equals TRUE.","code":"formula <- brm_formula(data = data)  library(brms) prior <- set_prior(\"student_t(3, 0, 1.3)\", class = \"Intercept\") +   set_prior(\"student_t(3, 0, 1.2)\", class = \"b\") +   set_prior(\"student_t(3, 0, 1.1)\", class = \"b\", dpar = \"sigma\") +   set_prior(\"lkj(1)\", class = \"cortime\")  prior #>                 prior     class coef group resp  dpar nlpar   lb   ub source #>  student_t(3, 0, 1.3) Intercept                             <NA> <NA>   user #>  student_t(3, 0, 1.2)         b                             <NA> <NA>   user #>  student_t(3, 0, 1.1)         b                 sigma       <NA> <NA>   user #>                lkj(1)   cortime                             <NA> <NA>   user  sim <- brm_simulate_prior(   data = data,   formula = formula,   prior = prior,   refresh = 0 ) names(sim) #> [1] \"data\"         \"model\"        \"model_matrix\" \"outcome\"      \"parameters\" sim$data #> # A tibble: 800 × 9 #>    response missing group   time   patient     biomarker1 biomarker2 status1 status2 #>       <dbl> <lgl>   <chr>   <chr>  <chr>            <dbl>      <dbl> <chr>   <chr>   #>  1    3.90  FALSE   group_1 time_1 patient_001      0.328     -0.655 present absent  #>  2   NA     TRUE    group_1 time_2 patient_001      0.328     -0.655 present absent  #>  3   NA     TRUE    group_1 time_3 patient_001      0.328     -0.655 present absent  #>  4   NA     TRUE    group_1 time_4 patient_001      0.328     -0.655 present absent  #>  5    3.46  FALSE   group_1 time_1 patient_002      1.04      -0.779 absent  absent  #>  6    2.66  FALSE   group_1 time_2 patient_002      1.04      -0.779 absent  absent  #>  7   NA     TRUE    group_1 time_3 patient_002      1.04      -0.779 absent  absent  #>  8   NA     TRUE    group_1 time_4 patient_002      1.04      -0.779 absent  absent  #>  9    5.28  FALSE   group_1 time_1 patient_003      0.717     -0.954 present absent  #> 10    0.120 FALSE   group_1 time_2 patient_003      0.717     -0.954 present absent  #> # ℹ 790 more rows"},{"path":"/articles/simulation.html","id":"posterior","dir":"Articles","previous_headings":"","what":"Posterior","title":"Simulation","text":"brms supports posterior predictive simulations checks functions posteiror_predict(), posterior_epred(), pp_check(). can used brms model fit object either brm_model() brm_simulate_prior(). returned outcome_draws object numeric array posterior predictive draws, one row per draw one column per non-missing observation (row) original data.","code":"data <- sim$data formula <- brm_formula(data = data) model <- brm_model(data = data, formula = formula, refresh = 0) outcome_draws <- posterior_predict(object = model) str(outcome_draws) #>  num [1:4000, 1:659] 4.69 3.71 3.88 3.07 3.33 ...  dim(data) #> [1] 800   9  sum(!is.na(data$response)) #> [1] 659"},{"path":"/articles/subgroup.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Subgroup analysis","text":"subgroup analysis, dataset must single categorical variable denote subgroup levels. subgroup level adequate representation among treatment groups discrete time points. Otherwise, marginal means interest may estimable. create special classed dataset brms.mmrm using brm_data(), please supply name subgroup variable reference subgroup level. Post-processing functions use reference subgroup level compare pairs subgroups: example, treatment effect subgroup_2 minus treatment effect reference subgroup level choose.","code":"library(brms.mmrm) library(dplyr) library(magrittr) set.seed(0L) raw_data <- brm_simulate_outline(   n_group = 3,   n_subgroup = 2,   n_patient = 50,   n_time = 3,   rate_dropout = 0,   rate_lapse = 0 ) %>%   mutate(response = rnorm(n = n()))    raw_data #> # A tibble: 900 × 6 #>    response missing group   subgroup   time   patient     #>       <dbl> <lgl>   <chr>   <chr>      <chr>  <chr>       #>  1  1.26    FALSE   group_1 subgroup_1 time_1 patient_001 #>  2 -0.326   FALSE   group_1 subgroup_1 time_2 patient_001 #>  3  1.33    FALSE   group_1 subgroup_1 time_3 patient_001 #>  4  1.27    FALSE   group_1 subgroup_1 time_1 patient_002 #>  5  0.415   FALSE   group_1 subgroup_1 time_2 patient_002 #>  6 -1.54    FALSE   group_1 subgroup_1 time_3 patient_002 #>  7 -0.929   FALSE   group_1 subgroup_1 time_1 patient_003 #>  8 -0.295   FALSE   group_1 subgroup_1 time_2 patient_003 #>  9 -0.00577 FALSE   group_1 subgroup_1 time_3 patient_003 #> 10  2.40    FALSE   group_1 subgroup_1 time_1 patient_004 #> # ℹ 890 more rows count(raw_data, group, subgroup, time) #> # A tibble: 18 × 4 #>    group   subgroup   time       n #>    <chr>   <chr>      <chr>  <int> #>  1 group_1 subgroup_1 time_1    50 #>  2 group_1 subgroup_1 time_2    50 #>  3 group_1 subgroup_1 time_3    50 #>  4 group_1 subgroup_2 time_1    50 #>  5 group_1 subgroup_2 time_2    50 #>  6 group_1 subgroup_2 time_3    50 #>  7 group_2 subgroup_1 time_1    50 #>  8 group_2 subgroup_1 time_2    50 #>  9 group_2 subgroup_1 time_3    50 #> 10 group_2 subgroup_2 time_1    50 #> 11 group_2 subgroup_2 time_2    50 #> 12 group_2 subgroup_2 time_3    50 #> 13 group_3 subgroup_1 time_1    50 #> 14 group_3 subgroup_1 time_2    50 #> 15 group_3 subgroup_1 time_3    50 #> 16 group_3 subgroup_2 time_1    50 #> 17 group_3 subgroup_2 time_2    50 #> 18 group_3 subgroup_2 time_3    50 data <- brm_data(   data = data,   outcome = \"response\",   role = \"response\",   baseline = NULL,   group = \"group\",   subgroup = \"subgroup\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_subgroup = \"subgroup_1\",   reference_time = \"time_1\" )  str(data) #> brm_data [900 × 5] (S3: brm_data/tbl_df/tbl/data.frame) #>  $ response: num [1:900] 1.263 -0.326 1.33 1.272 0.415 ... #>  $ group   : chr [1:900] \"group_1\" \"group_1\" \"group_1\" \"group_1\" ... #>  $ subgroup: chr [1:900] \"subgroup_1\" \"subgroup_1\" \"subgroup_1\" \"subgroup_1\" ... #>  $ time    : chr [1:900] \"time_1\" \"time_2\" \"time_3\" \"time_1\" ... #>  $ patient : chr [1:900] \"patient_001\" \"patient_001\" \"patient_001\" \"patient_002\" ... #>  - attr(*, \"brm_outcome\")= chr \"response\" #>  - attr(*, \"brm_role\")= chr \"response\" #>  - attr(*, \"brm_group\")= chr \"group\" #>  - attr(*, \"brm_subgroup\")= chr \"subgroup\" #>  - attr(*, \"brm_time\")= chr \"time\" #>  - attr(*, \"brm_patient\")= chr \"patient\" #>  - attr(*, \"brm_covariates\")= chr(0)  #>  - attr(*, \"brm_reference_group\")= chr \"group_1\" #>  - attr(*, \"brm_reference_subgroup\")= chr \"subgroup_1\" #>  - attr(*, \"brm_reference_time\")= chr \"time_1\" #>  - attr(*, \"brm_levels_group\")= chr [1:3] \"group_1\" \"group_2\" \"group_3\" #>  - attr(*, \"brm_levels_subgroup\")= chr [1:2] \"subgroup_1\" \"subgroup_2\" #>  - attr(*, \"brm_levels_time\")= chr [1:3] \"time_1\" \"time_2\" \"time_3\" #>  - attr(*, \"brm_labels_group\")= chr [1:3] \"group_1\" \"group_2\" \"group_3\" #>  - attr(*, \"brm_labels_subgroup\")= chr [1:2] \"subgroup_1\" \"subgroup_2\" #>  - attr(*, \"brm_labels_time\")= chr [1:3] \"time_1\" \"time_2\" \"time_3\""},{"path":"/articles/subgroup.html","id":"formula","dir":"Articles","previous_headings":"","what":"Formula","title":"Subgroup analysis","text":"subgroup analysis, formula terms include subgroup variable. plausible interactions optional via arguments brm_formula(). specific example, disable interactions except group-subgroup interaction. create analogous non-subgroup reduced model, disable terms involve subgroup. useful later measuring impact subgroup whole, without needing restrict specific level subgroup.1","code":"formula_subgroup <- brm_formula(   data = data,   group_subgroup_time = FALSE,   subgroup_time = FALSE )  formula_subgroup #> response ~ group + group:subgroup + group:time + subgroup + time + unstr(time = time, gr = patient)  #> sigma ~ 0 + time formula_reduced <- brm_formula(   data = data,   group_subgroup = FALSE,   group_subgroup_time = FALSE,   subgroup = FALSE,   subgroup_time = FALSE )  formula_reduced #> response ~ group + group:time + time + unstr(time = time, gr = patient)  #> sigma ~ 0 + time"},{"path":"/articles/subgroup.html","id":"models","dir":"Articles","previous_headings":"","what":"Models","title":"Subgroup analysis","text":"run full subgroup reduced non-subgroup models, use brm_model() usual. Remember supply appropriate formula case.","code":"model_subgroup <- brm_model(   data = data,   formula = formula_subgroup,   refresh = 0 )"},{"path":"/articles/subgroup.html","id":"marginals","dir":"Articles","previous_headings":"","what":"Marginals","title":"Subgroup analysis","text":"subgroup model, brm_marginal_draws() can summarize subgroup-specific non-subgroup-specific marginal means. latter useful direct comparison non-subgroup reduced model. draws_subgroup_specific, marginals time difference (change baseline) treatment difference , except now subgroup-specific. addition, new difference_subgroup table. posterior samples difference_subgroup measure differences subgroup level reference subgroup level respect treatment effects difference_group. brm_marginal_summaries() brm_marginal_probabilities() automatically aware subgroup-specific marginals brm_marginal_draws(). Notably, brm_marginal_summaries() summarizes subgroup differences difference_subgroup table brm_marginal_draws(). brm_marginal_probabilities() still focuses treatment effects, differences pairs subgroup levels. brm_marignal_data() can produce either subgroup-specific non-subgroup-specific summary statistics.","code":"draws_subgroup_specific <- brm_marginal_draws(   model = model_subgroup,   data = data,   use_subgroup = TRUE ) draws_subgroup_comparison <- brm_marginal_draws(   model = model_subgroup,   data = data,   use_subgroup = FALSE ) draws_reduced <- brm_marginal_draws(   model = model_reduced,   data = data,   use_subgroup = FALSE ) tibble::as_tibble(draws_subgroup_specific$difference_group) #> # A tibble: 4,000 × 11 #>    .chain .draw .iteration `group_2|subgroup_1|time_2` group_2|subgroup_1|t…¹ #>     <int> <int>      <int>                       <dbl>                  <dbl> #>  1      1     1          1                    0.0863                  -0.0633 #>  2      1     2          2                    0.414                   -0.0444 #>  3      1     3          3                    0.0405                  -0.319  #>  4      1     4          4                   -0.0491                  -0.300  #>  5      1     5          5                    0.266                   -0.216  #>  6      1     6          6                   -0.000641                -0.150  #>  7      1     7          7                   -0.00792                 -0.129  #>  8      1     8          8                   -0.107                   -0.223  #>  9      1     9          9                   -0.0226                  -0.271  #> 10      1    10         10                   -0.0354                  -0.455  #> # ℹ 3,990 more rows #> # ℹ abbreviated name: ¹​`group_2|subgroup_1|time_3` #> # ℹ 6 more variables: `group_2|subgroup_2|time_2` <dbl>, #> #   `group_2|subgroup_2|time_3` <dbl>, `group_3|subgroup_1|time_2` <dbl>, #> #   `group_3|subgroup_1|time_3` <dbl>, `group_3|subgroup_2|time_2` <dbl>, #> #   `group_3|subgroup_2|time_3` <dbl> tibble::as_tibble(draws_subgroup_specific$difference_subgroup) #> # A tibble: 4,000 × 7 #>    .chain .draw .iteration `group_2|subgroup_2|time_2` group_2|subgroup_2|t…¹ #>     <int> <int>      <int>                       <dbl>                  <dbl> #>  1      1     1          1                    0                      0        #>  2      1     2          2                    0                      0        #>  3      1     3          3                   -2.08e-17               5.55e-17 #>  4      1     4          4                    0                      0        #>  5      1     5          5                   -5.55e-17              -2.78e-17 #>  6      1     6          6                    0                      0        #>  7      1     7          7                    3.47e-17               2.78e-17 #>  8      1     8          8                   -2.78e-17              -5.55e-17 #>  9      1     9          9                    3.47e-18               0        #> 10      1    10         10                    1.39e-17               0        #> # ℹ 3,990 more rows #> # ℹ abbreviated name: ¹​`group_2|subgroup_2|time_3` #> # ℹ 2 more variables: `group_3|subgroup_2|time_2` <dbl>, #> #   `group_3|subgroup_2|time_3` <dbl> summaries_subgroup_specific <- brm_marginal_summaries(   draws_subgroup_specific,   level = 0.95 )  summaries_subgroup_comparison <- brm_marginal_summaries(   draws_subgroup_comparison,   level = 0.95 )  summaries_reduced <- brm_marginal_summaries(   draws_reduced,   level = 0.95 )  summaries_subgroup_specific #> # A tibble: 250 × 7 #>    marginal         statistic group   subgroup   time     value    mcse #>    <chr>            <chr>     <chr>   <chr>      <chr>    <dbl>   <dbl> #>  1 difference_group lower     group_2 subgroup_1 time_2 -0.294  0.0164  #>  2 difference_group lower     group_2 subgroup_1 time_3 -0.541  0.00698 #>  3 difference_group lower     group_2 subgroup_2 time_2 -0.294  0.0164  #>  4 difference_group lower     group_2 subgroup_2 time_3 -0.541  0.00698 #>  5 difference_group lower     group_3 subgroup_1 time_2 -0.142  0.0126  #>  6 difference_group lower     group_3 subgroup_1 time_3 -0.272  0.0118  #>  7 difference_group lower     group_3 subgroup_2 time_2 -0.142  0.0126  #>  8 difference_group lower     group_3 subgroup_2 time_3 -0.272  0.0118  #>  9 difference_group mean      group_2 subgroup_1 time_2  0.0935 0.00435 #> 10 difference_group mean      group_2 subgroup_1 time_3 -0.165  0.00429 #> # ℹ 240 more rows brm_marginal_probabilities(   draws = draws_subgroup_specific,   threshold = c(-0.1, 0.1),   direction = c(\"greater\", \"less\") ) #> # A tibble: 16 × 6 #>    direction threshold group   subgroup   time   value #>    <chr>         <dbl> <chr>   <chr>      <chr>  <dbl> #>  1 greater        -0.1 group_2 subgroup_1 time_2 0.832 #>  2 greater        -0.1 group_2 subgroup_1 time_3 0.366 #>  3 greater        -0.1 group_2 subgroup_2 time_2 0.832 #>  4 greater        -0.1 group_2 subgroup_2 time_3 0.366 #>  5 greater        -0.1 group_3 subgroup_1 time_2 0.964 #>  6 greater        -0.1 group_3 subgroup_1 time_3 0.863 #>  7 greater        -0.1 group_3 subgroup_2 time_2 0.964 #>  8 greater        -0.1 group_3 subgroup_2 time_3 0.863 #>  9 less            0.1 group_2 subgroup_1 time_2 0.520 #> 10 less            0.1 group_2 subgroup_1 time_3 0.915 #> 11 less            0.1 group_2 subgroup_2 time_2 0.520 #> 12 less            0.1 group_2 subgroup_2 time_3 0.915 #> 13 less            0.1 group_3 subgroup_1 time_2 0.203 #> 14 less            0.1 group_3 subgroup_1 time_3 0.498 #> 15 less            0.1 group_3 subgroup_2 time_2 0.203 #> 16 less            0.1 group_3 subgroup_2 time_3 0.498 summaries_data_subgroup <- brm_marginal_data(   data = data,   level = 0.95,   use_subgroup = TRUE )  summaries_data_subgroup #> # A tibble: 126 × 5 #>    statistic group   subgroup   time   value #>    <chr>     <chr>   <chr>      <chr>  <dbl> #>  1 lower     group_1 subgroup_1 time_1 0.170 #>  2 lower     group_1 subgroup_1 time_2 0.244 #>  3 lower     group_1 subgroup_1 time_3 0.169 #>  4 lower     group_1 subgroup_2 time_1 0.484 #>  5 lower     group_1 subgroup_2 time_2 0.364 #>  6 lower     group_1 subgroup_2 time_3 0.266 #>  7 lower     group_2 subgroup_1 time_1 0.421 #>  8 lower     group_2 subgroup_1 time_2 0.221 #>  9 lower     group_2 subgroup_1 time_3 0.208 #> 10 lower     group_2 subgroup_2 time_1 0.220 #> # ℹ 116 more rows summaries_data_reduced <- brm_marginal_data(   data = data,   level = 0.95,   use_subgroup = FALSE )  summaries_data_reduced #> # A tibble: 63 × 4 #>    statistic group   time     value #>    <chr>     <chr>   <chr>    <dbl> #>  1 lower     group_1 time_1  0.251  #>  2 lower     group_1 time_2  0.219  #>  3 lower     group_1 time_3  0.143  #>  4 lower     group_2 time_1  0.237  #>  5 lower     group_2 time_2  0.252  #>  6 lower     group_2 time_3 -0.0331 #>  7 lower     group_3 time_1  0.104  #>  8 lower     group_3 time_2  0.332  #>  9 lower     group_3 time_3  0.110  #> 10 mean      group_1 time_1  0.0632 #> # ℹ 53 more rows"},{"path":"/articles/subgroup.html","id":"model-comparison","dir":"Articles","previous_headings":"","what":"Model comparison","title":"Subgroup analysis","text":"Metrics brms can compare full subgroup reduced non-subgroup model assess effect subgroup whole. can easily compute widely applicable information criterion (WAIC) model. Likewise, can compare models terms expected log predictive density (ELPD) based approximate Pareto-smoothed leave-one-cross-validation.","code":"brms::waic(model_subgroup) #>  #> Computed from 4000 by 900 log-likelihood matrix #>  #>           Estimate   SE #> elpd_waic  -1275.5 20.0 #> p_waic        19.8  1.0 #> waic        2551.0 39.9 brms::waic(model_reduced) #>  #> Computed from 4000 by 900 log-likelihood matrix #>  #>           Estimate   SE #> elpd_waic  -1273.9 20.0 #> p_waic        17.1  0.9 #> waic        2547.7 40.0 loo_subgroup <- brms::loo(model_subgroup) loo_reduced <- brms::loo(model_reduced) loo_subgroup #>  #> Computed from 4000 by 900 log-likelihood matrix #>  #>          Estimate   SE #> elpd_loo  -1275.6 20.0 #> p_loo        19.9  1.0 #> looic      2551.1 39.9 #> ------ #> Monte Carlo SE of elpd_loo is 0.1. #>  #> All Pareto k estimates are good (k < 0.5). #> See help('pareto-k-diagnostic') for details. loo_reduced #>  #> Computed from 4000 by 900 log-likelihood matrix #>  #>          Estimate   SE #> elpd_loo  -1273.9 20.0 #> p_loo        17.1  0.9 #> looic      2547.8 40.0 #> ------ #> Monte Carlo SE of elpd_loo is 0.1. #>  #> All Pareto k estimates are good (k < 0.5). #> See help('pareto-k-diagnostic') for details. loo::loo_compare(loo_subgroup, loo_reduced) #>                elpd_diff se_diff #> model_reduced   0.0       0.0    #> model_subgroup -1.7       1.5"},{"path":"/articles/subgroup.html","id":"visualization","dir":"Articles","previous_headings":"","what":"Visualization","title":"Subgroup analysis","text":"brm_plot_draws() aware subgroup-specific marginal means. plot chunk compare Likewise brm_plot_compare(). following function call compares subgroup model results subgroup data. plot chunk subgroup-vs-data can also visually compare treatment effects full subgroup reduced non-subgroup models, marginalizing subgroup levels cases. plot chunk reduced-model-comparison","code":"brm_plot_draws(draws_subgroup_specific$difference_group) brm_plot_compare(   data = summaries_data_subgroup,   model = summaries_subgroup_specific,   marginal = \"response\" ) brm_plot_compare(   subgroup = summaries_subgroup_comparison,   reduced = summaries_reduced,   marginal = \"difference_group\" )"},{"path":"/articles/usage.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Usage","text":"use brms.mmrm package, begin longitudinal dataset one row per patient observation columns response variable, treatment group indicator, discrete time point indicator, patient ID variable, optional baseline covariates age region. real dataset , can simulate one package. following dataset raw response variable, essential factor variables, continuous baseline covariates.1 general, outcome variable can either raw response change baseline. Next, create special classed dataset package recognize. classed data object contains pre-processed version data, along attributes declare outcome variable, whether outcome response change baseline, treatment group variable, discrete time point variable, control group, baseline time point, covariates selected analysis.","code":"library(brms.mmrm) library(dplyr) library(magrittr) set.seed(0L) raw_data <- brm_simulate_simple(   n_group = 3,   n_patient = 100,   n_time = 4 ) %>%   extract2(\"data\") %>%   brm_simulate_continuous(c(\"biomarker1\", \"biomarker2\", \"biomarker3\"))  raw_data #> # A tibble: 1,200 × 7 #>    response group   time   patient     biomarker1 biomarker2 biomarker3 #>       <dbl> <chr>   <chr>  <chr>            <dbl>      <dbl>      <dbl> #>  1    1.11  group_1 time_1 patient_001      1.31      -0.361      1.52  #>  2    2.15  group_1 time_2 patient_001      1.31      -0.361      1.52  #>  3    2.54  group_1 time_3 patient_001      1.31      -0.361      1.52  #>  4   -1.73  group_1 time_4 patient_001      1.31      -0.361      1.52  #>  5    1.11  group_1 time_1 patient_002      0.107     -2.44      -0.139 #>  6    2.64  group_1 time_2 patient_002      0.107     -2.44      -0.139 #>  7    1.69  group_1 time_3 patient_002      0.107     -2.44      -0.139 #>  8    0.783 group_1 time_4 patient_002      0.107     -2.44      -0.139 #>  9    0.118 group_1 time_1 patient_003      1.44      -0.419     -1.54  #> 10    2.48  group_1 time_2 patient_003      1.44      -0.419     -1.54  #> # ℹ 1,190 more rows data <- brm_data(   data = raw_data,   outcome = \"response\",   role = \"response\",   group = \"group\",   patient = \"patient\",   time = \"time\",   covariates = c(\"biomarker1\", \"biomarker2\"),   reference_group = \"group_1\",   reference_time = \"time_1\" )  data #> # A tibble: 1,200 × 6 #>    response group   time   patient     biomarker1 biomarker2 #>       <dbl> <chr>   <chr>  <chr>            <dbl>      <dbl> #>  1    1.11  group_1 time_1 patient_001      1.31      -0.361 #>  2    2.15  group_1 time_2 patient_001      1.31      -0.361 #>  3    2.54  group_1 time_3 patient_001      1.31      -0.361 #>  4   -1.73  group_1 time_4 patient_001      1.31      -0.361 #>  5    1.11  group_1 time_1 patient_002      0.107     -2.44  #>  6    2.64  group_1 time_2 patient_002      0.107     -2.44  #>  7    1.69  group_1 time_3 patient_002      0.107     -2.44  #>  8    0.783 group_1 time_4 patient_002      0.107     -2.44  #>  9    0.118 group_1 time_1 patient_003      1.44      -0.419 #> 10    2.48  group_1 time_2 patient_003      1.44      -0.419 #> # ℹ 1,190 more rows  class(data) #> [1] \"brm_data\"   \"tbl_df\"     \"tbl\"        \"data.frame\"  roles <- attributes(data) roles$row.names <- NULL str(roles) #> List of 14 #>  $ names              : chr [1:6] \"response\" \"group\" \"time\" \"patient\" ... #>  $ class              : chr [1:4] \"brm_data\" \"tbl_df\" \"tbl\" \"data.frame\" #>  $ brm_outcome        : chr \"response\" #>  $ brm_role           : chr \"response\" #>  $ brm_group          : chr \"group\" #>  $ brm_time           : chr \"time\" #>  $ brm_patient        : chr \"patient\" #>  $ brm_covariates     : chr [1:2] \"biomarker1\" \"biomarker2\" #>  $ brm_reference_group: chr \"group_1\" #>  $ brm_reference_time : chr \"time_1\" #>  $ brm_levels_group   : chr [1:3] \"group_1\" \"group_2\" \"group_3\" #>  $ brm_levels_time    : chr [1:4] \"time_1\" \"time_2\" \"time_3\" \"time_4\" #>  $ brm_labels_group   : chr [1:3] \"group_1\" \"group_2\" \"group_3\" #>  $ brm_labels_time    : chr [1:4] \"time_1\" \"time_2\" \"time_3\" \"time_4\""},{"path":"/articles/usage.html","id":"formula","dir":"Articles","previous_headings":"","what":"Formula","title":"Usage","text":"Next, choose brms model formula fixed effect variance parameters. brm_formula() function brms.mmrm makes process easier. cell means parameterization particular model can expressed follows. specifies one fixed effect parameter combination treatment group time point, makes specification informative priors straightforward prior argument brm_model(). purposes example, choose fully parameterized analysis raw response.","code":"brm_formula(   data = data,   intercept = FALSE,   baseline = FALSE,   group = FALSE,   time = FALSE,   baseline_time = FALSE,   group_time = TRUE ) #> response ~ 0 + group:time + biomarker1 + biomarker2 + unstr(time = time, gr = patient)  #> sigma ~ 0 + time formula <- brm_formula(   data = data,   intercept = TRUE,   baseline = FALSE,   group = TRUE,   time = TRUE,   baseline_time = FALSE,   group_time = TRUE )  formula #> response ~ group + group:time + time + biomarker1 + biomarker2 + unstr(time = time, gr = patient)  #> sigma ~ 0 + time"},{"path":"/articles/usage.html","id":"parameterization","dir":"Articles","previous_headings":"","what":"Parameterization","title":"Usage","text":"formula factor ultimately determines fixed effect parameterization. ordering categorical variables data, well contrast option R, affect construction model matrix. see model matrix ultimately used brm_model(), run brms::make_standata() examine X element returned list. contrast option accepts named vector two character vectors govern model.matrix() contrasts unordered ordered variables, respectively. make_standata() function lets see data brms generate Stan. includes fixed effects model matrix X. Note differences groupgroup_* additive terms matrix one . choose different contrast method, different model matrix may result.","code":"options(contrasts = c(unordered = \"contr.SAS\", ordered = \"contr.poly\")) head(brms::make_standata(formula = formula, data = data)$X) #>   Intercept groupgroup_1 groupgroup_2 timetime_1 timetime_2 timetime_3 biomarker1 #> 1         1            1            0          1          0          0  1.3126508 #> 2         1            1            0          0          1          0  1.3126508 #> 3         1            1            0          0          0          1  1.3126508 #> 4         1            1            0          0          0          0  1.3126508 #> 5         1            1            0          1          0          0  0.1068624 #> 6         1            1            0          0          1          0  0.1068624 #>   biomarker2 groupgroup_1:timetime_1 groupgroup_2:timetime_1 groupgroup_1:timetime_2 #> 1 -0.3608809                       1                       0                       0 #> 2 -0.3608809                       0                       0                       1 #> 3 -0.3608809                       0                       0                       0 #> 4 -0.3608809                       0                       0                       0 #> 5 -2.4441488                       1                       0                       0 #> 6 -2.4441488                       0                       0                       1 #>   groupgroup_2:timetime_2 groupgroup_1:timetime_3 groupgroup_2:timetime_3 #> 1                       0                       0                       0 #> 2                       0                       0                       0 #> 3                       0                       1                       0 #> 4                       0                       0                       0 #> 5                       0                       0                       0 #> 6                       0                       0                       0 options(   contrasts = c(unordered = \"contr.treatment\", ordered = \"contr.poly\") ) # different model matrix than before: head(brms::make_standata(formula = formula, data = data)$X) #>   Intercept groupgroup_2 groupgroup_3 timetime_2 timetime_3 timetime_4 biomarker1 #> 1         1            0            0          0          0          0  1.3126508 #> 2         1            0            0          1          0          0  1.3126508 #> 3         1            0            0          0          1          0  1.3126508 #> 4         1            0            0          0          0          1  1.3126508 #> 5         1            0            0          0          0          0  0.1068624 #> 6         1            0            0          1          0          0  0.1068624 #>   biomarker2 groupgroup_2:timetime_2 groupgroup_3:timetime_2 groupgroup_2:timetime_3 #> 1 -0.3608809                       0                       0                       0 #> 2 -0.3608809                       0                       0                       0 #> 3 -0.3608809                       0                       0                       0 #> 4 -0.3608809                       0                       0                       0 #> 5 -2.4441488                       0                       0                       0 #> 6 -2.4441488                       0                       0                       0 #>   groupgroup_3:timetime_3 groupgroup_2:timetime_4 groupgroup_3:timetime_4 #> 1                       0                       0                       0 #> 2                       0                       0                       0 #> 3                       0                       0                       0 #> 4                       0                       0                       0 #> 5                       0                       0                       0 #> 6                       0                       0                       0"},{"path":"/articles/usage.html","id":"priors","dir":"Articles","previous_headings":"","what":"Priors","title":"Usage","text":"analyses require informative priors, others require non-informative ones. Please use brms construct prior suitable analysis. brms package documentation default priors constructed set priors. R object represents joint prior distribution model, can pass brm_model() function described . get_prior() function shows default priors given dataset model formula.","code":"brms::get_prior(data = data, formula = formula) #>                   prior     class                    coef group resp  dpar nlpar lb ub #>                  (flat)         b                                                      #>                  (flat)         b              biomarker1                              #>                  (flat)         b              biomarker2                              #>                  (flat)         b            groupgroup_2                              #>                  (flat)         b groupgroup_2:timetime_2                              #>                  (flat)         b groupgroup_2:timetime_3                              #>                  (flat)         b groupgroup_2:timetime_4                              #>                  (flat)         b            groupgroup_3                              #>                  (flat)         b groupgroup_3:timetime_2                              #>                  (flat)         b groupgroup_3:timetime_3                              #>                  (flat)         b groupgroup_3:timetime_4                              #>                  (flat)         b              timetime_2                              #>                  (flat)         b              timetime_3                              #>                  (flat)         b              timetime_4                              #>                  lkj(1)   cortime                                                      #>  student_t(3, 0.9, 2.5) Intercept                                                      #>                  (flat)         b                                    sigma             #>                  (flat)         b              timetime_1            sigma             #>                  (flat)         b              timetime_2            sigma             #>                  (flat)         b              timetime_3            sigma             #>                  (flat)         b              timetime_4            sigma             #>        source #>       default #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized) #>       default #>       default #>       default #>  (vectorized) #>  (vectorized) #>  (vectorized) #>  (vectorized)"},{"path":"/articles/usage.html","id":"model","dir":"Articles","previous_headings":"","what":"Model","title":"Usage","text":"run MMRM, use brm_model() function. function calls brms::brm() behind scenes, using formula prior set formula prior arguments. result brms model object.","code":"model <- brm_model(data = data, formula = formula, refresh = 0) model #>  Family: gaussian  #>   Links: mu = identity; sigma = log  #> Formula: response ~ group + group:time + time + biomarker1 + biomarker2 + unstr(time = time, gr = patient)  #>          sigma ~ 0 + time #>    Data: data[!is.na(data[[attr(data, \"brm_outcome\")]]), ] (Number of observations: 1200)  #>   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1; #>          total post-warmup draws = 4000 #>  #> Correlation Structures: #>                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS #> cortime(time_1,time_2)     0.42      0.05     0.33     0.51 1.00     3382     2852 #> cortime(time_1,time_3)    -0.80      0.02    -0.84    -0.76 1.00     2556     2895 #> cortime(time_2,time_3)    -0.54      0.04    -0.62    -0.46 1.00     3662     3516 #> cortime(time_1,time_4)    -0.29      0.05    -0.39    -0.18 1.00     3986     2962 #> cortime(time_2,time_4)     0.03      0.06    -0.08     0.14 1.00     3173     2746 #> cortime(time_3,time_4)    -0.10      0.06    -0.21     0.01 1.00     3969     2808 #>  #> Population-Level Effects:  #>                         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS #> Intercept                   1.22      0.09     1.05     1.39 1.01     1362     2352 #> groupgroup_2               -1.54      0.13    -1.78    -1.30 1.01     1402     2349 #> groupgroup_3                0.18      0.12    -0.06     0.42 1.00     1547     2209 #> timetime_2                  1.31      0.10     1.11     1.51 1.00     1807     2158 #> timetime_3                  0.51      0.17     0.17     0.84 1.00     1538     2286 #> timetime_4                 -1.45      0.17    -1.79    -1.12 1.01     1539     2284 #> biomarker1                 -0.01      0.01    -0.03     0.01 1.00     5220     3207 #> biomarker2                  0.02      0.01     0.00     0.04 1.00     5408     2900 #> groupgroup_2:timetime_2     0.04      0.15    -0.24     0.33 1.00     2001     2680 #> groupgroup_3:timetime_2     0.03      0.14    -0.25     0.30 1.00     2139     2806 #> groupgroup_2:timetime_3    -0.16      0.25    -0.64     0.32 1.00     1566     2224 #> groupgroup_3:timetime_3    -0.19      0.25    -0.68     0.29 1.00     1784     2678 #> groupgroup_2:timetime_4    -0.06      0.24    -0.54     0.42 1.00     1691     2437 #> groupgroup_3:timetime_4    -0.25      0.24    -0.71     0.22 1.00     1789     2256 #> sigma_timetime_1           -0.12      0.04    -0.20    -0.04 1.00     2528     2525 #> sigma_timetime_2            0.00      0.04    -0.07     0.09 1.00     3831     2891 #> sigma_timetime_3           -0.05      0.04    -0.13     0.03 1.00     2345     2748 #> sigma_timetime_4            0.21      0.04     0.13     0.29 1.00     3631     2831 #>  #> Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS #> and Tail_ESS are effective sample size measures, and Rhat is the potential #> scale reduction factor on split chains (at convergence, Rhat = 1)."},{"path":"/articles/usage.html","id":"marginals","dir":"Articles","previous_headings":"","what":"Marginals","title":"Usage","text":"Regardless choice fixed effects formula, brms.mmrm performs inference marginal distributions treatment group time point mean following quantities: Response. Change baseline, set role \"change\" brm_data(). Treatment difference, terms change baseline. Effect size: treatment difference divided residual standard deviation. derive posterior draws marginals, use brm_marginal_draws() function. need samples marginals averaged across time points, e.g. “overall effect size”, brm_marginal_draws_average() can average draws across discrete time points (either user-defined subset). brm_marginal_summaries() function produces posterior summaries marginals, includes Monte Carlo standard error (MCSE) estimate. brm_marginal_probabilities() function shows posterior probabilities form, \\[ \\begin{aligned} \\text{Prob}(\\text{treatment effect} > \\text{threshold}) \\end{aligned} \\] \\[ \\begin{aligned} \\text{Prob}(\\text{treatment effect} < \\text{threshold}) \\end{aligned} \\] Finally, brm_marignal_data() computes marginal means confidence intervals response variable data, along summary statistics.","code":"draws <- brm_marginal_draws(model = model, data = data)  draws #> $response #> # A draws_df: 1000 iterations, 4 chains, and 12 variables #>    group_1|time_1 group_2|time_1 group_3|time_1 group_1|time_2 group_2|time_2 #> 1             1.2          -0.41            1.4            2.5           1.01 #> 2             1.2          -0.29            1.3            2.6           1.09 #> 3             1.3          -0.32            1.4            2.4           1.08 #> 4             1.2          -0.33            1.4            2.4           0.98 #> 5             1.2          -0.43            1.3            2.5           1.04 #> 6             1.3          -0.41            1.3            2.4           0.96 #> 7             1.4          -0.32            1.5            2.5           1.03 #> 8             1.3          -0.23            1.4            2.6           1.12 #> 9             1.2          -0.31            1.4            2.6           1.10 #> 10            1.2          -0.24            1.4            2.4           1.10 #>    group_3|time_2 group_1|time_3 group_2|time_3 #> 1             2.6            1.7          0.121 #> 2             2.8            1.7         -0.065 #> 3             2.8            1.7          0.054 #> 4             2.8            1.8          0.078 #> 5             2.8            1.7          0.039 #> 6             2.7            1.8          0.139 #> 7             2.7            1.6          0.085 #> 8             2.8            1.5         -0.138 #> 9             2.6            1.7          0.014 #> 10            2.6            1.7         -0.072 #> # ... with 3990 more draws, and 4 more variables #> # ... hidden reserved variables {'.chain', '.iteration', '.draw'} #>  #> $difference_time #> # A draws_df: 1000 iterations, 4 chains, and 9 variables #>    group_1|time_2 group_1|time_3 group_1|time_4 group_2|time_2 group_2|time_3 #> 1             1.3           0.47           -1.4            1.4          0.527 #> 2             1.3           0.48           -1.4            1.4          0.221 #> 3             1.2           0.42           -1.5            1.4          0.375 #> 4             1.2           0.53           -1.5            1.3          0.411 #> 5             1.2           0.49           -1.6            1.5          0.470 #> 6             1.2           0.52           -1.5            1.4          0.552 #> 7             1.0           0.14           -2.1            1.4          0.407 #> 8             1.3           0.26           -1.3            1.4          0.096 #> 9             1.4           0.48           -1.3            1.4          0.322 #> 10            1.2           0.50           -1.5            1.3          0.171 #>    group_2|time_4 group_3|time_2 group_3|time_3 #> 1            -1.5            1.2           0.29 #> 2            -1.4            1.5           0.50 #> 3            -1.7            1.3           0.18 #> 4            -1.6            1.4           0.23 #> 5            -1.2            1.5           0.56 #> 6            -1.4            1.4           0.61 #> 7            -1.6            1.2           0.13 #> 8            -1.4            1.4           0.28 #> 9            -1.6            1.2           0.33 #> 10           -1.5            1.2           0.36 #> # ... with 3990 more draws, and 1 more variables #> # ... hidden reserved variables {'.chain', '.iteration', '.draw'} #>  #> $difference_group #> # A draws_df: 1000 iterations, 4 chains, and 6 variables #>    group_2|time_2 group_2|time_3 group_2|time_4 group_3|time_2 group_3|time_3 #> 1           0.133          0.054         -0.096         -0.053        -0.1791 #> 2           0.059         -0.264          0.017          0.167         0.0151 #> 3           0.219         -0.049         -0.144          0.154        -0.2428 #> 4           0.142         -0.115         -0.085          0.199        -0.2974 #> 5           0.244         -0.016          0.382          0.321         0.0719 #> 6           0.209          0.034          0.170          0.275         0.0925 #> 7           0.324          0.269          0.442          0.217        -0.0091 #> 8           0.006         -0.161         -0.097          0.049         0.0216 #> 9          -0.016         -0.156         -0.354         -0.174        -0.1527 #> 10          0.148         -0.325          0.036          0.041        -0.1382 #>    group_3|time_4 #> 1          -0.376 #> 2          -0.063 #> 3          -0.046 #> 4          -0.069 #> 5          -0.049 #> 6          -0.029 #> 7           0.486 #> 8          -0.299 #> 9          -0.431 #> 10         -0.316 #> # ... with 3990 more draws #> # ... hidden reserved variables {'.chain', '.iteration', '.draw'} #>  #> $effect #> # A draws_df: 1000 iterations, 4 chains, and 6 variables #>    group_2|time_2 group_2|time_3 group_2|time_4 group_3|time_2 group_3|time_3 #> 1           0.134          0.055         -0.079         -0.054        -0.1846 #> 2           0.060         -0.286          0.014          0.170         0.0164 #> 3           0.209         -0.047         -0.118          0.147        -0.2351 #> 4           0.137         -0.112         -0.070          0.192        -0.2910 #> 5           0.223         -0.016          0.313          0.292         0.0726 #> 6           0.195          0.034          0.140          0.257         0.0930 #> 7           0.337          0.275          0.360          0.226        -0.0094 #> 8           0.006         -0.179         -0.079          0.049         0.0241 #> 9          -0.016         -0.167         -0.282         -0.177        -0.1632 #> 10          0.150         -0.345          0.030          0.041        -0.1465 #>    group_3|time_4 #> 1          -0.307 #> 2          -0.052 #> 3          -0.037 #> 4          -0.057 #> 5          -0.040 #> 6          -0.024 #> 7           0.396 #> 8          -0.246 #> 9          -0.343 #> 10         -0.262 #> # ... with 3990 more draws #> # ... hidden reserved variables {'.chain', '.iteration', '.draw'} brm_marginal_draws_average(draws = draws, data = data) #> $response #> # A draws_df: 1000 iterations, 4 chains, and 3 variables #>    group_1|average group_2|average group_3|average #> 1              1.3           -0.31             1.3 #> 2              1.3           -0.24             1.4 #> 3              1.3           -0.29             1.4 #> 4              1.3           -0.30             1.4 #> 5              1.3           -0.24             1.4 #> 6              1.3           -0.28             1.4 #> 7              1.2           -0.29             1.4 #> 8              1.4           -0.23             1.4 #> 9              1.3           -0.29             1.4 #> 10             1.3           -0.24             1.3 #> # ... with 3990 more draws #> # ... hidden reserved variables {'.chain', '.iteration', '.draw'} #>  #> $difference_time #> # A draws_df: 1000 iterations, 4 chains, and 3 variables #>    group_1|average group_2|average group_3|average #> 1            0.104          0.1343         -0.0983 #> 2            0.125          0.0620          0.1643 #> 3            0.029          0.0377         -0.0159 #> 4            0.058          0.0387          0.0024 #> 5            0.045          0.2492          0.1599 #> 6            0.045          0.1828          0.1580 #> 7           -0.301          0.0444         -0.0696 #> 8            0.092          0.0083          0.0158 #> 9            0.205          0.0291         -0.0480 #> 10           0.054          0.0073         -0.0835 #> # ... with 3990 more draws #> # ... hidden reserved variables {'.chain', '.iteration', '.draw'} #>  #> $difference_group #> # A draws_df: 1000 iterations, 4 chains, and 2 variables #>    group_2|average group_3|average #> 1           0.0300          -0.203 #> 2          -0.0626           0.040 #> 3           0.0087          -0.045 #> 4          -0.0195          -0.056 #> 5           0.2037           0.114 #> 6           0.1377           0.113 #> 7           0.3453           0.231 #> 8          -0.0837          -0.076 #> 9          -0.1754          -0.253 #> 10         -0.0472          -0.138 #> # ... with 3990 more draws #> # ... hidden reserved variables {'.chain', '.iteration', '.draw'} #>  #> $effect #> # A draws_df: 1000 iterations, 4 chains, and 2 variables #>    group_2|average group_3|average #> 1            0.037          -0.182 #> 2           -0.071           0.045 #> 3            0.015          -0.042 #> 4           -0.015          -0.052 #> 5            0.173           0.108 #> 6            0.123           0.109 #> 7            0.324           0.204 #> 8           -0.084          -0.058 #> 9           -0.155          -0.228 #> 10          -0.055          -0.122 #> # ... with 3990 more draws #> # ... hidden reserved variables {'.chain', '.iteration', '.draw'} summaries <- brm_marginal_summaries(draws, level = 0.95)  summaries #> # A tibble: 165 × 6 #>    marginal         statistic group   time     value    mcse #>    <chr>            <chr>     <chr>   <chr>    <dbl>   <dbl> #>  1 difference_group lower     group_2 time_2 -0.238  0.00963 #>  2 difference_group lower     group_2 time_3 -0.636  0.00938 #>  3 difference_group lower     group_2 time_4 -0.540  0.00959 #>  4 difference_group lower     group_3 time_2 -0.250  0.00661 #>  5 difference_group lower     group_3 time_3 -0.679  0.00935 #>  6 difference_group lower     group_3 time_4 -0.713  0.0103  #>  7 difference_group mean      group_2 time_2  0.0441 0.00329 #>  8 difference_group mean      group_2 time_3 -0.159  0.00624 #>  9 difference_group mean      group_2 time_4 -0.0616 0.00593 #> 10 difference_group mean      group_3 time_2  0.0279 0.00312 #> # ℹ 155 more rows brm_marginal_probabilities(   draws = draws,   threshold = c(-0.1, 0.1),   direction = c(\"greater\", \"less\") ) #> # A tibble: 12 × 5 #>    direction threshold group   time   value #>    <chr>         <dbl> <chr>   <chr>  <dbl> #>  1 greater        -0.1 group_2 time_2 0.828 #>  2 greater        -0.1 group_2 time_3 0.404 #>  3 greater        -0.1 group_2 time_4 0.567 #>  4 greater        -0.1 group_3 time_2 0.816 #>  5 greater        -0.1 group_3 time_3 0.365 #>  6 greater        -0.1 group_3 time_4 0.254 #>  7 less            0.1 group_2 time_2 0.645 #>  8 less            0.1 group_2 time_3 0.850 #>  9 less            0.1 group_2 time_4 0.753 #> 10 less            0.1 group_3 time_2 0.703 #> 11 less            0.1 group_3 time_3 0.885 #> 12 less            0.1 group_3 time_4 0.926 summaries_data <- brm_marginal_data(data = data, level = 0.95)  summaries_data #> # A tibble: 84 × 4 #>    statistic group   time     value #>    <chr>     <chr>   <chr>    <dbl> #>  1 lower     group_1 time_1  1.40   #>  2 lower     group_1 time_2  2.71   #>  3 lower     group_1 time_3  1.91   #>  4 lower     group_1 time_4  0.0151 #>  5 lower     group_2 time_1 -0.150  #>  6 lower     group_2 time_2  1.23   #>  7 lower     group_2 time_3  0.218  #>  8 lower     group_2 time_4 -1.59   #>  9 lower     group_3 time_1  1.57   #> 10 lower     group_3 time_2  2.95   #> # ℹ 74 more rows"},{"path":"/articles/usage.html","id":"visualization","dir":"Articles","previous_headings":"","what":"Visualization","title":"Usage","text":"brm_plot_compare() function compares means intervals many different models data sources plot. First, need marginals data.  omit marginals data, can show inference change baseline treatment effect.  Additional arguments let control primary comparison interest (color aesthetic), horizontal axis, faceting variable.  Finally, brm_plot_draws() can plot posterior draws response, change baseline, treatment difference.  axis facet arguments customize horizontal axis faceting variable, respectively.","code":"brm_plot_compare(   data = summaries_data,   model1 = summaries,   model2 = summaries ) brm_plot_compare(   model1 = summaries,   model2 = summaries,   marginal = \"difference_group\" # treatment effect ) brm_plot_compare(   model1 = summaries,   model2 = summaries,   marginal = \"difference_group\",   compare = \"group\",   axis = \"time\",   facet = \"source\" # model1 vs model2 ) brm_plot_draws(draws = draws$difference_group) brm_plot_draws(   draws = draws$difference_group,   axis = \"group\",   facet = \"time\" )"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"William Michael Landau. Author, maintainer. Kevin Kunzmann. Author. Yoni Sidi. Author. Christian Stock. Author. Eli Lilly Company. Copyright holder, funder. Boehringer Ingelheim Pharma GmbH & Co. KG. Copyright holder, funder.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Landau WM, Kunzmann K, Sidi Y, Stock C (2024). brms.mmrm: Bayesian MMRMs using 'brms'. R package version 0.0.2.9003,  https://github.com/openpharma/brms.mmrm, https://openpharma.github.io/brms.mmrm/.","code":"@Manual{,   title = {brms.mmrm: Bayesian MMRMs using 'brms'},   author = {William Michael Landau and Kevin Kunzmann and Yoni Sidi and Christian Stock},   year = {2024},   note = {R package version 0.0.2.9003,  https://github.com/openpharma/brms.mmrm},   url = {https://openpharma.github.io/brms.mmrm/}, }"},{"path":"/index.html","id":"brmsmmrm","dir":"","previous_headings":"","what":"Bayesian MMRMs using brms","title":"Bayesian MMRMs using brms","text":"mixed model repeated measures (MMRM) popular model longitudinal clinical trial data continuous endpoints, brms powerful versatile package fitting Bayesian regression models. brms.mmrm R package leverages brms run MMRMs, supports simplified interfaced reduce difficulty align best practices life sciences.","code":""},{"path":[]},{"path":"/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Bayesian MMRMs using brms","text":"documentation website https://openpharma.github.io/brms.mmrm/ complete function reference tutorial vignettes.","code":""},{"path":"/index.html","id":"disclaimer","dir":"","previous_headings":"","what":"Disclaimer","title":"Bayesian MMRMs using brms","text":"package still early development phase, means: validated serious analyses, interface output may still change ways compatible previous versions.","code":""},{"path":"/index.html","id":"help","dir":"","previous_headings":"","what":"Help","title":"Bayesian MMRMs using brms","text":"Please report questions problems GitHub discussions GitHub issues, respectively.","code":""},{"path":"/index.html","id":"thanks","dir":"","previous_headings":"","what":"Thanks","title":"Bayesian MMRMs using brms","text":"Thanks openstatsware R Consortium providing professional networks recruit skilled statisticians developers.","code":""},{"path":"/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of conduct","title":"Bayesian MMRMs using brms","text":"Please note brms.mmrm project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Bayesian MMRMs using brms","text":"","code":"To cite package 'brms.mmrm' in publications use:    Landau WM, Kunzmann K, Sidi Y, Stock C (????). _brms.mmrm: Bayesian   MMRMs using 'brms'_. R package version 0.0.2.9002,   https://github.com/openpharma/brms.mmrm,   <https://openpharma.github.io/brms.mmrm/>.  A BibTeX entry for LaTeX users is    @Manual{,     title = {brms.mmrm: Bayesian MMRMs using 'brms'},     author = {William Michael Landau and Kevin Kunzmann and Yoni Sidi and Christian Stock},     note = {R package version 0.0.2.9002,  https://github.com/openpharma/brms.mmrm},     url = {https://openpharma.github.io/brms.mmrm/},   }"},{"path":"/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Bayesian MMRMs using brms","text":"Paul-Christian Bürkner (2017). brms: R Package Bayesian Multilevel Models Using Stan. Journal Statistical Software, 80(1), 1-28. Mallinckrodt, C.H., Lane, P.W., Schnell, D. et al. Recommendations Primary Analysis Continuous Endpoints Longitudinal Clinical Trials. Ther Innov Regul Sci 42, 303–319 (2008).","code":""},{"path":"/reference/brm_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Create and preprocess an MMRM dataset. — brm_data","title":"Create and preprocess an MMRM dataset. — brm_data","text":"Create dataset analyze MMRM.","code":""},{"path":"/reference/brm_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create and preprocess an MMRM dataset. — brm_data","text":"","code":"brm_data(   data,   outcome = \"CHG\",   role = \"change\",   baseline = NULL,   group = \"TRT01P\",   subgroup = NULL,   time = \"AVISIT\",   patient = \"USUBJID\",   covariates = character(0L),   missing = NULL,   reference_group = \"Placebo\",   level_control = NULL,   reference_subgroup = NULL,   reference_time = NULL,   level_baseline = NULL )"},{"path":"/reference/brm_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create and preprocess an MMRM dataset. — brm_data","text":"data Data frame tibble longitudinal data. outcome Character length 1, name outcome variable. role Character length 1. Either \"response\" outcome raw response variable (e.g. AVAL) \"change\" outcome change baseline (e.g. CHG). baseline Character length 1, name baseline response variable. relevant response variable change baseline. Supply NULL ignore omit. group Character length 1, name treatment group variable. Must point character vector data. Factors converted characters. subgroup Character length 1, optional name discrete subgroup variable. Set NULL omit subgroup (default). time Character length 1, name discrete time variable. Must point character vector data. Factors converted characters. patient Character length 1, name patient ID variable. covariates Character vector names covariates. missing Character length 1, name optional variable simulated dataset indicate outcome values missing. Set NULL omit. reference_group Character length 1, Level group column indicate control group. reference_group applies post-processing happens functions like brm_marginal_draws() downstream model. control fixed effect parameterization model matrix brms derives formula brm_formula(). level_control Deprecated 2024-01-11 (version 0.2.0.9002). Use reference_group instead. reference_subgroup Character length 1, level subgroup column use reference pairwise differences computing marginal means downstream model. control fixed effect parameterization model matrix brms derives formula brm_formula(). reference_time Character length 1 NULL, level time column indicate baseline time point. value present data outcome variable change baseline, must data outcome variable raw response brms.mmrm can produce model-based marginal estimates change baseline. words, set reference_time NULL role \"change\", set reference_time non-null value data[[time]] role \"response\". Note: reference_time applies post-processing happens functions like brm_marginal_draws() downstream model. control fixed effect parameterization model matrix brms derives formula brm_formula(). level_baseline Deprecated 2024-01-11 (version 0.2.0.9002). Use reference_time instead.","code":""},{"path":"/reference/brm_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create and preprocess an MMRM dataset. — brm_data","text":"classed tibble attributes denote features data treatment group discrete time variables.","code":""},{"path":"/reference/brm_data.html","id":"preprocessing","dir":"Reference","previous_headings":"","what":"Preprocessing","title":"Create and preprocess an MMRM dataset. — brm_data","text":"preprocessing steps brm_data() follows: Perform basic assertions make sure data arguments properly formatted. Convert group time columns character vectors. Sanitize levels group time columns using make.names(unique = FALSE, allow_ = TRUE) ensure agreement data output brms. implicitly missing outcome observation, add explicit row outcome variable equal NA_real_. Arrange rows data group, patient, discrete time. Select columns data relevant MMRM analysis.","code":""},{"path":"/reference/brm_data.html","id":"separation-string","dir":"Reference","previous_headings":"","what":"Separation string","title":"Create and preprocess an MMRM dataset. — brm_data","text":"Post-processing brm_marginal_draws() names group--time marginal means delimiting character string Sys.getenv(\"BRM_SEP\", unset = \"|\"). Neither column names element names group time variables can contain string. set custom string , use Sys.setenv(BRM_SEP = \"YOUR_CUSTOM_STRING\").","code":""},{"path":[]},{"path":"/reference/brm_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create and preprocess an MMRM dataset. — brm_data","text":"","code":"set.seed(0) data <- brm_simulate_simple()$data colnames(data) <- paste0(\"col_\", colnames(data)) data #> # A tibble: 800 × 4 #>    col_response col_group col_time col_patient #>           <dbl> <chr>     <chr>    <chr>       #>  1        1.47  group_1   time_1   patient_001 #>  2        3.10  group_1   time_2   patient_001 #>  3        2.22  group_1   time_3   patient_001 #>  4        0.215 group_1   time_4   patient_001 #>  5        1.03  group_1   time_1   patient_002 #>  6        2.28  group_1   time_2   patient_002 #>  7        2.36  group_1   time_3   patient_002 #>  8        2.33  group_1   time_4   patient_002 #>  9        0.128 group_1   time_1   patient_003 #> 10        1.89  group_1   time_2   patient_003 #> # ℹ 790 more rows brm_data(   data = data,   outcome = \"col_response\",   role = \"response\",   group = \"col_group\",   time = \"col_time\",   patient = \"col_patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) #> # A tibble: 800 × 4 #>    col_response col_group col_time col_patient #>           <dbl> <chr>     <chr>    <chr>       #>  1        1.47  group_1   time_1   patient_001 #>  2        3.10  group_1   time_2   patient_001 #>  3        2.22  group_1   time_3   patient_001 #>  4        0.215 group_1   time_4   patient_001 #>  5        1.03  group_1   time_1   patient_002 #>  6        2.28  group_1   time_2   patient_002 #>  7        2.36  group_1   time_3   patient_002 #>  8        2.33  group_1   time_4   patient_002 #>  9        0.128 group_1   time_1   patient_003 #> 10        1.89  group_1   time_2   patient_003 #> # ℹ 790 more rows"},{"path":"/reference/brm_data_change.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert to change from baseline. — brm_data_change","title":"Convert to change from baseline. — brm_data_change","text":"Convert dataset raw response change baseline.","code":""},{"path":"/reference/brm_data_change.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert to change from baseline. — brm_data_change","text":"","code":"brm_data_change(data, name_change = \"change\", name_baseline = \"baseline\")"},{"path":"/reference/brm_data_change.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert to change from baseline. — brm_data_change","text":"data classed tibble (e.g. brm_data()) raw response outcome variable (role = \"response\" brm_data()). name_change Character length 1, name new outcome column change baseline. name_baseline Character length 1, name new column original baseline response.","code":""},{"path":"/reference/brm_data_change.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert to change from baseline. — brm_data_change","text":"classed tibble change baseline outcome variable internal attributes modified accordingly. special baseline column also created, original raw response column removed. new baseline column comprised elements response variable corresponding reference_time argument brm_data(). column denote missing values simulation purposes, e.g. \"missing\" column generated brm_simulate_outline(), missing baseline values propagated accordingly change baseline missing either post-baseline response missing baseline response missing.","code":""},{"path":[]},{"path":"/reference/brm_data_change.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert to change from baseline. — brm_data_change","text":"","code":"set.seed(0) data <- brm_data(   data = dplyr::rename(brm_simulate_simple()$data, y_values = response),   outcome = \"y_values\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) data #> # A tibble: 800 × 4 #>    y_values group   time   patient     #>       <dbl> <chr>   <chr>  <chr>       #>  1    1.47  group_1 time_1 patient_001 #>  2    3.10  group_1 time_2 patient_001 #>  3    2.22  group_1 time_3 patient_001 #>  4    0.215 group_1 time_4 patient_001 #>  5    1.03  group_1 time_1 patient_002 #>  6    2.28  group_1 time_2 patient_002 #>  7    2.36  group_1 time_3 patient_002 #>  8    2.33  group_1 time_4 patient_002 #>  9    0.128 group_1 time_1 patient_003 #> 10    1.89  group_1 time_2 patient_003 #> # ℹ 790 more rows attr(data, \"brm_role\") #> [1] \"response\" attr(data, \"brm_outcome\") #> [1] \"y_values\" attr(data, \"brm_baseline\") #> NULL attr(data, \"brm_reference_time\") #> [1] \"time_1\" changed <- brm_data_change(data = data, name_change = \"delta\") changed #> # A tibble: 600 × 5 #>     delta baseline group   time   patient     #>     <dbl>    <dbl> <chr>   <chr>  <chr>       #>  1  1.63     1.47  group_1 time_2 patient_001 #>  2  0.750    1.47  group_1 time_3 patient_001 #>  3 -1.25     1.47  group_1 time_4 patient_001 #>  4  1.25     1.03  group_1 time_2 patient_002 #>  5  1.33     1.03  group_1 time_3 patient_002 #>  6  1.29     1.03  group_1 time_4 patient_002 #>  7  1.76     0.128 group_1 time_2 patient_003 #>  8  2.37     0.128 group_1 time_3 patient_003 #>  9  1.27     0.128 group_1 time_4 patient_003 #> 10  1.46     1.22  group_1 time_2 patient_004 #> # ℹ 590 more rows attr(changed, \"brm_role\") #> [1] \"change\" attr(changed, \"brm_outcome\") #> [1] \"delta\" attr(changed, \"brm_baseline\") #> [1] \"baseline\" attr(data, \"brm_reference_time\") #> [1] \"time_1\""},{"path":"/reference/brm_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Model formula — brm_formula","title":"Model formula — brm_formula","text":"Build model formula MMRM.","code":""},{"path":"/reference/brm_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model formula — brm_formula","text":"","code":"brm_formula(   data,   intercept = TRUE,   baseline = !is.null(attr(data, \"brm_baseline\")),   baseline_subgroup = !is.null(attr(data, \"brm_baseline\")) && !is.null(attr(data,     \"brm_subgroup\")),   baseline_subgroup_time = !is.null(attr(data, \"brm_baseline\")) && !is.null(attr(data,     \"brm_subgroup\")),   baseline_time = !is.null(attr(data, \"brm_baseline\")),   group = TRUE,   group_subgroup = !is.null(attr(data, \"brm_subgroup\")),   group_subgroup_time = !is.null(attr(data, \"brm_subgroup\")),   group_time = TRUE,   subgroup = !is.null(attr(data, \"brm_subgroup\")),   subgroup_time = !is.null(attr(data, \"brm_subgroup\")),   time = TRUE,   correlation = \"unstructured\",   effect_baseline = NULL,   effect_group = NULL,   effect_time = NULL,   interaction_baseline = NULL,   interaction_group = NULL )"},{"path":"/reference/brm_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model formula — brm_formula","text":"data classed data frame brm_data(). intercept Logical length 1. TRUE include intercept, FALSE omit. baseline Logical length 1. TRUE include additive effect baseline response, FALSE omit. baseline_subgroup Logical length 1. TRUE include baseline--subgroup interaction, FALSE omit. baseline_subgroup_time Logical length 1. TRUE include baseline--subgroup--time interaction, FALSE omit. baseline_time Logical length 1. TRUE include baseline--time interaction, FALSE omit. group Logical length 1. TRUE include additive effects treatment groups, FALSE omit. group_subgroup Logical length 1. TRUE include group--subgroup interaction, FALSE omit. group_subgroup_time Logical length 1. TRUE include group--subgroup--time interaction, FALSE omit. group_time Logical length 1. TRUE include group--time interaction, FALSE omit. subgroup Logical length 1. TRUE include additive fixed effects subgroup levels, FALSE omit. subgroup_time Logical length 1. TRUE include subgroup--time interaction, FALSE omit. time Logical length 1. TRUE include additive effect discrete time, FALSE omit. correlation Character length 1, name correlation structure. \"unstructured\" currently supported. effect_baseline Deprecated 2024-01-16 (version 0.0.2.9002). Use baseline instead. effect_group Deprecated 2024-01-16 (version 0.0.2.9002). Use group instead. effect_time Deprecated 2024-01-16 (version 0.0.2.9002). Use time instead. interaction_baseline Deprecated 2024-01-16 (version 0.0.2.9002). Use baseline_time instead. interaction_group Deprecated 2024-01-16 (version 0.0.2.9002). Use group_time instead.","code":""},{"path":"/reference/brm_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model formula — brm_formula","text":"object class \"brmsformula\" returned brms::brmsformula(). contains fixed effect parameterization, correlation structure, residual variance structure.","code":""},{"path":"/reference/brm_formula.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Model formula — brm_formula","text":"brm_formula() builds R formula MMRM based details data choice parameterization. Customize parameterization toggling various TRUE/FALSE arguments brm_formula(), intercept, baseline, group_time. plausible additive effects, two-way interactions, three-way interactions can specified. following interactions supported: interactions concomitant covariates specified covariates argument brm_data(). interactions include baseline response treatment group together. Rationale: randomized controlled experiment, baseline treatment group assignment uncorrelated.","code":""},{"path":"/reference/brm_formula.html","id":"parameterization","dir":"Reference","previous_headings":"","what":"Parameterization","title":"Model formula — brm_formula","text":"formula factor determines fixed effect parameterization. ordering categorical variables data, well contrast option R, affect construction model matrix. see model matrix ultimately used brm_model(), run brms::make_standata() examine X element returned list. See examples demonstration.","code":""},{"path":[]},{"path":"/reference/brm_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Model formula — brm_formula","text":"","code":"set.seed(0) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) brm_formula(data) #> response ~ group + group:time + time + unstr(time = time, gr = patient)  #> sigma ~ 0 + time brm_formula(data = data, intercept = FALSE, baseline = FALSE) #> response ~ 0 + group + group:time + time + unstr(time = time, gr = patient)  #> sigma ~ 0 + time formula <- brm_formula(   data = data,   intercept = FALSE,   baseline = FALSE,   group = FALSE ) formula #> response ~ 0 + group:time + time + unstr(time = time, gr = patient)  #> sigma ~ 0 + time # Optional: set the contrast option, which determines the model matrix. options(contrasts = c(unordered = \"contr.SAS\", ordered = \"contr.poly\")) # See the fixed effect parameterization you get from the data: head(brms::make_standata(formula = formula, data = data)$X) #>   timetime_1 timetime_2 timetime_3 timetime_4 timetime_1:groupgroup_1 #> 1          1          0          0          0                       1 #> 2          0          1          0          0                       0 #> 3          0          0          1          0                       0 #> 4          0          0          0          1                       0 #> 5          1          0          0          0                       1 #> 6          0          1          0          0                       0 #>   timetime_2:groupgroup_1 timetime_3:groupgroup_1 timetime_4:groupgroup_1 #> 1                       0                       0                       0 #> 2                       1                       0                       0 #> 3                       0                       1                       0 #> 4                       0                       0                       1 #> 5                       0                       0                       0 #> 6                       1                       0                       0 # Specify a different contrast method to use an alternative # parameterization when fitting the model with brm_model(): options(   contrasts = c(unordered = \"contr.treatment\", ordered = \"contr.poly\") ) # different model matrix than before: head(brms::make_standata(formula = formula, data = data)$X) #>   timetime_1 timetime_2 timetime_3 timetime_4 timetime_1:groupgroup_2 #> 1          1          0          0          0                       0 #> 2          0          1          0          0                       0 #> 3          0          0          1          0                       0 #> 4          0          0          0          1                       0 #> 5          1          0          0          0                       0 #> 6          0          1          0          0                       0 #>   timetime_2:groupgroup_2 timetime_3:groupgroup_2 timetime_4:groupgroup_2 #> 1                       0                       0                       0 #> 2                       0                       0                       0 #> 3                       0                       0                       0 #> 4                       0                       0                       0 #> 5                       0                       0                       0 #> 6                       0                       0                       0"},{"path":"/reference/brm_marginal_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Marginal summaries of the data. — brm_marginal_data","title":"Marginal summaries of the data. — brm_marginal_data","text":"Marginal summaries data.","code":""},{"path":"/reference/brm_marginal_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Marginal summaries of the data. — brm_marginal_data","text":"","code":"brm_marginal_data(   data,   level = 0.95,   use_subgroup = !is.null(attr(data, \"brm_subgroup\")) )"},{"path":"/reference/brm_marginal_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Marginal summaries of the data. — brm_marginal_data","text":"data classed data frame brm_data(). level Numeric length 1 0 1, level confidence intervals. use_subgroup Logical length 1, whether summarize data subgroup level.","code":""},{"path":"/reference/brm_marginal_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Marginal summaries of the data. — brm_marginal_data","text":"tibble one row per summary statistic following columns: group: treatment group. subgroup: subgroup level. included subgroup argument brm_marginal_data() TRUE. time: discrete time point. statistic: type summary statistic. value: numeric value estimate. statistic column following possible values: mean: observed mean response removing missing values. median: observed median response removing missing values. sd: observed standard deviation response removing missing values. lower: lower bound normal equal-tailed confidence interval confidence level determined level argument. upper: upper bound normal equal-tailed confidence interval confidence level determined level argument. n_observe: number non-missing values response. n_total: number total records data given group/time combination, including observed missing values.","code":""},{"path":[]},{"path":"/reference/brm_marginal_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Marginal summaries of the data. — brm_marginal_data","text":"","code":"set.seed(0L) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) brm_marginal_data(data = data) #> # A tibble: 56 × 4 #>    statistic group   time    value #>    <chr>     <chr>   <chr>   <dbl> #>  1 lower     group_1 time_1  1.39  #>  2 lower     group_1 time_2  2.73  #>  3 lower     group_1 time_3  2.70  #>  4 lower     group_1 time_4  1.88  #>  5 lower     group_2 time_1 -0.118 #>  6 lower     group_2 time_2  1.23  #>  7 lower     group_2 time_3  1.12  #>  8 lower     group_2 time_4  0.300 #>  9 mean      group_1 time_1  1.23  #> 10 mean      group_1 time_2  2.57  #> # ℹ 46 more rows"},{"path":"/reference/brm_marginal_draws.html","id":null,"dir":"Reference","previous_headings":"","what":"MCMC draws from the marginal posterior of an MMRM — brm_marginal_draws","title":"MCMC draws from the marginal posterior of an MMRM — brm_marginal_draws","text":"Get marginal posterior draws fitted MMRM.","code":""},{"path":"/reference/brm_marginal_draws.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MCMC draws from the marginal posterior of an MMRM — brm_marginal_draws","text":"","code":"brm_marginal_draws(   model,   data,   use_subgroup = !is.null(attr(data, \"brm_subgroup\")),   control = NULL,   baseline = NULL )"},{"path":"/reference/brm_marginal_draws.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MCMC draws from the marginal posterior of an MMRM — brm_marginal_draws","text":"model Fitted brms model object brm_model(). data Classed tibble preprocessed data brm_data(). use_subgroup Logical length 1, whether summarize draws subgroup level. TRUE, subgroup-specific marginals given. Otherwise, subgroup marginalized . control Deprecated. Set control group level brm_data(). baseline Deprecated. Set control group level brm_data().","code":""},{"path":"/reference/brm_marginal_draws.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MCMC draws from the marginal posterior of an MMRM — brm_marginal_draws","text":"named list tibbles MCMC draws marginal posterior distribution treatment group time point (group--subgroup--time, applicable). tibble, 1 row per posterior sample sand one column type marginal distribution (.e. combination treatment group discrete time point. specific tibbles returned list described : response: scale response variable. difference_time: change baseline: response particular time minus response baseline (reference_time). returned role argument brm_data() \"response\". (role \"change\", response already represents change baseline.) difference_group: treatment effect: difference_time active group minus difference_time control group (reference_group). role \"change\", treatment group instead difference response active group minus response control group. difference_subgroup: subgroup differences: difference_group subgroup level minus difference_group subgroup reference level (reference_subgroup).","code":""},{"path":"/reference/brm_marginal_draws.html","id":"separation-string","dir":"Reference","previous_headings":"","what":"Separation string","title":"MCMC draws from the marginal posterior of an MMRM — brm_marginal_draws","text":"Post-processing brm_marginal_draws() names group--time marginal means delimiting character string Sys.getenv(\"BRM_SEP\", unset = \"|\"). Neither column names element names group time variables can contain string. set custom string , use Sys.setenv(BRM_SEP = \"YOUR_CUSTOM_STRING\").","code":""},{"path":[]},{"path":"/reference/brm_marginal_draws.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MCMC draws from the marginal posterior of an MMRM — brm_marginal_draws","text":"","code":"if (identical(Sys.getenv(\"BRM_EXAMPLES\", unset = \"\"), \"true\")) { set.seed(0L) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) tmp <- utils::capture.output(   suppressMessages(     suppressWarnings(       model <- brm_model(         data = data,         formula = formula,         chains = 1,         iter = 100,         refresh = 0       )     )   ) ) brm_marginal_draws(model = model, data = data) }"},{"path":"/reference/brm_marginal_draws_average.html","id":null,"dir":"Reference","previous_headings":"","what":"Average marginal MCMC draws across time points. — brm_marginal_draws_average","title":"Average marginal MCMC draws across time points. — brm_marginal_draws_average","text":"Simple un-weighted arithmetic mean marginal MCMC draws across time points.","code":""},{"path":"/reference/brm_marginal_draws_average.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Average marginal MCMC draws across time points. — brm_marginal_draws_average","text":"","code":"brm_marginal_draws_average(draws, data, times = NULL, label = \"average\")"},{"path":"/reference/brm_marginal_draws_average.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Average marginal MCMC draws across time points. — brm_marginal_draws_average","text":"draws List posterior draws brm_marginal_draws(). data Classed tibble preprocessed data brm_data(). times Character vector discrete time point levels average MCMC samples within treatment group levels. Set NULL average across time points. Levels automatically sanitized make.names(unique = FALSE, allow_ = TRUE) ensure agreement brms variable names downstream computations. label Character length 1, time point label averages. Automatically sanitized make.names(unique = FALSE, allow_ = TRUE). Must conflict existing time point labels data label time points sanitized.","code":""},{"path":"/reference/brm_marginal_draws_average.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Average marginal MCMC draws across time points. — brm_marginal_draws_average","text":"named list tibbles MCMC draws marginal posterior distribution treatment group time point (group--subgroup--time, applicable). tibble, 1 row per posterior sample sand one column type marginal distribution (.e. combination treatment group discrete time point. specific tibbles returned list described : response: scale response variable. difference_time: change baseline: response particular time minus response baseline (reference_time). returned role argument brm_data() \"response\". (role \"change\", response already represents change baseline.) difference_group: treatment effect: difference_time active group minus difference_time control group (reference_group). role \"change\", treatment group instead difference response active group minus response control group. difference_subgroup: subgroup differences: difference_group subgroup level minus difference_group subgroup reference level (reference_subgroup).","code":""},{"path":"/reference/brm_marginal_draws_average.html","id":"separation-string","dir":"Reference","previous_headings":"","what":"Separation string","title":"Average marginal MCMC draws across time points. — brm_marginal_draws_average","text":"Post-processing brm_marginal_draws() names group--time marginal means delimiting character string Sys.getenv(\"BRM_SEP\", unset = \"|\"). Neither column names element names group time variables can contain string. set custom string , use Sys.setenv(BRM_SEP = \"YOUR_CUSTOM_STRING\").","code":""},{"path":[]},{"path":"/reference/brm_marginal_draws_average.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Average marginal MCMC draws across time points. — brm_marginal_draws_average","text":"","code":"if (identical(Sys.getenv(\"BRM_EXAMPLES\", unset = \"\"), \"true\")) { set.seed(0L) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) tmp <- utils::capture.output(   suppressMessages(     suppressWarnings(       model <- brm_model(         data = data,         formula = formula,         chains = 1,         iter = 100,         refresh = 0       )     )   ) ) draws <- brm_marginal_draws(model = model, data = data) brm_marginal_draws_average(draws = draws, data = data) brm_marginal_draws_average(   draws = draws,   data = data,   times = c(\"time_1\", \"time_2\"),   label = \"mean\" ) }"},{"path":"/reference/brm_marginal_probabilities.html","id":null,"dir":"Reference","previous_headings":"","what":"Marginal probabilities on the treatment effect for an MMRM. — brm_marginal_probabilities","title":"Marginal probabilities on the treatment effect for an MMRM. — brm_marginal_probabilities","text":"Marginal probabilities treatment effect MMRM.","code":""},{"path":"/reference/brm_marginal_probabilities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Marginal probabilities on the treatment effect for an MMRM. — brm_marginal_probabilities","text":"","code":"brm_marginal_probabilities(draws, direction = \"greater\", threshold = 0)"},{"path":"/reference/brm_marginal_probabilities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Marginal probabilities on the treatment effect for an MMRM. — brm_marginal_probabilities","text":"draws Posterior draws marginal posterior obtained brm_marginal_draws(). direction Character vector length threshold. \"greater\" compute marginal posterior probability treatment effect greater threshold, \"less\" compute marginal posterior probability treatment effect less threshold. element direction[] corresponds threshold[] 1 length(direction). threshold Numeric vector length direction, treatment effect threshold computing posterior probabilities. element direction[] corresponds threshold[] 1 length(direction).","code":""},{"path":"/reference/brm_marginal_probabilities.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Marginal probabilities on the treatment effect for an MMRM. — brm_marginal_probabilities","text":"tibble probabilities form Prob(treatment effect > threshold | data) /Prob(treatment effect < threshold | data). one row per probability following columns: * group: treatment group. * subgroup: subgroup level, applicable. * time: discrete time point, * direction: direction comparison marginal probability: \"greater\" >, \"less\" < * threshold: treatment effect threshold probability statement. * value: numeric value estimate probability.","code":""},{"path":[]},{"path":"/reference/brm_marginal_probabilities.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Marginal probabilities on the treatment effect for an MMRM. — brm_marginal_probabilities","text":"","code":"if (identical(Sys.getenv(\"BRM_EXAMPLES\", unset = \"\"), \"true\")) { set.seed(0L) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) tmp <- utils::capture.output(   suppressMessages(     suppressWarnings(       model <- brm_model(         data = data,         formula = formula,         chains = 1,         iter = 100,         refresh = 0       )     )   ) ) draws <- brm_marginal_draws(model = model, data = data) brm_marginal_probabilities(draws, direction = \"greater\", threshold = 0) }"},{"path":"/reference/brm_marginal_summaries.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary statistics of the marginal posterior of an MMRM. — brm_marginal_summaries","title":"Summary statistics of the marginal posterior of an MMRM. — brm_marginal_summaries","text":"Summary statistics marginal posterior MMRM.","code":""},{"path":"/reference/brm_marginal_summaries.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary statistics of the marginal posterior of an MMRM. — brm_marginal_summaries","text":"","code":"brm_marginal_summaries(draws, level = 0.95)"},{"path":"/reference/brm_marginal_summaries.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary statistics of the marginal posterior of an MMRM. — brm_marginal_summaries","text":"draws Posterior draws marginal posterior obtained brm_marginal_draws(). level Numeric length 1 0 1, credible level credible intervals.","code":""},{"path":"/reference/brm_marginal_summaries.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary statistics of the marginal posterior of an MMRM. — brm_marginal_summaries","text":"tibble one row per summary statistic following columns: marginal: type marginal distribution. outcome \"response\" brm_marginal_draws(), possible values include \"response\" response raw scale, \"change\" change baseline, \"difference\" treatment difference terms change baseline. outcome \"change\", possible values include \"response\" response one change baseline scale \"difference\" treatment difference. statistic: type summary statistic. \"lower\" \"upper\" bounds equal-tailed quantile-based credible interval. group: treatment group. subgroup: subgroup level, applicable. time: discrete time point. value: numeric value estimate. mcse: Monte Carlo standard error estimate. statistic column following possible values: mean: posterior mean. median: posterior median. sd: posterior standard deviation mean. lower: lower bound equal-tailed credible interval mean, credible level determined level argument. upper: upper bound equal-tailed credible interval credible level determined level argument.","code":""},{"path":[]},{"path":"/reference/brm_marginal_summaries.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summary statistics of the marginal posterior of an MMRM. — brm_marginal_summaries","text":"","code":"if (identical(Sys.getenv(\"BRM_EXAMPLES\", unset = \"\"), \"true\")) { set.seed(0L) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) tmp <- utils::capture.output(   suppressMessages(     suppressWarnings(       model <- brm_model(         data = data,         formula = formula,         chains = 1,         iter = 100,         refresh = 0       )     )   ) ) draws <- brm_marginal_draws(model = model, data = data) suppressWarnings(brm_marginal_summaries(draws)) }"},{"path":"/reference/brm_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Basic MMRM — brm_model","title":"Basic MMRM — brm_model","text":"Fit basic MMRM model using brms.","code":""},{"path":"/reference/brm_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basic MMRM — brm_model","text":"","code":"brm_model(data, formula, prior = NULL, ...)"},{"path":"/reference/brm_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basic MMRM — brm_model","text":"data tidy data frame one row per patient per discrete time point. formula object class \"brmsformula\" brm_formula() brms::brmsformula(). include full parameterization model, including fixed effects, residual correlation, heterogeneity discrete-time-specific residual variance components. prior Either NULL default priors \"brmsprior\" object brms::prior(). ... Arguments brms::brm() data, formula, prior.","code":""},{"path":"/reference/brm_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basic MMRM — brm_model","text":"fitted model object brms.","code":""},{"path":"/reference/brm_model.html","id":"parameterization","dir":"Reference","previous_headings":"","what":"Parameterization","title":"Basic MMRM — brm_model","text":"formula factor determines fixed effect parameterization. ordering categorical variables data, well contrast option R, affect construction model matrix. see model matrix ultimately used brm_model(), run brms::make_standata() examine X element returned list. See examples demonstration.","code":""},{"path":[]},{"path":"/reference/brm_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Basic MMRM — brm_model","text":"","code":"if (identical(Sys.getenv(\"BRM_EXAMPLES\", unset = \"\"), \"true\")) { set.seed(0L) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) # Optional: set the contrast option, which determines the model matrix. options(contrasts = c(unordered = \"contr.SAS\", ordered = \"contr.poly\")) # See the fixed effect parameterization you get from the data: head(brms::make_standata(formula = formula, data = data)$X) # Specify a different contrast method to use an alternative # parameterization when fitting the model with brm_model(): options(   contrasts = c(unordered = \"contr.treatment\", ordered = \"contr.poly\") ) # different model matrix than before: head(brms::make_standata(formula = formula, data = data)$X) tmp <- utils::capture.output(   suppressMessages(     suppressWarnings(       model <- brm_model(         data = data,         formula = formula,         chains = 1,         iter = 100,         refresh = 0       )     )   ) ) # The output model is a brms model fit object. model # The `prior_summary()` function shows the full prior specification # which reflects the fully realized fixed effects parameterization. brms::prior_summary(model) }"},{"path":"/reference/brm_plot_compare.html","id":null,"dir":"Reference","previous_headings":"","what":"Visually compare the marginals of multiple models and/or datasets. — brm_plot_compare","title":"Visually compare the marginals of multiple models and/or datasets. — brm_plot_compare","text":"Visually compare marginals multiple models /datasets.","code":""},{"path":"/reference/brm_plot_compare.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visually compare the marginals of multiple models and/or datasets. — brm_plot_compare","text":"","code":"brm_plot_compare(   ...,   marginal = \"response\",   compare = \"source\",   axis = \"time\",   facet = c(\"group\", \"subgroup\") )"},{"path":"/reference/brm_plot_compare.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visually compare the marginals of multiple models and/or datasets. — brm_plot_compare","text":"... Named tibbles marginals posterior summaries brm_marginal_summaries() /brm_marginal_data(). marginal Character length 1, kind marginal visualize. Must value marginal column supplied tibbles ... argument. applies MCMC output, data always scale response variable. compare Character length 1 identifying variable display using back--back interval plots different colors. primary comparison interest. Must one \"source\" (source marginal summaries, e.g. model dataset), \"time\" \"group\" (non-subgroup case). Can also \"subgroup\" marginal summaries subgroup-specific. value must axis facet. axis Character length 1 identifying quantity put horizontal axis. Must one \"source\" (source marginal summaries, e.g. model dataset), \"time\", \"group\" (non-subgroup case). marginals subgroup-specific, axis can also \"subgroup\". value must compare facet. facet Character vector length 1 2 quantities generate facets. element must \"source\" (source marginal summaries, e.g. model dataset), \"time\", \"group\", \"subgroup\", c(axis, facet) must unique elements. \"subgroup\" automatically removed marginals subgroup. facet length 1, faceting wrapped. facet length 2, faceting grid, first element horizontal facet.","code":""},{"path":"/reference/brm_plot_compare.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visually compare the marginals of multiple models and/or datasets. — brm_plot_compare","text":"ggplot object.","code":""},{"path":"/reference/brm_plot_compare.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Visually compare the marginals of multiple models and/or datasets. — brm_plot_compare","text":"default, brm_plot_compare() compares multiple models /datasets side--side. compare argument selects primary comparison interest, arguments axis facet control arrangement various components plot.","code":""},{"path":[]},{"path":"/reference/brm_plot_compare.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visually compare the marginals of multiple models and/or datasets. — brm_plot_compare","text":"","code":"if (identical(Sys.getenv(\"BRM_EXAMPLES\", unset = \"\"), \"true\")) { set.seed(0L) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) tmp <- utils::capture.output(   suppressMessages(     suppressWarnings(       model <- brm_model(         data = data,         formula = formula,         chains = 1,         iter = 100,         refresh = 0       )     )   ) ) draws <- brm_marginal_draws(model = model, data = data) suppressWarnings(summaries_draws <- brm_marginal_summaries(draws)) summaries_data <- brm_marginal_data(data) brm_plot_compare(   model1 = summaries_draws,   model2 = summaries_draws,   data = summaries_data ) brm_plot_compare(   model1 = summaries_draws,   model2 = summaries_draws,   marginal = \"difference\" ) }"},{"path":"/reference/brm_plot_draws.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize posterior draws of marginals. — brm_plot_draws","title":"Visualize posterior draws of marginals. — brm_plot_draws","text":"Visualize posterior draws marginals.","code":""},{"path":"/reference/brm_plot_draws.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize posterior draws of marginals. — brm_plot_draws","text":"","code":"brm_plot_draws(draws, axis = \"time\", facet = c(\"group\", \"subgroup\"))"},{"path":"/reference/brm_plot_draws.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize posterior draws of marginals. — brm_plot_draws","text":"draws data frame draws element output list brm_marginal_summaries(). axis Character length 1 identifying quantity put horizontal axis. Must one \"time\" \"group\" marginal summaries subgroup-specific. marginals subgroup-specific, axis must one \"time\", \"group\", \"subgroup\". facet Character vector length 1 2 quantities generate facets. element must \"time\", \"group\", \"subgroup\", c(axis, facet) must unique elements. \"subgroup\" automatically removed marginals subgroup. facet length 1, faceting wrapped. facet length 2, faceting grid, first element horizontal facet.","code":""},{"path":"/reference/brm_plot_draws.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Visualize posterior draws of marginals. — brm_plot_draws","text":"ggplot object.","code":""},{"path":[]},{"path":"/reference/brm_plot_draws.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize posterior draws of marginals. — brm_plot_draws","text":"","code":"if (identical(Sys.getenv(\"BRM_EXAMPLES\", unset = \"\"), \"true\")) { set.seed(0L) data <- brm_data(   data = brm_simulate_simple()$data,   outcome = \"response\",   role = \"response\",   group = \"group\",   time = \"time\",   patient = \"patient\",   reference_group = \"group_1\",   reference_time = \"time_1\" ) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) tmp <- utils::capture.output(   suppressMessages(     suppressWarnings(       model <- brm_model(         data = data,         formula = formula,         chains = 1,         iter = 100,         refresh = 0       )     )   ) ) draws <- brm_marginal_draws(model = model, data = data) brm_plot_draws(draws = draws$difference_time) }"},{"path":"/reference/brm_prior_simple.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple prior for a brms MMRM — brm_prior_simple","title":"Simple prior for a brms MMRM — brm_prior_simple","text":"Generate simple prior brms MMRM.","code":""},{"path":"/reference/brm_prior_simple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple prior for a brms MMRM — brm_prior_simple","text":"","code":"brm_prior_simple(   data,   formula,   intercept = \"student_t(3, 0, 2.5)\",   coefficients = \"student_t(3, 0, 2.5)\",   sigma = \"student_t(3, 0, 2.5)\",   correlation = \"lkj(1)\" )"},{"path":"/reference/brm_prior_simple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple prior for a brms MMRM — brm_prior_simple","text":"data tidy data frame one row per patient per discrete time point. formula object class \"brmsformula\" brm_formula() brms::brmsformula(). include full parameterization model, including fixed effects, residual correlation, heterogeneity discrete-time-specific residual variance components. intercept Character length 1, Stan code prior set intercept parameter. coefficients Character length 1, Stan code prior set independently non-intercept model coefficients. sigma Character length 1, Stan code prior set independently log-scale standard deviation parameters. symmetric prior situations. correlation Character length 1, Stan code prior correlation matrix residuals given patient. (Different patients modeled independent, patient correlation structure patient.) LKJ prior situations.","code":""},{"path":"/reference/brm_prior_simple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple prior for a brms MMRM — brm_prior_simple","text":"classed data frame brms prior.","code":""},{"path":"/reference/brm_prior_simple.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simple prior for a brms MMRM — brm_prior_simple","text":"brm_prior_simple(), can separately choose priors intercept, model coefficients, log-scale standard deviations, pairwise correlations time points within patients. However, class parameters set whole. words, brm_prior_simple() assign different priors different fixed effect parameters.","code":""},{"path":"/reference/brm_prior_simple.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simple prior for a brms MMRM — brm_prior_simple","text":"","code":"set.seed(0L) data <- brm_simulate_outline() data <- brm_simulate_continuous(data, names = c(\"age\", \"biomarker\")) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) brm_prior_simple(   data = data,   formula = formula,   intercept = \"student_t(3, 0, 2.5)\",   coefficients = \"normal(0, 10)\",   sigma = \"student_t(2, 0, 4)\",   correlation = \"lkj(2.5)\" ) #>                 prior     class coef group resp  dpar nlpar lb ub  source #>  student_t(3, 0, 2.5) Intercept                                   default #>         normal(0, 10)         b                                   default #>              lkj(2.5)   cortime                                   default #>    student_t(2, 0, 4)         b                 sigma             default"},{"path":"/reference/brm_simulate.html","id":null,"dir":"Reference","previous_headings":"","what":"Deprecated: simulate an MMRM. — brm_simulate","title":"Deprecated: simulate an MMRM. — brm_simulate","text":"Deprecated 2023-09-01 (version 0.0.2.9001). Use brm_simulate_simple() instead.","code":""},{"path":"/reference/brm_simulate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Deprecated: simulate an MMRM. — brm_simulate","text":"","code":"brm_simulate(   n_group = 2L,   n_patient = 100L,   n_time = 4L,   hyper_beta = 1,   hyper_sigma = 1,   hyper_correlation = 1 )"},{"path":"/reference/brm_simulate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Deprecated: simulate an MMRM. — brm_simulate","text":"n_group Positive integer length 1, number treatment groups. n_patient Positive integer length 1, number patients per treatment group. n_time Positive integer length 1, number discrete time points (e.g. scheduled study visits) per patient. hyper_beta Positive numeric length 1, hyperparameter. Prior standard deviation fixed effect parameters. hyper_sigma Positive numeric length 1, hyperparameter. Uniform prior upper bound time-specific residual standard deviation parameters. hyper_correlation Positive numeric length 1, hyperparameter. LKJ shape parameter correlation matrix among repeated measures within patient.","code":""},{"path":"/reference/brm_simulate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Deprecated: simulate an MMRM. — brm_simulate","text":"list three objects: data: tidy dataset one row per patient per discrete time point columns response covariates. model_matrix: matrix one row per row data columns represent levels covariates. parameters: named list parameter values sampled prior.","code":""},{"path":"/reference/brm_simulate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Deprecated: simulate an MMRM. — brm_simulate","text":"","code":"set.seed(0L) simulation <- suppressWarnings(brm_simulate()) simulation$data #> # A tibble: 800 × 4 #>    response group   patient   time   #>       <dbl> <chr>   <chr>     <chr>  #>  1     1.30 group 1 patient 1 time 1 #>  2     2.52 group 1 patient 1 time 2 #>  3     2.63 group 1 patient 1 time 3 #>  4     1.98 group 1 patient 1 time 4 #>  5     1.22 group 1 patient 2 time 1 #>  6     2.63 group 1 patient 2 time 2 #>  7     2.38 group 1 patient 2 time 3 #>  8     2.52 group 1 patient 2 time 4 #>  9     1.32 group 1 patient 3 time 1 #> 10     2.63 group 1 patient 3 time 2 #> # ℹ 790 more rows"},{"path":"/reference/brm_simulate_categorical.html","id":null,"dir":"Reference","previous_headings":"","what":"Append simulated categorical covariates — brm_simulate_categorical","title":"Append simulated categorical covariates — brm_simulate_categorical","text":"Simulate append non-time-varying categorical covariates existing brm_data() dataset.","code":""},{"path":"/reference/brm_simulate_categorical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Append simulated categorical covariates — brm_simulate_categorical","text":"","code":"brm_simulate_categorical(data, names, levels, probabilities = NULL)"},{"path":"/reference/brm_simulate_categorical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Append simulated categorical covariates — brm_simulate_categorical","text":"data Classed tibble brm_data() brm_simulate_outline(). names Character vector names new covariates simulate append. Names must unique must already column names data. levels Character vector unique levels simulated categorical covariates. probabilities Either NULL numeric vector length length(levels) levels 0 1 elements sum 1. NULL, levels equally likely drawn. NULL, probabilities vector sampling probabilities corresponding respective level levels.","code":""},{"path":"/reference/brm_simulate_categorical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Append simulated categorical covariates — brm_simulate_categorical","text":"classed tibble, like brm_data() brm_simulate_outline(), new categorical covariate columns names new covariates appended brm_covariates attribute. new categorical covariate column character vector, factor type base R.","code":""},{"path":"/reference/brm_simulate_categorical.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Append simulated categorical covariates — brm_simulate_categorical","text":"covariate new column dataset one independent random categorical draw patient, using fixed set levels (via base::sample() replace = TRUE). covariates simulated way independent everything else data, including covariates (extent random number generators R work intended).","code":""},{"path":[]},{"path":"/reference/brm_simulate_categorical.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Append simulated categorical covariates — brm_simulate_categorical","text":"","code":"data <- brm_simulate_outline() brm_simulate_categorical(   data = data,   names = c(\"site\", \"region\"),   levels = c(\"area1\", \"area2\") ) #> # A tibble: 800 × 7 #>    response missing group   time   patient     site  region #>       <dbl> <lgl>   <chr>   <chr>  <chr>       <chr> <chr>  #>  1       NA FALSE   group_1 time_1 patient_001 area2 area2  #>  2       NA FALSE   group_1 time_2 patient_001 area2 area2  #>  3       NA FALSE   group_1 time_3 patient_001 area2 area2  #>  4       NA FALSE   group_1 time_4 patient_001 area2 area2  #>  5       NA FALSE   group_1 time_1 patient_002 area1 area2  #>  6       NA FALSE   group_1 time_2 patient_002 area1 area2  #>  7       NA TRUE    group_1 time_3 patient_002 area1 area2  #>  8       NA TRUE    group_1 time_4 patient_002 area1 area2  #>  9       NA FALSE   group_1 time_1 patient_003 area2 area2  #> 10       NA FALSE   group_1 time_2 patient_003 area2 area2  #> # ℹ 790 more rows brm_simulate_categorical(   data = data,   names = c(\"site\", \"region\"),   levels = c(\"area1\", \"area2\"),   probabilities = c(0.1, 0.9) ) #> # A tibble: 800 × 7 #>    response missing group   time   patient     site  region #>       <dbl> <lgl>   <chr>   <chr>  <chr>       <chr> <chr>  #>  1       NA FALSE   group_1 time_1 patient_001 area2 area2  #>  2       NA FALSE   group_1 time_2 patient_001 area2 area2  #>  3       NA FALSE   group_1 time_3 patient_001 area2 area2  #>  4       NA FALSE   group_1 time_4 patient_001 area2 area2  #>  5       NA FALSE   group_1 time_1 patient_002 area2 area2  #>  6       NA FALSE   group_1 time_2 patient_002 area2 area2  #>  7       NA TRUE    group_1 time_3 patient_002 area2 area2  #>  8       NA TRUE    group_1 time_4 patient_002 area2 area2  #>  9       NA FALSE   group_1 time_1 patient_003 area2 area2  #> 10       NA FALSE   group_1 time_2 patient_003 area2 area2  #> # ℹ 790 more rows"},{"path":"/reference/brm_simulate_continuous.html","id":null,"dir":"Reference","previous_headings":"","what":"Append simulated continuous covariates — brm_simulate_continuous","title":"Append simulated continuous covariates — brm_simulate_continuous","text":"Simulate append non-time-varying continuous covariates existing brm_data() dataset.","code":""},{"path":"/reference/brm_simulate_continuous.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Append simulated continuous covariates — brm_simulate_continuous","text":"","code":"brm_simulate_continuous(data, names, mean = 0, sd = 1)"},{"path":"/reference/brm_simulate_continuous.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Append simulated continuous covariates — brm_simulate_continuous","text":"data Classed tibble brm_data() brm_simulate_outline(). names Character vector names new covariates simulate append. Names must unique must already column names data. mean Numeric length 1, mean normal distribution simulating covariate. sd Positive numeric length 1, standard deviation normal distribution simulating covariate.","code":""},{"path":"/reference/brm_simulate_continuous.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Append simulated continuous covariates — brm_simulate_continuous","text":"classed tibble, like brm_data() brm_simulate_outline(), new numeric covariate columns names new covariates appended brm_covariates attribute.","code":""},{"path":"/reference/brm_simulate_continuous.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Append simulated continuous covariates — brm_simulate_continuous","text":"covariate new column dataset one independent random univariate normal draw patient. covariates simulated way independent everything else data, including covariates (extent random number generators R work intended).","code":""},{"path":[]},{"path":"/reference/brm_simulate_continuous.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Append simulated continuous covariates — brm_simulate_continuous","text":"","code":"data <- brm_simulate_outline() brm_simulate_continuous(   data = data,   names = c(\"age\", \"biomarker\") ) #> # A tibble: 800 × 7 #>    response missing group   time   patient         age biomarker #>       <dbl> <lgl>   <chr>   <chr>  <chr>         <dbl>     <dbl> #>  1       NA FALSE   group_1 time_1 patient_001 -0.0499    -1.30  #>  2       NA FALSE   group_1 time_2 patient_001 -0.0499    -1.30  #>  3       NA FALSE   group_1 time_3 patient_001 -0.0499    -1.30  #>  4       NA FALSE   group_1 time_4 patient_001 -0.0499    -1.30  #>  5       NA FALSE   group_1 time_1 patient_002  1.75       0.592 #>  6       NA FALSE   group_1 time_2 patient_002  1.75       0.592 #>  7       NA FALSE   group_1 time_3 patient_002  1.75       0.592 #>  8       NA FALSE   group_1 time_4 patient_002  1.75       0.592 #>  9       NA FALSE   group_1 time_1 patient_003  0.400      1.05  #> 10       NA FALSE   group_1 time_2 patient_003  0.400      1.05  #> # ℹ 790 more rows brm_simulate_continuous(   data = data,   names = c(\"biomarker1\", \"biomarker2\"),   mean = 1000,   sd = 100 ) #> # A tibble: 800 × 7 #>    response missing group   time   patient     biomarker1 biomarker2 #>       <dbl> <lgl>   <chr>   <chr>  <chr>            <dbl>      <dbl> #>  1       NA FALSE   group_1 time_1 patient_001      1154.      1066. #>  2       NA FALSE   group_1 time_2 patient_001      1154.      1066. #>  3       NA FALSE   group_1 time_3 patient_001      1154.      1066. #>  4       NA FALSE   group_1 time_4 patient_001      1154.      1066. #>  5       NA FALSE   group_1 time_1 patient_002      1108.      1084. #>  6       NA FALSE   group_1 time_2 patient_002      1108.      1084. #>  7       NA FALSE   group_1 time_3 patient_002      1108.      1084. #>  8       NA FALSE   group_1 time_4 patient_002      1108.      1084. #>  9       NA FALSE   group_1 time_1 patient_003       714.      1111. #> 10       NA FALSE   group_1 time_2 patient_003       714.      1111. #> # ℹ 790 more rows"},{"path":"/reference/brm_simulate_outline.html","id":null,"dir":"Reference","previous_headings":"","what":"Start a simulated dataset — brm_simulate_outline","title":"Start a simulated dataset — brm_simulate_outline","text":"Begin creating simulated dataset.","code":""},{"path":"/reference/brm_simulate_outline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Start a simulated dataset — brm_simulate_outline","text":"","code":"brm_simulate_outline(   n_group = 2L,   n_subgroup = NULL,   n_patient = 100L,   n_time = 4L,   rate_dropout = 0.1,   rate_lapse = 0.05 )"},{"path":"/reference/brm_simulate_outline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Start a simulated dataset — brm_simulate_outline","text":"n_group Positive integer length 1, number treatment groups. n_subgroup Positive integer length 1, number subgroup levels. Set NULL omit subgroup entirely. n_patient Positive integer length 1. n_subgroup NULL, n_patient number patients per treatment group. Otherwise, n_patient number patients per treatment group per subgroup. cases, total number patients whole simulated dataset usually much greater n_patients argument brm_simulate_outline(). n_time Positive integer length 1, number discrete time points (e.g. scheduled study visits) per patient. rate_dropout Numeric length 1 0 1, post-baseline dropout rate. dropout intercurrent event data collection patient stops permanently, causing outcomes patient missing dropout occurred. first time point assumed baseline, dropout . Dropouts equally likely occur post-baseline time points. rate_lapse Numeric length 1, expected proportion post-baseline outcomes missing. Missing outcomes type independent uniformly distributed across data.","code":""},{"path":"/reference/brm_simulate_outline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Start a simulated dataset — brm_simulate_outline","text":"data frame brm_data() attributes define roles various columns dataset. data frame one row per patient per time point following columns: group: integer index treatment group. patient: integer index patient. time: integer index discrete time point.","code":""},{"path":[]},{"path":"/reference/brm_simulate_outline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Start a simulated dataset — brm_simulate_outline","text":"","code":"brm_simulate_outline() #> # A tibble: 800 × 5 #>    response missing group   time   patient     #>       <dbl> <lgl>   <chr>   <chr>  <chr>       #>  1       NA FALSE   group_1 time_1 patient_001 #>  2       NA FALSE   group_1 time_2 patient_001 #>  3       NA FALSE   group_1 time_3 patient_001 #>  4       NA FALSE   group_1 time_4 patient_001 #>  5       NA FALSE   group_1 time_1 patient_002 #>  6       NA FALSE   group_1 time_2 patient_002 #>  7       NA FALSE   group_1 time_3 patient_002 #>  8       NA FALSE   group_1 time_4 patient_002 #>  9       NA FALSE   group_1 time_1 patient_003 #> 10       NA FALSE   group_1 time_2 patient_003 #> # ℹ 790 more rows"},{"path":"/reference/brm_simulate_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior predictive draws. — brm_simulate_prior","title":"Prior predictive draws. — brm_simulate_prior","text":"Simulate outcome variable prior predictive distribution MMRM using brms.","code":""},{"path":"/reference/brm_simulate_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior predictive draws. — brm_simulate_prior","text":"","code":"brm_simulate_prior(   data,   formula,   prior = brms.mmrm::brm_prior_simple(data = data, formula = formula),   ... )"},{"path":"/reference/brm_simulate_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior predictive draws. — brm_simulate_prior","text":"data tidy data frame one row per patient per discrete time point. formula object class \"brmsformula\" brm_formula() brms::brmsformula(). include full parameterization model, including fixed effects, residual correlation, heterogeneity discrete-time-specific residual variance components. prior valid brms prior object proper priors parameters b (model coefficients), b_sigma (log residual standard deviations time point), cortime (residual correlations among time points within patients). See brm_prior_simple() function example. ... Arguments brms::brm() data, formula, prior.","code":""},{"path":"/reference/brm_simulate_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior predictive draws. — brm_simulate_prior","text":"list following elements: data: classed tibble outcome variable simulated draw prior predictive distribution (final row outcome output). simulated missingness pattern brm_simulate_outline(), missingness pattern applied appropriate values outcome variable set NA. model: brms model fit object. model_matrix: model matrix fixed effects, obtained brms::make_standata(). outcome: numeric matrix one column per row data one row per saved prior predictive draw. parameters: tibble saved parameter draws prior predictive distribution.","code":""},{"path":"/reference/brm_simulate_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prior predictive draws. — brm_simulate_prior","text":"brm_simulate_prior() calls brms::brm() sample_prior = \"\", sets default intercept prior using outcome variable requires least elements outcome variable non-missing advance. provide feasible consistent output, brm_simulate_prior() temporarily sets outcome variable zeros invoking brms::brm().","code":""},{"path":[]},{"path":"/reference/brm_simulate_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior predictive draws. — brm_simulate_prior","text":"","code":"if (identical(Sys.getenv(\"BRM_EXAMPLES\", unset = \"\"), \"true\")) { set.seed(0L) data <- brm_simulate_outline() data <- brm_simulate_continuous(data, names = c(\"age\", \"biomarker\")) formula <- brm_formula(   data = data,   baseline = FALSE,   baseline_time = FALSE ) tmp <- utils::capture.output(   suppressMessages(     suppressWarnings(       out <- brm_simulate_prior(         data = data,         formula = formula       )     )   ) ) out$data }"},{"path":"/reference/brm_simulate_simple.html","id":null,"dir":"Reference","previous_headings":"","what":"Simple MMRM simulation. — brm_simulate_simple","title":"Simple MMRM simulation. — brm_simulate_simple","text":"Simple function simulate dataset simple specialized MMRM.","code":""},{"path":"/reference/brm_simulate_simple.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simple MMRM simulation. — brm_simulate_simple","text":"","code":"brm_simulate_simple(   n_group = 2L,   n_patient = 100L,   n_time = 4L,   hyper_beta = 1,   hyper_tau = 0.1,   hyper_lambda = 1 )"},{"path":"/reference/brm_simulate_simple.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simple MMRM simulation. — brm_simulate_simple","text":"n_group Positive integer length 1, number treatment groups. n_patient Positive integer length 1, number patients per treatment group. n_time Positive integer length 1, number discrete time points (e.g. scheduled study visits) per patient. hyper_beta Positive numeric length 1, hyperparameter. Prior standard deviation fixed effect parameters beta. hyper_tau Positive numeric length 1, hyperparameter. Prior standard deviation parameter residual log standard deviation parameters tau hyper_lambda Positive numeric length 1, hyperparameter. Prior shape parameter LKJ correlation matrix residuals among discrete time points.","code":""},{"path":"/reference/brm_simulate_simple.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simple MMRM simulation. — brm_simulate_simple","text":"list three objects: data: tidy dataset one row per patient per discrete time point columns outcome ID variables. model_matrix: matrix one row per row data columns represent levels covariates. parameters: named list parameter draws sampled prior: beta: numeric vector fixed effects. tau: numeric vector residual log standard parameters time point. sigma: numeric vector residual standard parameters time point. sigma equal exp(tau). lambda: correlation matrix residuals among time points within patient. covariance: covariance matrix residuals among time points within patient. covariance equal diag(sigma) %*% lambda %*% diag(sigma).","code":""},{"path":"/reference/brm_simulate_simple.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simple MMRM simulation. — brm_simulate_simple","text":"Refer methods vignette full model specification. brm_simulate_simple() function simulates dataset simple pre-defined MMRM. assumes cell means structure fixed effects, means one fixed effect scalar parameter (element vector beta) unique combination levels treatment group discrete time point. elements beta independent univariate normal priors mean 0 standard deviation hyper_beta. residual log standard deviation parameters (elements vector tau) normal priors mean 0 standard deviation hyper_tau. residual correlation matrix parameter lambda LKJ correlation prior shape parameter hyper_lambda.","code":""},{"path":[]},{"path":"/reference/brm_simulate_simple.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simple MMRM simulation. — brm_simulate_simple","text":"","code":"set.seed(0L) simulation <- brm_simulate_simple() simulation$data #> # A tibble: 800 × 4 #>    response group   time   patient     #>       <dbl> <chr>   <chr>  <chr>       #>  1    1.47  group_1 time_1 patient_001 #>  2    3.10  group_1 time_2 patient_001 #>  3    2.22  group_1 time_3 patient_001 #>  4    0.215 group_1 time_4 patient_001 #>  5    1.03  group_1 time_1 patient_002 #>  6    2.28  group_1 time_2 patient_002 #>  7    2.36  group_1 time_3 patient_002 #>  8    2.33  group_1 time_4 patient_002 #>  9    0.128 group_1 time_1 patient_003 #> 10    1.89  group_1 time_2 patient_003 #> # ℹ 790 more rows"},{"path":"/reference/brms.mmrm-package.html","id":null,"dir":"Reference","previous_headings":"","what":"brms.mmrm: Bayesian MMRMs using brms — brms.mmrm-package","title":"brms.mmrm: Bayesian MMRMs using brms — brms.mmrm-package","text":"mixed model repeated measures (MMRM) popular model longitudinal clinical trial data continuous endpoints, brms powerful versatile package fitting Bayesian regression models. brms.mmrm R package leverages brms run MMRMs, supports simplified interfaced reduce difficulty align best practices life sciences.","code":""},{"path":"/reference/brms.mmrm-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"brms.mmrm: Bayesian MMRMs using brms — brms.mmrm-package","text":"Bürkner, P.-C. (2017), \"brms: R package Bayesian multilevel models using Stan,\" Journal Statistical Software, 80, 1–28. https://doi.org/10.18637/jss.v080.i01. Mallinckrodt, C. H., Lane, P. W., Schnell, D., others (2008), \"Recommendations primary analysis continuous endpoints longitudinal clinical trials,\" Ther Innov Regul Sci, 42, 303–319. https://doi.org/10.1177/009286150804200402. Mallinckrodt, C. H., Lipkovich, . (2017), Analyzing longitudinal clinical trial data: practical guide, CRC Press, Taylor & Francis Group.","code":""},{"path":"/news/index.html","id":"brmsmmrm-0029003-development","dir":"Changelog","previous_headings":"","what":"brms.mmrm 0.0.2.9003 (development)","title":"brms.mmrm 0.0.2.9003 (development)","text":"Deprecate brm_simulate() favor brm_simulate_simple() (#3). latter specific name disambiguate simulation functions, parameterization conforms one methods vignette. Add new functions nuanced simulations: brm_simulate_outline(), brm_simulate_continuous(), brm_simulate_categorical() (#3). brm_model(), remove rows missing responses. rows automatically removed brms anyway, handling handling brms.mmrm, avoid warning. Add subgroup analysis functionality validate subgroup model simulation-based calibration (#18). Zero-pad numeric indexes simulated data levels sort expected. brm_data(), deprecate level_control favor reference_group. brm_data(), deprecate level_baseline favor reference_time. brm_formula(), deprecate arguments effect_baseline, effect_group, effect_time, interaction_baseline, interaction_group favor baseline, group, time, baseline_time, group_time, respectively. Propagate values missing column brm_data_change() value change baseline labeled missing either baseline response missing post-baseline response missing. Change names output brm_marginal_draws() internally consistent fit better addition subgroup-specific marginals (#18). Allow brm_plot_compare() brm_plot_draws() select x axis variable faceting variables. Allow brm_plot_compare() choose primary comparison interest (source data, discrete time, treatment group, subgroup level).","code":""},{"path":"/news/index.html","id":"brmsmmrm-002","dir":"Changelog","previous_headings":"","what":"brms.mmrm 0.0.2","title":"brms.mmrm 0.0.2","text":"CRAN release: 2023-08-18 Fix grammatical issues description.","code":""},{"path":"/news/index.html","id":"brmsmmrm-001","dir":"Changelog","previous_headings":"","what":"brms.mmrm 0.0.1","title":"brms.mmrm 0.0.1","text":"First version.","code":""}]
