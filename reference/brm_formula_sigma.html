<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Parameterize standard deviations using
a formula for the sigma argument of brm_formula()."><title>Formula for standard deviation parameters — brm_formula_sigma • brms.mmrm</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Formula for standard deviation parameters — brm_formula_sigma"><meta property="og:description" content="Parameterize standard deviations using
a formula for the sigma argument of brm_formula()."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">brms.mmrm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Usage</h6>
    <a class="dropdown-item" href="../articles/usage.html">Usage</a>
    <a class="dropdown-item" href="../articles/subgroup.html">Subgroup analysis</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
    <a class="dropdown-item" href="../articles/archetypes.html">Informative prior archetypes</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Validation</h6>
    <a class="dropdown-item" href="../articles/sbc.html">Simulation-based calibration checking</a>
    <a class="dropdown-item" href="../articles/fev1.html">FEV1 data comparison between Bayesian and frequentist MMRMs</a>
    <a class="dropdown-item" href="../articles/bcva.html">BCVA data comparison between Bayesian and frequentist MMRMs</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/openpharma/brms.mmrm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Formula for standard deviation parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/openpharma/brms.mmrm/blob/HEAD/R/brm_formula_sigma.R" class="external-link"><code>R/brm_formula_sigma.R</code></a></small>
      <div class="d-none name"><code>brm_formula_sigma.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Parameterize standard deviations using
a formula for the <code>sigma</code> argument of <code><a href="brm_formula.html">brm_formula()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">brm_formula_sigma</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  check_rank <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline_subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline_subgroup_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baseline_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  covariates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_subgroup_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subgroup <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subgroup_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A classed data frame from <code><a href="brm_data.html">brm_data()</a></code>, or an informative
prior archetype from a function like <code><a href="brm_archetype_successive_cells.html">brm_archetype_successive_cells()</a></code>.</p></dd>


<dt>check_rank</dt>
<dd><p><code>TRUE</code> to check the rank of the model matrix
for <code>sigma</code> and throw an error if rank deficiency is detected.
<code>FALSE</code> to skip this check.
Rank-deficiency may cause <code>sigma</code> to be non-identifiable,
may prevent the MCMC from converging.</p></dd>


<dt>intercept</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> (default) to include an intercept, <code>FALSE</code> to omit.</p></dd>


<dt>baseline</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include an additive effect for baseline
response, <code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p></dd>


<dt>baseline_subgroup</dt>
<dd><p>Logical of length 1.</p></dd>


<dt>baseline_subgroup_time</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include baseline-by-subgroup-by-time interaction,
<code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p></dd>


<dt>baseline_time</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include baseline-by-time interaction, <code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p></dd>


<dt>covariates</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> (default) to include any additive covariates declared with
the <code>covariates</code> argument of <code><a href="brm_data.html">brm_data()</a></code>,
<code>FALSE</code> to omit.
If <code>TRUE</code>, then effect size will be omitted from the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code>.</p></dd>


<dt>group</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> (default) to include additive effects for
treatment groups, <code>FALSE</code> to omit.</p></dd>


<dt>group_subgroup</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include group-by-subgroup interaction, <code>FALSE</code> to omit.</p></dd>


<dt>group_subgroup_time</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include group-by-subgroup-by-time interaction, <code>FALSE</code> to omit.</p></dd>


<dt>group_time</dt>
<dd><p>Logical of length 1.</p></dd>


<dt>subgroup</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include additive fixed effects for subgroup levels,
<code>FALSE</code> to omit.</p></dd>


<dt>subgroup_time</dt>
<dd><p>Logical of length 1.
<code>TRUE</code> to include subgroup-by-time interaction, <code>FALSE</code> to omit.</p></dd>


<dt>time</dt>
<dd><p>Logical of length 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A base R formula with S3 class <code>"brms_mmrm_formula_sigma"</code>.
This formula controls the parameterization of <code>sigma</code>, the linear-scale
<code>brms</code> distributional parameters which represent standard deviations.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In <code>brms</code>, the standard deviations of the residuals are
modeled through a parameter vector called <code>sigma</code>. <code>brms.mmrm</code>
always treats <code>sigma</code> as a distributional parameter
(<a href="https://paul-buerkner.github.io/brms/articles/brms_distreg.html" class="external-link">https://paul-buerkner.github.io/brms/articles/brms_distreg.html</a>).
<code>brm_formula_sigma()</code> lets you control the parameterization of <code>sigma</code>.
The output of <code>brm_formula_sigma()</code> serves as input to the <code>sigma</code>
argument of <code><a href="brm_formula.html">brm_formula()</a></code>.</p>
<p>The default <code>sigma</code> formula is <code>sigma ~ 0 + time</code>, where <code>time</code>
is the discrete time variable in the data. This is the usual
heterogeneous variance structure which declares
one standard deviation parameter for each time point in the data.
Alternatively, you could write
<code>brm_formula_sigma(data, intercept = TRUE, time = FALSE)</code>.
This will produce <code>sigma ~ 1</code>, which yields a single scalar variance
(a structure termed "homogeneous variance").</p>
<p>With arguments like <code>baseline</code> and <code>covariates</code>, you can
specify extremely complicated variance structures. However,
if baseline or covariates are used, then the output of
<code><a href="brm_marginal_draws.html">brm_marginal_draws()</a></code> omit effect size due to the statistical
challenges of calculating marginal means of draws of <code>sigma</code>
for this uncommon scenario.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other models: 
<code><a href="brm_formula.html">brm_formula</a>()</code>,
<code><a href="brm_model.html">brm_model</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="brm_data.html">brm_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="brm_simulate_simple.html">brm_simulate_simple</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  outcome <span class="op">=</span> <span class="st">"response"</span>,</span></span>
<span class="r-in"><span>  role <span class="op">=</span> <span class="st">"response"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="st">"group"</span>,</span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>  patient <span class="op">=</span> <span class="st">"patient"</span>,</span></span>
<span class="r-in"><span>  reference_group <span class="op">=</span> <span class="st">"group_1"</span>,</span></span>
<span class="r-in"><span>  reference_time <span class="op">=</span> <span class="st">"time_1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">homogeneous</span> <span class="op">&lt;-</span> <span class="fu">brm_formula_sigma</span><span class="op">(</span><span class="va">data</span>, time <span class="op">=</span> <span class="cn">FALSE</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">by_group</span> <span class="op">&lt;-</span> <span class="fu">brm_formula_sigma</span><span class="op">(</span><span class="va">data</span>, group <span class="op">=</span> <span class="cn">TRUE</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">homogeneous</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"brm_allow_effect_size")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55e548479f30&gt;</span>
<span class="r-in"><span><span class="va">by_group</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ group + time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"brm_allow_effect_size")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x55e54b49cf00&gt;</span>
<span class="r-in"><span><span class="fu"><a href="brm_formula.html">brm_formula</a></span><span class="op">(</span><span class="va">data</span>, sigma <span class="op">=</span> <span class="va">homogeneous</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> response ~ group + group:time + time + unstr(time = time, gr = patient) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ 1</span>
<span class="r-in"><span><span class="fu"><a href="brm_formula.html">brm_formula</a></span><span class="op">(</span><span class="va">data</span>, sigma <span class="op">=</span> <span class="va">by_group</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> response ~ group + group:time + time + unstr(time = time, gr = patient) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma ~ group + time</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by William Michael Landau, Kevin Kunzmann, Yoni Sidi, Christian Stock, Eli Lilly and Company, Boehringer Ingelheim Pharma GmbH &amp; Co. KG.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

